<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modelo Físico - SQL - Instrucciones DDL y DML - Bases de datos</title>
  <link rel="stylesheet" href="../css/common.css">
  <link rel="stylesheet" href="../css/05ddl.css">
  <link rel="icon" href="../images/favicon.png">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
</head>

<body class="page">
  <header class="header">
    <div class="container">
      <div class="header__inner">
        <a href="../index.html" class="header__logo">
          <img src="../images/bd.png" alt="Logo Bases de Datos" class="header__logo-img">
          <span class="header__title">Bases de Datos</span>
        </a>
      </div>
    </div>
  </header>
  <nav class="nav">
    <div class="container">
      <ul class="nav__list">
        <li class="nav__item"><a href="../index.html" class="nav__link">Inicio</a></li>
        <li class="nav__item"><a href="01intro-new.html" class="nav__link">1. Sistemas de Almacenamiento</a></li>
        <li class="nav__item"><a href="02er.html" class="nav__link">2. Modelo E/R</a></li>
        <li class="nav__item"><a href="03mr.html" class="nav__link">3. Modelo Relacional</a></li>
        <li class="nav__item"><a href="04mr-eer.html" class="nav__link">4. Transformación</a></li>
        <li class="nav__item"><a href="05ddl.html" class="nav__link nav__link--active">5. DDL y DML</a></li>
        <li class="nav__item"><a href="06sql.html" class="nav__link">6. Consultas SQL</a></li>
        <li class="nav__item"><a href="07sql-group.html" class="nav__link">7. Agregaciones</a></li>
        <li class="nav__item"><a href="08sql-subquerys.html" class="nav__link">8. Subconsultas</a></li>
        <li class="nav__item"><a href="09dcl-tcl.html" class="nav__link">9. DCL y TCL</a></li>
        <li class="nav__item"><a href="10plsql.html" class="nav__link">10. PL/SQL</a></li>
        <li class="nav__item"><a href="11triggers.html" class="nav__link">11. Triggers</a></li>
        <li class="nav__item"><a href="12nosql.html" class="nav__link">12. NoSQL</a></li>
        <li class="nav__item"><a href="13mongodb.html" class="nav__link">13. MongoDB</a></li>
      </ul>
    </div>
  </nav>
  <main class="main">
    <div class="container">
      <article class="article">
        <div class="article__content">




          <nav class="md-tags">




            <a href="tags.html#tag:modelo-físico" class="md-tag">Modelo Físico</a>





            <a href="tags.html#tag:ra2" class="md-tag">RA2</a>





            <a href="tags.html#tag:ra4" class="md-tag">RA4</a>





            <a href="tags.html#tag:sql" class="md-tag">SQL</a>





            <a href="tags.html#tag:sql---ddl" class="md-tag">SQL - DDL</a>





            <a href="tags.html#tag:sql---dml" class="md-tag">SQL - DML</a>


          </nav>



          <h1 id="modelo-fisico-sql-instrucciones-ddl-y-dml">Modelo Físico: SQL - Instrucciones DDL y DML<a
              class="headerlink" href="05ddl.html#modelo-fisico-sql-instrucciones-ddl-y-dml"
              title="Permanent link">&para;</a></h1>
          <h2 id="propuesta-didactica">Propuesta didáctica<a class="headerlink" href="05ddl.html#propuesta-didactica"
              title="Permanent link">&para;</a></h2>
          <p>Una vez conocido el modelo relacional, en esta unidad vamos a comenzar a trabajar el RA2 "<strong>Crea
              bases de datos definiendo su estructura y las características de sus elementos según el modelo
              relacional</strong>", además de iniciar el RA4 "<strong>Modifica la información almacenada en la base de
              datos utilizando asistentes, herramientas gráficas y el lenguaje de manipulación de datos</strong>".</p>
          <h3 id="criterios-de-evaluacion">Criterios de evaluación<a class="headerlink"
              href="05ddl.html#criterios-de-evaluacion" title="Permanent link">&para;</a></h3>
          <p>Respecto al RA2:</p>
          <ul>
            <li><strong><abbr
                  title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr></strong>: Se ha
              analizado el formato de almacenamiento de la información. </li>
            <li><strong><abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr></strong>: Se
              han creado las tablas y las relaciones entre ellas. </li>
            <li><strong><abbr title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr></strong>: Se han
              seleccionado los tipos de datos adecuados. </li>
            <li><strong><abbr title="Se han definido los campos clave en las tablas.">CE2d</abbr></strong>: Se han
              definido los campos clave en las tablas. </li>
            <li><strong><abbr
                  title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr></strong>: Se
              han implantado las restricciones reflejadas en el diseño lógico. </li>
            <li><strong><abbr
                  title="Se han utilizado asistentes, herramientas gráficas y los lenguajes de definición y control de datos.">CE2h</abbr></strong>:
              Se han utilizado asistentes, herramientas gráficas y los lenguajes de definición y control de datos.</li>
          </ul>
          <p>Respecto al RA4:</p>
          <ul>
            <li><strong><abbr
                  title="Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos.">CE4a</abbr></strong>:
              Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos. </li>
            <li><strong><abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr></strong>:
              Se han insertado, borrado y actualizado datos en las tablas. </li>
            <li><strong><abbr
                  title="Se han diseñado guiones de sentencias para llevar a cabo tareas complejas.">CE4d</abbr></strong>:
              Se han diseñado guiones de sentencias para llevar a cabo tareas complejas. </li>
          </ul>
          <h3 id="contenidos">Contenidos<a class="headerlink" href="05ddl.html#contenidos"
              title="Permanent link">&para;</a></h3>
          <p>Bases de datos relacionales:</p>
          <ul>
            <li>Lenguaje de descripción de datos (DDL).</li>
          </ul>
          <p>Tratamiento de datos:</p>
          <ul>
            <li>Inserción, borrado y modificación de registros.</li>
            <li>Integridad referencial.</li>
          </ul>
          <div class="admonition question">
            <p class="admonition-title">Cuestionario inicial</p>
            <ol>
              <li>¿Cuál es el propósito de las sentencias DDL?</li>
              <li>¿Y DML?</li>
              <li>¿Cómo averiguamos tanto las tablas de una base de datos como su estructura?</li>
              <li>¿Para qué sirve el comando <code>CREATE TABLE?</code></li>
              <li>¿Qué diferencia <code>CREATE TYPE</code> de <code>CREATE DOMAIN</code>?</li>
              <li>A la hora de crear una tabla, ¿Dónde definiremos la clave primaria? ¿Y las restricciones de valor no
                nulo?</li>
              <li>¿Qué restricciones SQL podemos aplicar sobre las columnas?</li>
              <li>¿Por qué es mejor definir las restricciones al final de cada tabla mediante la <em>keyword</em>
                <code>CONSTRAINT</code>?
              </li>
              <li>¿Cómo puedo ejecutar un <em>script</em> SQL, que tengo almacenado en un archivo, de una sola vez?</li>
              <li>¿Puedo eliminar las tablas en cualquier orden mediante <code>DROP TABLE</code>?</li>
              <li>¿Es obligatorio que una clave ajena siempre referencie a una clave primaria?</li>
              <li>¿Para qué sirve el comando <code>INSERT INTO</code>?</li>
              <li>¿Qué sucede si omitimos el <code>WHERE</code> en un <code>DELETE FROM</code>?</li>
            </ol>
          </div>
          <h3 id="programacion-de-aula-11h">Programación de Aula (14h)<a class="headerlink"
              href="05ddl.html#programacion-de-aula-11h" title="Permanent link">&para;</a></h3>
          <p>Esta unidad es la quinta, y se imparte en la segunda evaluación, a principios de diciembre,
            con una duración estimada de 14 sesiones lectivas:</p>
          <table>
            <thead>
              <tr>
                <th>Sesión</th>
                <th>Contenidos</th>
                <th>Actividades</th>
                <th>Criterios trabajados</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td><a href="05ddl.html#modelo-fisico">Modelo físico</a>. Puesta en marcha</td>
                <td><a href="05ddl.html#AC501">AC501</a></td>
                <td><abbr title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr></td>
              </tr>
              <tr>
                <td>2</td>
                <td>DDL <a href="05ddl.html#bases-de-datos">Bases de datos</a> y <a
                    href="05ddl.html#tipos-de-datos">tipos de datos</a></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td>3</td>
                <td><a href="05ddl.html#tablas">DDL Tablas</a></td>
                <td><a href="05ddl.html#AC503">AC503</a></td>
                <td><abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr
                    title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr
                    title="Se han definido los campos clave en las tablas.">CE2d</abbr></td>
              </tr>
              <tr>
                <td>4</td>
                <td><a href="05ddl.html#restricciones">Restricciones</a></td>
                <td><a href="05ddl.html#AC504">AC504</a></td>
                <td><abbr title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr></td>
              </tr>
              <tr>
                <td>5</td>
                <td>Supuesto DDL</td>
                <td><a href="05ddl.html#AC507">AC507</a></td>
                <td><abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr
                    title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr
                    title="Se han definido los campos clave en las tablas.">CE2d</abbr>, <abbr
                    title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr></td>
              </tr>
              <tr>
                <td>6</td>
                <td><a href="05ddl.html#cargando-datos">Cargando y exportando datos</a></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td>7</td>
                <td>DML. <a href="05ddl.html#inserciones">Inserciones</a></td>
                <td><a href="05ddl.html#AC510">AC510</a></td>
                <td><abbr
                    title="Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos.">CE4a</abbr>,
                  <abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr>
                </td>
              </tr>
              <tr>
                <td>8</td>
                <td>DML. <a href="05ddl.html#modificaciones">Actualizaciones</a> y <a
                    href="05ddl.html#borrados">Borrados</a></td>
                <td><a href="05ddl.html#AC511">AC511</a></td>
                <td><abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr>, <abbr
                    title="Se han diseñado guiones de sentencias para llevar a cabo tareas complejas.">CE4d</abbr></td>
              </tr>
              <tr>
                <td>9</td>
                <td>Supuesto DDL-DML I</td>
                <td><a href="05ddl.html#AC514">AC514</a></td>
                <td><abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr
                    title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr
                    title="Se han definido los campos clave en las tablas.">CE2d</abbr>, <abbr
                    title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr>, <abbr
                    title="Se han diseñado guiones de sentencias para llevar a cabo tareas complejas.">CE4d</abbr></td>
              </tr>
              <tr>
                <td>10</td>
                <td>Supuesto DDL-DML II</td>
                <td><a href="05ddl.html#AC515">AC515</a></td>
                <td><abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr>, <abbr
                    title="Se han diseñado guiones de sentencias para llevar a cabo tareas complejas.">CE4d</abbr></td>
              </tr>
              <tr>
                <td>11</td>
                <td>Reto - Diseño físico</td>
                <td><a href="05ddl.html#PY516">PY516</a></td>
                <td><abbr title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr>, <abbr
                    title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr
                    title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr
                    title="Se han definido los campos clave en las tablas.">CE2d</abbr>, <abbr
                    title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr>, <abbr
                    title="Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos.">CE4a</abbr>,
                  <abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr>, <abbr
                    title="Se han diseñado guiones de sentencias para llevar a cabo tareas complejas.">CE4d</abbr>
                </td>
              </tr>
            </tbody>
          </table>
          <p>Al finalizar esta unidad, comenzaremos un nuevo reto, centrado en el modelo físico, creando y cargando
            datos.</p>
          <h2 id="modelo-fisico">Modelo físico<a class="headerlink" href="05ddl.html#modelo-fisico"
              title="Permanent link">&para;</a></h2>
          <p>El modelo físico es la traducción del modelo lógico a un modelo interno, dando lugar a un esquema físico
            interpretable por un SGBD concreto, paso final del diseño de las bases de datos.</p>
          <figure style="align: center;">
            <img src="../images/02modelos.png" width="800" title="Del diseño a los modelos">
            <figcaption>Del diseño a los modelos</figcaption>
          </figure>

          <p>Para ello, transformaremos el modelo relacional al modelo físico utilizando un lenguaje específico de cada
            SGBD que nos permite definir los elementos, el cual se conoce como DDL (<em>Data Definition Language</em>).
          </p>
          <h2 id="sql">SQL<a class="headerlink" href="05ddl.html#sql" title="Permanent link">&para;</a></h2>
          <p>SQL (<em>sequel</em> en inglés) es la <em>lingua franca</em> para interactuar con las bases de datos
            relacionales. Es un lenguaje declarativo, donde lo importante es definir qué se quiere hacer, en lugar de
            cómo se va a hacer. </p>
          <p>Su origen se remonta a 1970 cuando <em>Edgar Frank Codd</em> publica el documento “<em>Un modelo relacional
              de datos para grandes bancos de datos compartidos</em>”, donde se definieron las bases del modelo
            relacional.</p>
          <div class="admonition info">
            <p class="admonition-title">Versiones</p>
            <p>El lenguaje SQL ha ido evolucionando conforme lo han hecho los diferentes SGBD y tecnologías, desde el
              primer estándar en el año 1986 hasta la última versión de 2023:</p>
            <ul>
              <li>SQL-86: funcionalidad mínima para que un lenguaje se considere SQL, introduciendo las sentencia
                <code>SELECT</code>, <code>CREATE TABLE</code>, <code>INSERT</code>, ... y <code>JOIN</code>.
              </li>
              <li>SQL-89: añade instrucciones para gestionar las claves ajenas (reglas de integridad referencial).</li>
              <li>SQL-92: standard base. Introduce los tipos de datos para trabajar con fechas, como <code>DATE</code>,
                <code>TIME</code> y <code>TIMESTAMP</code>, la agregación de consultas con <code>GROUP BY</code> y sus
                operadores <code>COUNT</code> y <code>SUM</code>, así como la validación de los campos con
                <code>CHECK</code>.
              </li>
              <li>SQL:1999 (SQL3): se añaden soporte para la programación orientada objetos y el uso de
                <em>triggers</em> y procedimientos almacenados mediante PL/SQL.
              </li>
              <li>SQL:2003: añade características de XML y las funciones ventana, así como el uso de
                <code>SEQUENCE</code> para generar valores únicos.
              </li>
              <li>SQL:2008: introduce soporte para datos temporales, la instrucción <code>MERGE</code> para combinar
                datos y mejoras en las expresiones de tabla comunes (con <code>WITH</code>).</li>
              <li>SQL:2016: introduce soporte nativo para JSON y funciones para manejar datos geoespaciales.</li>
            </ul>
          </div>
          <p>SQL se divide a su vez en cuatro "sublenguajes" de datos respecto a la funcionalidad que ofrecen:</p>
          <ul>
            <li><strong>DDL</strong> (<em>Data Definition Language</em>): permite crear y manipular la estructura de una
              base de datos.</li>
            <li><strong>DML</strong> (<em>Data Manipulation Language</em>): permite recuperar, almacenar, modificar, y
              eliminar datos de una BD. Dentro de DML, algunos autores definen <strong>DQL</strong> (<em>Data Query
                Language</em>) como el sublenguaje para realizar las consultas sobre las tablas para recuperar los
              datos.</li>
            <li><strong>DCL</strong> (<em>Data Control Language</em>): permite crear roles, permisos y usuarios,
              controlando el acceso a los elementos de nuestras bases de datos.</li>
            <li><strong>TCL</strong> (<em>Transaction Control Language</em>): administra las modificaciones creadas con
              el DML.</li>
          </ul>
          <p>En esta sesión nos vamos a centrar en los lenguajes DDL y DML, definiendo la estructura de una base de
            datos y rellenándola con datos. En las <a href="06sql.html">tres unidades siguientes</a> aprenderemos la
            parte de DQL para realizar consultas. Y para terminar el bloque, en la <a href="09dcl-tcl.html">unidad 9</a>
            estudiaremos en profundidad tanto el lenguaje DCL como el TCL.</p>
          <h3 id="sintaxis">Sintaxis<a class="headerlink" href="05ddl.html#sintaxis" title="Permanent link">&para;</a>
          </h3>
          <p>La sintaxis de SQL se define mediante instrucciones que tiene diferentes parámetros, unos opcionales, otros
            con diferentes valores, etc.. La nomenclatura que vamos a emplear al explicar la sintaxis de cada
            instrucción será la siguiente:</p>
          <table>
            <thead>
              <tr>
                <th>Símbolo</th>
                <th>Descripción</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>MAYÚSCULAS</td>
                <td>Palabras reservadas (<em>keywords</em>) de SQL</td>
              </tr>
              <tr>
                <td>minúsculas</td>
                <td>variable que hay que sustituir por un elemento concreto</td>
              </tr>
              <tr>
                <td><code>[]</code></td>
                <td>opcional</td>
              </tr>
              <tr>
                <td><code>|</code></td>
                <td>separa opciones alternativas</td>
              </tr>
              <tr>
                <td><code>[ | ]</code></td>
                <td>se elige uno de los valores</td>
              </tr>
              <tr>
                <td><code>{}</code></td>
                <td>obliga a elegir uno de los valores</td>
              </tr>
              <tr>
                <td><code>...</code></td>
                <td>número variable de datos</td>
              </tr>
            </tbody>
          </table>
          <p>Así pues, si por ejemplo, la sintaxis de una instrucción es la siguiente:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="k">ALL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">DISTINCT</span><span class="p">]</span><span class="w"> </span><span class="n">columna1</span><span class="w"> </span><span class="p">[,</span><span class="n">columna2</span><span class="p">,</span><span class="w"> </span><span class="n">columna3</span><span class="p">,.......]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">*</span>
<span class="linenos" data-linenos="2 "></span><span class="k">FROM</span><span class="w"> </span><span class="n">tabla1</span><span class="w"> </span><span class="p">[</span><span class="n">tabla2</span><span class="p">,</span><span class="w"> </span><span class="n">tabla3</span><span class="p">,</span><span class="w"> </span><span class="err">…</span><span class="p">.]</span>
<span class="linenos" data-linenos="3 "></span><span class="p">[</span><span class="k">WHERE</span><span class="w"> </span><span class="n">condición</span><span class="w"> </span><span class="p">]</span>
<span class="linenos" data-linenos="4 "></span><span class="p">[</span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">expr1</span><span class="w"> </span><span class="p">[</span><span class="k">DESC</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">ASC</span><span class="p">]</span><span class="w"> </span><span class="p">[,</span><span class="w"> </span><span class="n">expr2</span><span class="w"> </span><span class="p">[</span><span class="k">DESC</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">ASC</span><span class="p">]</span><span class="w"> </span><span class="p">....]</span>
</code></pre>
          </div>
          <p>Destacar que las instrucciones finalizan con el signo de punto y coma (<code>;</code>) y que se emplea el
            doble guion (<code>--</code>) para introducir comentarios. Además, cualquier instrucción SQL puede ser
            partida por espacios o saltos de línea antes de finalizar la instrucción, facilitando su lectura. Así pues,
            posibles sentencias que cumplen la sintaxis son:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">-- Ejemplos de instrucciones SQL</span>
<span class="linenos" data-linenos="2 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">dni</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cliente</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">salario</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cliente</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">salario</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">salario</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="n">nombre</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">cliente</span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">salario</span><span class="w"> </span><span class="k">DESC</span><span class="p">;</span>
</code></pre>
          </div>
          <div class="admonition info">
            <p class="admonition-title">Case sensitive</p>
            <p>En entornos <em>Windows</em>, a la hora de citar a las tablas o sus campos, no se distingue entre
              mayúsculas y minúsculas, pero en entornos Linux sí. Así pues, es recomendable respetar el uso de
              mayúsculas y minúsculas.
              Respecto a las <em>keywords</em>, son <em>case insensitive</em>, pero al menos es recomendable hacer un
              uso homogéneo a lo largo de nuestras aplicaciones.</p>
            <p>Dicho esto, las siguientes sentencias son semejantes:</p>
            <div class="highlight">
              <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cliente</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">select</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">cliente</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="k">Select</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="k">From</span><span class="w"> </span><span class="n">cliente</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="k">SelecT</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="k">FroM</span><span class="w"> </span><span class="n">cliente</span><span class="p">;</span>
</code></pre>
            </div>
          </div>
          <h2 id="ddl">DDL<a class="headerlink" href="05ddl.html#ddl" title="Permanent link">&para;</a></h2>
          <p>Al empezar esta unidad habíamos comentado que DDL es el lenguaje encargado de definir las estructuras de
            las bases de datos, esto es, permite la creación, modificación y eliminación de los objetos de la base de
            datos (metadatos), como, por ejemplo, las bases de datos, tablas, índices o vistas.</p>
          <div class="admonition info inline end">
            <p class="admonition-title">TRUNCATE</p>
            <p>Mientras que con <code>DROP</code> podemos borrar una tabla, con <code>TRUNCATE</code> vaciaremos las
              tablas de su contenido. Es por ello, que no se considera una operación DDL, sino más bien DML.</p>
          </div>
          <p>Para ello, utilizaremos principalmente tres tipos de sentencias:</p>
          <ul>
            <li><code>CREATE</code>: permite crear nuevas tablas, vistas e índices.</li>
            <li><code>ALTER</code>: permite modificar la estructura de un elemento, como por ejemplo en las tablas
              agregando o eliminando campos, cambiando la definición de tipos, etc...</li>
            <li><code>DROP</code>: empleado para eliminar las tablas y los índices.</li>
          </ul>
          <h3 id="puesta-en-marcha">Puesta en marcha<a class="headerlink" href="05ddl.html#puesta-en-marcha"
              title="Permanent link">&para;</a></h3>
          <p>Para trabajar con un SGBD tenemos varias posibilidades. Una de ellas es mediante una solución ya desplegada
            en la nube, como veremos en la siguiente unidad. La segunda sería que lo instalásemos en nuestro sistema
            operativo mediante las instrucciones que ofrecen en sus páginas web, o bien utilizar uno de los paquetes
            "todo incluido" que ofrecen plataformas como <a href="https://bitnami.com/">Bitnami</a> (ya sea <a
              href="https://www.apachefriends.org/bitnami_for_xampp.html">XAMPP</a> u otro paquete). Nosotros nos hemos
            decantado por la tercera posibilidad, el uso de contenedores <a href="https://www.docker.com/">Docker</a>
            para aislar los servicios que utilicemos con lo que tengamos instalado en nuestros ordenadores. Por ello, en
            <a href="00entorno.html">Entornos</a> tiene toda la información necesaria tanto para poner en marcha <a
              href="00entorno.html#mariadb">MariaDB</a> como <a href="00entorno.html#postgresql">PostgreSQL</a>.
          </p>
          <p>Una vez instalados los SGBD y conectados a los mismos, ya sean mediante la consola o la interfaz gráfica,
            debemos saber que aunque el 90% de la sintaxis de SQL es común, cada SGBD tiene sus particularidades. Es por
            ello que en este curso vamos a trabajar con <em>MariaDB</em> y <em>PostgreSQL</em> de manera indistinta.</p>
          <p>Recuerda que todas las instrucciones terminan en <code>;</code> y que vamos a dejar en MAYÚSCULAS las
            <em>keywords</em> para facilitar la lectura, aunque no es obligatorio escribirlas así.
          </p>
          <div class="admonition question">
            <p class="admonition-title">Autoevaluación</p>
            <p>En este momento deberías tener tanto <em>MariaDB</em> como <em>PostgreSQL</em> instalado en local y ser
              capaz de conectarte desde la línea de comandos.</p>
            <p>Una vez dentro, ejecuta los siguientes comandos y comprueba si entiendes qué realiza cada una de las
              siguientes sentencias:</p>
            <div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1"
                name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" />
              <div class="tabbed-labels"><label for="__tabbed_1_1">MariaDB</label><label
                  for="__tabbed_1_2">PostgreSQL</label></div>
              <div class="tabbed-content">
                <div class="tabbed-block">
                  <div class="highlight">
                    <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">SHOW</span><span class="w"> </span><span class="n">DATABASES</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="n">USE</span><span class="w"> </span><span class="n">mibd</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="k">SHOW</span><span class="w"> </span><span class="n">TABLES</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="k">DESCRIBE</span><span class="w"> </span><span class="n">mitabla</span><span class="p">;</span>
</code></pre>
                  </div>
                </div>
                <div class="tabbed-block">
                  <div class="highlight">
                    <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="k">version</span><span class="p">();</span>
<span class="linenos" data-linenos="2 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">datname</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">pg_database</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="err">\</span><span class="n">l</span>
<span class="linenos" data-linenos="4 "></span><span class="err">\</span><span class="n">dt</span>
</code></pre>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <p>Comencemos con un caso muy sencillo, donde vamos a crear una tabla con un campo, insertar un registro y
            finalmente consultar la información recién almacenada:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ejemplo8a</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>
<span class="linenos" data-linenos="4 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">ejemplo8a</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Aitor Medrano&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="5 "></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ejemplo8a</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Una vez conectados a nuestros SGBD y comprobado que podemos crear estructuras, insertar datos y
            consultarlos, vamos a profundizar en la definición de los esquemas relacionales.</p>
          <h3 id="bases-de-datos">Bases de datos<a class="headerlink" href="05ddl.html#bases-de-datos"
              title="Permanent link">&para;</a></h3>
          <p>El principal elemento en un SGBD es la base de datos.</p>
          <p>Cuando nos conectamos, indicaremos siempre a qué base de datos lo hacemos. De todos modos, siempre podemos
            consultar las bases de datos existentes:</p>
          <div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1"
              name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" />
            <div class="tabbed-labels"><label for="__tabbed_2_1">MariaDB</label><label
                for="__tabbed_2_2">PostgreSQL</label></div>
            <div class="tabbed-content">
              <div class="tabbed-block">
                <p>En el caso de <em>MariaDB</em> usaremos el comando <a
                    href="https://mariadb.com/kb/en/show-databases/"><code>SHOW DATABASES</code></a>:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span>MariaDB [pruebas]&gt; show databases;
<span class="linenos" data-linenos="2 "></span>+--------------------+
<span class="linenos" data-linenos="3 "></span>| Database           |
<span class="linenos" data-linenos="4 "></span>+--------------------+
<span class="linenos" data-linenos="5 "></span>| information_schema |
<span class="linenos" data-linenos="6 "></span>| pruebas            |
<span class="linenos" data-linenos="7 "></span>+--------------------+
<span class="linenos" data-linenos="8 "></span>2 rows in set (0.001 sec)
</code></pre>
                </div>
              </div>
              <div class="tabbed-block">
                <p>Si solo queremos el nombre de las bases de datos, podemos hacer una consulta a la tabla
                  <code>pg_database</code> (que cumple la función de diccionario de datos):
                </p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span>pruebas=# SELECT datname FROM pg_database;
<span class="linenos" data-linenos="2 "></span>datname  
<span class="linenos" data-linenos="3 "></span>-----------
<span class="linenos" data-linenos="4 "></span>postgres
<span class="linenos" data-linenos="5 "></span>pruebas
<span class="linenos" data-linenos="6 "></span>template1
<span class="linenos" data-linenos="7 "></span>template0
<span class="linenos" data-linenos="8 "></span>(4 rows)
</code></pre>
                </div>
                <p>Si queremos toda la información, podemos hacer uso del metacomando <code>\l</code>:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span>pruebas=# \l
<span class="linenos" data-linenos=" 2 "></span>                                                List of databases
<span class="linenos" data-linenos=" 3 "></span>Name    | Owner | Encoding | Locale Provider |  Collate   |   Ctype    | ICU Locale | ICU Rules | Access privileges       
<span class="linenos" data-linenos=" 4 "></span>-----------+-------+----------+-----------------+------------+------------+------------+-----------+-------------------      
<span class="linenos" data-linenos=" 5 "></span>postgres  | s8a   | UTF8     | libc            | en_US.utf8 | en_US.utf8 |            |           |
<span class="linenos" data-linenos=" 6 "></span>pruebas   | s8a   | UTF8     | libc            | en_US.utf8 | en_US.utf8 |            |           |
<span class="linenos" data-linenos=" 7 "></span>template0 | s8a   | UTF8     | libc            | en_US.utf8 | en_US.utf8 |            |           | =c/s8a           +      
<span class="linenos" data-linenos=" 8 "></span>        |       |          |                 |            |            |            |           | s8a=CTc/s8a
<span class="linenos" data-linenos=" 9 "></span>template1 | s8a   | UTF8     | libc            | en_US.utf8 | en_US.utf8 |            |           | =c/s8a           +      
<span class="linenos" data-linenos="10 "></span>        |       |          |                 |            |            |            |           | s8a=CTc/s8a
<span class="linenos" data-linenos="11 "></span>(4 rows)
</code></pre>
                </div>
              </div>
            </div>
          </div>
          <p>Para crear una base de datos, usaremos la sentencia <code>CREATE DATABASE</code>:</p>
          <div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1"
              name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" />
            <div class="tabbed-labels"><label for="__tabbed_3_1">MariaDB</label><label
                for="__tabbed_3_2">PostgreSQL</label></div>
            <div class="tabbed-content">
              <div class="tabbed-block">
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="p">[</span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">]</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="p">[</span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="p">]</span><span class="w"> </span><span class="n">nombreBD</span><span class="p">;</span>
</code></pre>
                </div>
                <p>Por ejemplo:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">midb</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">severo</span><span class="p">;</span>
</code></pre>
                </div>
                <p>Más información en la <a href="https://mariadb.com/kb/en/create-database/">documentación oficial</a>
                </p>
              </div>
              <div class="tabbed-block">
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">nombreBD</span><span class="p">;</span>
</code></pre>
                </div>
                <p>Por ejemplo:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">severo</span><span class="p">;</span>
</code></pre>
                </div>
                <p>Más información en la <a
                    href="https://www.postgresql.org/docs/current/sql-createdatabase.html">documentación oficial</a></p>
              </div>
            </div>
          </div>
          <p>Una vez creada, nos hemos de conectar a la base de datos para gestionar sus elementos.</p>
          <div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1"
              name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" />
            <div class="tabbed-labels"><label for="__tabbed_4_1">MariaDB</label><label
                for="__tabbed_4_2">PostgreSQL</label></div>
            <div class="tabbed-content">
              <div class="tabbed-block">
                <p>En <em>MariaDB</em> usaremos el comando <a
                    href="https://mariadb.com/docs/server/reference/sql-statements/administrative-sql-statements/use-database"><code>USE</code></a>
                </p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">USE</span><span class="w"> </span><span class="n">nombreBD</span><span class="p">;</span>
</code></pre>
                </div>
                <p>Por ejemplo:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">USE</span><span class="w"> </span><span class="n">severo</span><span class="p">;</span>
</code></pre>
                </div>
              </div>
              <div class="tabbed-block">
                <p>En <em>PostgreSQL</em> usaremos el metacomando <a
                    href="https://mariadb.com/docs/server/reference/sql-statements/administrative-sql-statements/use-database"><code>\c</code></a>
                </p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="err">\</span><span class="k">c</span><span class="w"> </span><span class="n">nombreBD</span><span class="p">;</span>
</code></pre>
                </div>
                <p>Por ejemplo:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="err">\</span><span class="k">c</span><span class="w"> </span><span class="n">severo</span><span class="p">;</span>
</code></pre>
                </div>
              </div>
            </div>
          </div>
          <p>Si necesitamos borrarla, porque ya no la necesitamos, usaremos la sentencia <code>DROP DATABASE</code>,
            tanto en <a href="https://mariadb.com/kb/en/drop-database">MariaDB</a> como en <a
              href="https://www.postgresql.org/docs/current/sql-dropdatabase.html">PostgreSQL</a>:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DROP</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="p">[</span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="p">]</span><span class="w"> </span><span class="n">nombreBD</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Por ejemplo:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DROP</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">prueba</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">DROP</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">severo</span><span class="p">;</span>
</code></pre>
          </div>
          <h3 id="almacenamiento">Almacenamiento<a class="headerlink" href="05ddl.html#almacenamiento"
              title="Permanent link">&para;</a></h3>
          <p>A la hora de almacenar la información de una base de datos, tanto a nivel lógico como físico, necesitamos
            de diferentes elementos que conviene conocer.</p>
          <h4 id="jerarquia-logica-de-una-bd">Jerarquía lógica de una BD<a class="headerlink"
              href="05ddl.html#jerarquia-logica-de-una-bd" title="Permanent link">&para;</a></h4>
          <figure style="float: right;">
            <img src="../images/05estructura-logica.png" width="425" title="Jerarquía lógica">
            <figcaption>Jerarquía lógica</figcaption>
          </figure>

          <p>A nivel lógico, los elementos que organizan la información de una base de datos, y dependiendo del soporte
            de cada sistema gestor de base de datos, se definen mediante la siguiente jerarquía:</p>
          <ul>
            <li><strong><em>Tablespace</em></strong> o espacio de tablas: estructura física (normalmente una
              carpeta/directorio) para agrupar varias bases de datos o esquemas (en <em>MySQL</em>/<em>MariaDB</em> <a
                href="https://mariadb.com/kb/en/create-tablespace/">no está soportado</a>).</li>
            <li><strong>Base de datos</strong>: elemento lógico de nivel superior.</li>
            <li><strong>Esquema</strong>: agrupación lógica de una o más tablas (en <em>MySQL</em>/<em>MariaDB</em> un
              esquema es una base de datos, es decir, son conceptos sinónimos).</li>
            <li><strong>Tabla</strong>: representación de una tabla relacional, que contiene datos organizados en filas
              y columnas. Cada tabla pertenece a un esquema o base de datos específico, y sus datos se almacenan en el
              <em>tablespace</em> asociado (normalmente no lo indicamos, ya que se almacena en el espacio por defecto).
            </li>
          </ul>
          <div class="admonition info">
            <p class="admonition-title">Esquema vs Tablespace</p>
            <p>Ambas estructuras permiten organizar los recursos de una base de datos, pero en el mundo del desarrollo
              de software actual, los <em>schemas</em> se usan frecuentemente. En cambio, los <em>tablespaces</em> se
              reservan para casos especiales de administración del almacenamiento físico, más propios de administradores
              de sistemas de bases de datos.</p>
            <p>Un <strong>esquema</strong> es una forma de organizar objetos (tablas, vistas, funciones, etc.) dentro de
              una base de datos. Un <em>schema</em> es como un <em>namespace</em> o espacio de nombres. En el caso de
              <em>PostgreSQL</em>, todas las bases de datos tienen el esquema <code>public</code>. Se utilizan para:
            </p>
            <ul>
              <li>Separar lógicamente distintos módulos o partes de una aplicación dentro de la misma base de datos. Por
                ejemplo, ventas, contabilidad, almacén, etc...</li>
              <li>Gestionar permisos más fácilmente.</li>
              <li>Evitar conflictos de nombres entre tablas o funciones.</li>
            </ul>
            <p>Por otro lado, un <strong><em>tablespace</em></strong> es una ubicación física en el sistema de archivos
              donde el SGBD almacena datos. Se utilizan para:</p>
            <ul>
              <li>Separar datos físicamente (por rendimiento, disponibilidad de espacio, etc.), por ejemplo, en bases de
                datos muy grandes que necesitan distribuirse en varios discos.</li>
              <li>Colocar tablas/indexes grandes en discos específicos de alto rendimiento.</li>
            </ul>
            <p>En conclusión, el uso de <em>tablespace</em> y <em>schema</em> es independiente: uno organiza el
              almacenamiento físico (<em>tablespace</em>) y el otro el lógico (<em>schema</em>).</p>
          </div>
          <p><em>MariaDB</em> es un sistema más sencillo que se basa únicamente en bases de datos y tablas. En cambio,
            <em>PostgreSQL</em> sí que permite definir la jerarquía completa, desde el espacio de tablas, la base de
            datos, el esquema y las tablas.
          </p>
          <p>Así pues, si nos centramos en <em>PostgreSQL</em>, para crear un <em>schema</em>, utilizaremos la sentencia
            <a href="https://www.postgresql.org/docs/current/sql-createschema.html"><code>CREATE SCHEMA</code></a>,
            mientras que para crear un espacio de tabla usaremos la instrucción <a
              href="https://www.postgresql.org/docs/current/sql-createtablespace.html"><code>CREATE TABLESPACE</code></a>.
            Una vez creados, podemos relacionarlos, por ejemplo, asociando una tabla a un <em>tablespace</em> o creando
            una tabla dentro de un determinado esquema.
          </p>
          <p>Respecto al uso de esquemas, destacar para indicar el esquema activo, hemos de cambiar la configuración de
            la variable <code>search_path</code> mediante el comando <a
              href="https://www.postgresql.org/docs/current/sql-set.html"><code>SET search_path TO nombreEsquema</code></a>.
            Además, si queremos saber cuál es el esquema activo, recuperaremos el valor de <code>search_path</code>
            mediante el comando <code>SHOW search_path</code>.</p>
          <p>Veamos un ejemplo sencillo donde creamos y utilizamos estas estructuras lógicas. Primero vamos a crear una
            carpeta con los permisos adecuados y, seguidamente, nos conectamos con el cliente <code>psql</code>:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span>mkdir<span class="w"> </span>/data/dbs
<span class="linenos" data-linenos="2 "></span>chown<span class="w"> </span>postgres:postgres<span class="w"> </span>/data/dbs
<span class="linenos" data-linenos="3 "></span>
<span class="linenos" data-linenos="4 "></span>psql<span class="w"> </span>-U<span class="w"> </span>s8a<span class="w"> </span>pruebas
</code></pre>
          </div>
          <p>A continuación, creamos los diferentes recursos:</p>
          <div class="highlight"><span class="filename">create-postgre.sql</span>
            <pre><span></span><code><span class="hll"><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">mi_tablespace</span><span class="w"> </span><span class="k">LOCATION</span><span class="w"> </span><span class="s1">&#39;/data/dbs&#39;</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 2 "></span>
<span class="hll"><span class="linenos" data-linenos=" 3 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">mi_db</span><span class="w"> </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">mi_tablespace</span><span class="p">;</span>
</span><span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="c1">-- Nos conectamos a la base de datos creada</span>
<span class="hll"><span class="linenos" data-linenos=" 6 "></span><span class="err">\</span><span class="k">c</span><span class="w"> </span><span class="n">mi_db</span>
</span><span class="linenos" data-linenos=" 7 "></span><span class="c1">--You are now connected to database &quot;mi_db&quot; as user &quot;s8a&quot;.</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="hll"><span class="linenos" data-linenos=" 9 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">SCHEMA</span><span class="w"> </span><span class="n">mi_esquema</span><span class="p">;</span>
</span><span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="c1">-- Mostramos los esquemas</span>
<span class="hll"><span class="linenos" data-linenos="12 "></span><span class="err">\</span><span class="n">dn</span>
</span><span class="linenos" data-linenos="13 "></span><span class="c1">--         List of schemas</span>
<span class="linenos" data-linenos="14 "></span><span class="c1">--     Name    |       Owner       </span>
<span class="linenos" data-linenos="15 "></span><span class="c1">-- ------------+-------------------</span>
<span class="linenos" data-linenos="16 "></span><span class="c1">--  mi_esquema | s8a</span>
<span class="linenos" data-linenos="17 "></span><span class="c1">--  public     | pg_database_owner</span>
<span class="linenos" data-linenos="18 "></span><span class="c1">-- (2 rows)</span>
<span class="linenos" data-linenos="19 "></span>
<span class="hll"><span class="linenos" data-linenos="20 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">mi_esquema</span><span class="p">.</span><span class="n">mi_tabla</span><span class="w"> </span><span class="p">(</span>
</span><span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="linenos" data-linenos="23 "></span><span class="p">)</span><span class="w"> </span><span class="n">TABLESPACE</span><span class="w"> </span><span class="n">mi_tablespace</span><span class="p">;</span>
<span class="linenos" data-linenos="24 "></span>
<span class="linenos" data-linenos="25 "></span><span class="c1">-- Usamos el esquema recién creado</span>
<span class="hll"><span class="linenos" data-linenos="26 "></span><span class="k">SET</span><span class="w"> </span><span class="n">search_path</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">mi_esquema</span><span class="p">;</span>
</span><span class="linenos" data-linenos="27 "></span>
<span class="linenos" data-linenos="28 "></span><span class="c1">-- Mostramos las relaciones</span>
<span class="hll"><span class="linenos" data-linenos="29 "></span><span class="err">\</span><span class="n">d</span>
</span><span class="linenos" data-linenos="30 "></span><span class="c1">--                 List of relations</span>
<span class="linenos" data-linenos="31 "></span><span class="c1">--    Schema   |      Name       |   Type   | Owner </span>
<span class="linenos" data-linenos="32 "></span><span class="c1">-- ------------+-----------------+----------+-------</span>
<span class="linenos" data-linenos="33 "></span><span class="c1">--  mi_esquema | mi_tabla        | table    | s8a</span>
<span class="linenos" data-linenos="34 "></span><span class="c1">--  mi_esquema | mi_tabla_id_seq | sequence | s8a</span>
<span class="linenos" data-linenos="35 "></span><span class="c1">-- (2 rows)</span>
</code></pre>
          </div>
          <p>Destacar como mediante <a
              href="https://www.postgresql.org/docs/current/ddl-schemas.html#DDL-SCHEMAS-PATH"><code>SET search_path TO &lt;nombreEsquema&gt;</code></a>
            cambiamos el esquema por defecto.</p>
          <h4 id="motores-de-almacenamiento">Motores de almacenamiento<a class="headerlink"
              href="05ddl.html#motores-de-almacenamiento" title="Permanent link">&para;</a></h4>
          <p>En los SGBD, y en concreto en <em>MariaDB</em> y <em>PostgreSQL</em>, los motores de almacenamiento
            (<em>storage engines</em>) son fundamentales para definir el formato de almacenamiento, es decir, cómo se
            almacenan y gestionan los datos en las bases de datos. Tanto <em>MariaDB</em> como <em>PostgreSQL</em>
            ofrecen diferentes motores de almacenamiento que proporcionan distintas capacidades, que influyen en cómo se
            gestionan y organizan los datos en disco, afectando el rendimiento, la concurrencia y la eficiencia del
            espacio.</p>
          <div class="grid cards">
            <ul>
              <li>
                <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M23.157 4.412c-.676.284-.79.31-1.673.372-.65.045-.757.057-1.212.209-.75.246-1.395.75-2.02 1.59-.296.398-1.249 1.913-1.249 1.988 0 .057-.65.998-.915 1.32-.574.713-1.08 1.079-2.14 1.59-.77.36-1.224.524-4.102 1.477-1.073.353-2.133.738-2.367.864-.852.449-1.515 1.036-2.203 1.938-1.003 1.32-.972 1.313-3.042.947a12 12 0 0 0-.675-.063c-.644-.05-1.023.044-1.332.334L0 17.193l.177.088c.094.05.353.234.561.398.215.17.461.347.55.391.088.044.17.088.183.101s-.089.17-.228.353c-.435.581-.593.871-.574 1.048.019.164.032.17.43.17.517-.006.826-.056 1.261-.208.65-.233 2.058-.94 2.784-1.4.776-.5 1.717-.998 1.956-1.042.082-.02.354-.07.594-.114.58-.107 1.464-.095 2.587.05.108.013.373.045.6.064.227.025.43.057.454.076.026.012.474.037.998.056.934.026 1.104.007 1.3-.189.126-.133.385-.631.498-.985.209-.643.417-.921.366-.492-.113.966-.322 1.692-.713 2.411-.259.499-.663 1.092-.934 1.395-.322.347-.315.36.088.315.619-.063 1.471-.397 2.096-.82.827-.562 1.647-1.691 2.19-3.03.107-.27.22-.22.183.083-.013.094-.038.315-.057.498l-.031.328.353-.202c.833-.48 1.414-1.262 2.127-2.884.227-.518.877-2.922 1.073-3.976a10 10 0 0 1 .271-1.042c.127-.429.196-.555.48-.858.183-.19.625-.555.978-.808.72-.505.953-.75 1.187-1.205.208-.417.284-1.13.132-1.357-.132-.202-.284-.196-.763.006" />
                    </svg></span> <strong><em>MariaDB</em></strong></p>
                <p>Los motores más conocidos son:</p>
                <ul>
                  <li>
                    <p><strong><em>InnoDB</em></strong>: motor de almacenamiento predeterminado en <em>MariaDB</em>,
                      desde la versión 10.2. Proporciona soporte completo para transacciones ACID. Maneja bloqueo a
                      nivel de fila y cuenta con soporte para claves ajenas. Finalmente, es adecuado para aplicaciones
                      donde la integridad y las transacciones sean críticas.</p>
                  </li>
                  <li>
                    <p><strong><em>MyISAM</em></strong>: Históricamente, fue el motor de almacenamiento por defecto en
                      <em>MySQL</em> antes de <em>InnoDB</em>. Su uso ha caído al no ser transaccional y no soportar
                      claves ajenas. Se utiliza principalmente en aplicaciones que priorizan el rendimiento de las
                      lecturas sobre la integridad de los datos.
                    </p>
                  </li>
                </ul>
                <p>Existen otros motores más específicos como <em>TokuDB</em> (para grandes volúmenes de datos con alta
                  concurrencia y compresión), <em>Aria</em> (utilizado para recuperación rápida y consultas de solo
                  lectura), <em>ColumnStore</em> (en aplicaciones de análisis de datos) o <em>Memory</em> (para tablas
                  temporales y cachés rápidas).</p>
              </li>
              <li>
                <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M23.56 14.723a.5.5 0 0 0-.057-.12q-.21-.395-1.007-.231c-1.654.34-2.294.13-2.526-.02 1.342-2.048 2.445-4.522 3.041-6.83.272-1.05.798-3.523.122-4.73a1.6 1.6 0 0 0-.15-.236C21.693.91 19.8.025 17.51.001c-1.495-.016-2.77.346-3.116.479a10 10 0 0 0-.516-.082 8 8 0 0 0-1.312-.127c-1.182-.019-2.203.264-3.05.84C8.66.79 4.729-.534 2.296 1.19.935 2.153.309 3.873.43 6.304c.041.818.507 3.334 1.243 5.744q.69 2.26 1.433 3.582.83 1.493 1.714 1.79c.448.148 1.133.143 1.858-.729a56 56 0 0 1 1.945-2.206c.435.235.906.362 1.39.377v.004a11 11 0 0 0-.247.305c-.339.43-.41.52-1.5.745-.31.064-1.134.233-1.146.811a.6.6 0 0 0 .091.327c.227.423.922.61 1.015.633 1.335.333 2.505.092 3.372-.679-.017 2.231.077 4.418.345 5.088.221.553.762 1.904 2.47 1.904q.375.001.829-.094c1.782-.382 2.556-1.17 2.855-2.906.15-.87.402-2.875.539-4.101.017-.07.036-.12.057-.136 0 0 .07-.048.427.03l.044.007.254.022.015.001c.847.039 1.911-.142 2.531-.43.644-.3 1.806-1.033 1.595-1.67M2.37 11.876c-.744-2.435-1.178-4.885-1.212-5.571-.109-2.172.417-3.683 1.562-4.493 1.837-1.299 4.84-.54 6.108-.13l-.01.01C6.795 3.734 6.843 7.226 6.85 7.44c0 .082.006.199.016.36.034.586.1 1.68-.074 2.918-.16 1.15.194 2.276.973 3.089q.12.126.252.237c-.347.371-1.1 1.193-1.903 2.158-.568.682-.96.551-1.088.508-.392-.13-.813-.587-1.239-1.322-.48-.839-.963-2.032-1.415-3.512m6.007 5.088a1.6 1.6 0 0 1-.432-.178c.089-.039.237-.09.483-.14 1.284-.265 1.482-.451 1.915-1 .099-.127.211-.27.367-.443a.4.4 0 0 0 .074-.13c.17-.151.272-.11.436-.042.156.065.308.26.37.475.03.102.062.295-.045.445-.904 1.266-2.222 1.25-3.168 1.013m2.094-3.988-.052.14c-.133.357-.257.689-.334 1.004-.667-.002-1.317-.288-1.81-.803-.628-.655-.913-1.566-.783-2.5.183-1.308.116-2.447.08-3.059l-.013-.22c.296-.262 1.666-.996 2.643-.772.446.102.718.406.83.928.585 2.704.078 3.83-.33 4.736a9 9 0 0 0-.23.546m7.364 4.572q-.024.266-.062.596l-.146.438a.4.4 0 0 0-.018.108c-.006.475-.054.649-.115.87-.064.229-.135.488-.18 1.057-.11 1.414-.878 2.227-2.417 2.556-1.515.325-1.784-.496-2.02-1.221a7 7 0 0 0-.078-.227c-.215-.586-.19-1.412-.157-2.555.016-.561-.025-1.901-.33-2.646q.006-.44.019-.892a.4.4 0 0 0-.016-.113 2 2 0 0 0-.044-.208c-.122-.428-.42-.786-.78-.935-.142-.059-.403-.167-.717-.087.067-.276.183-.587.309-.925l.053-.142c.06-.16.134-.325.213-.5.426-.948 1.01-2.246.376-5.178-.237-1.098-1.03-1.634-2.232-1.51-.72.075-1.38.366-1.709.532a6 6 0 0 0-.196.104c.092-1.106.439-3.174 1.736-4.482a4 4 0 0 1 .303-.276.35.35 0 0 0 .145-.064c.752-.57 1.695-.85 2.802-.833q.616.01 1.174.081c1.94.355 3.244 1.447 4.036 2.383.814.962 1.255 1.931 1.431 2.454-1.323-.134-2.223.127-2.68.78-.992 1.418.544 4.172 1.282 5.496.135.242.252.452.289.54.24.583.551.972.778 1.256.07.087.138.171.189.245-.4.116-1.12.383-1.055 1.717-.013.156-.043.447-.084.815-.046.208-.07.46-.1.766m.89-1.621c-.04-.832.27-.919.597-1.01l.135-.041a1 1 0 0 0 .134.103c.57.376 1.583.421 3.007.134-.202.177-.519.4-.953.601-.41.19-1.096.333-1.747.364-.72.034-1.086-.08-1.173-.151m.57-9.271c-.006.35-.054.669-.105 1.001-.055.358-.112.728-.127 1.177-.014.436.04.89.093 1.33.107.887.216 1.8-.207 2.701a4 4 0 0 1-.188-.385 8 8 0 0 0-.325-.617c-.616-1.104-2.057-3.69-1.32-4.744.38-.543 1.342-.566 2.179-.463m.228 7.013-.085-.107-.035-.044c.726-1.2.584-2.387.457-3.439-.052-.432-.1-.84-.088-1.222.013-.407.066-.755.118-1.092.064-.415.13-.844.111-1.35a.6.6 0 0 0 .012-.19c-.046-.486-.6-1.938-1.73-3.253a7.8 7.8 0 0 0-2.688-2.04A9.3 9.3 0 0 1 17.62.746c2.052.046 3.675.814 4.824 2.283a1 1 0 0 1 .067.1c.723 1.356-.276 6.275-2.987 10.54m-8.816-6.116c-.025.18-.31.423-.621.423a1 1 0 0 1-.081-.006.8.8 0 0 1-.506-.315c-.046-.06-.12-.178-.106-.285a.22.22 0 0 1 .093-.149c.118-.089.352-.122.61-.086.316.044.642.193.61.418m7.93-.411c.011.08-.049.2-.153.31a.72.72 0 0 1-.408.223 1 1 0 0 1-.075.005c-.293 0-.541-.234-.56-.371-.024-.177.264-.31.56-.352.298-.042.612.009.636.185" />
                    </svg></span> <strong><em>PostgreSQL</em></strong></p>
                <p>En cambio, <em>PostgreSQL</em> no utiliza el concepto de múltiples motores de almacenamiento como
                  <em>MariaDB</em>, sino que emplea un único motor nativo altamente configurable que ofrece muchas
                  características avanzadas:
                </p>
                <ul>
                  <li>Proporciona soporte completo para transacciones ACID, integridad referencial (claves foráneas) y
                    MVCC para la gestión de concurrencia.</li>
                  <li>Bloqueo a nivel de fila.</li>
                  <li>Muy eficiente para grandes volúmenes de datos y con soporte completo para tipos de datos avanzados
                    como JSON, XML, y más.</li>
                </ul>
                <p>Además, es posible ajustar su comportamiento, por ejemplo, permitiendo acceder a datos externos a
                  través de FDW (<em>Foreign Data Wrappers</em>), y optimizaciones internas mediante tablas
                  particionadas y configuraciones adicionales.</p>
              </li>
            </ul>
          </div>
          <div class="admonition info">
            <p class="admonition-title">Bloqueo a nivel de fila (<em>row-level locking</em>)</p>
            <p>Técnica de control de concurrencia que permite a las bases de datos bloquear únicamente las filas que
              están siendo accedidas o modificadas por una transacción, en lugar de bloquear toda la tabla o bloques más
              grandes de datos.</p>
            <p>Permite que múltiples transacciones trabajen en diferentes partes de una tabla sin interferir entre sí.
            </p>
          </div>
          <div class="admonition info">
            <p class="admonition-title">MVCC - <em>Multiversion Concurrency Control</em></p>
            <p>Cuando hay una modificación de datos, en lugar de sobrescribir una fila en actualizaciones, se almacena
              una nueva versión de la fila mientras se mantiene la versión anterior hasta que ya no sea necesaria (las
              transacciones que la usan han finalizado).</p>
            <p>Las versiones anteriores de una fila se almacenan en el espacio de "deshacer" (<em>undo space</em>) para
              permitir transacciones y lecturas consistentes.</p>
          </div>
          <p>A nivel físico, el formato de almacenamiento depende principalmente del <em>motor de almacenamiento</em>
            que se esté utilizando, ya que cada motor tiene su propia manera de organizar y almacenar los datos.</p>
          <div class="grid cards">
            <ul>
              <li>
                <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M23.157 4.412c-.676.284-.79.31-1.673.372-.65.045-.757.057-1.212.209-.75.246-1.395.75-2.02 1.59-.296.398-1.249 1.913-1.249 1.988 0 .057-.65.998-.915 1.32-.574.713-1.08 1.079-2.14 1.59-.77.36-1.224.524-4.102 1.477-1.073.353-2.133.738-2.367.864-.852.449-1.515 1.036-2.203 1.938-1.003 1.32-.972 1.313-3.042.947a12 12 0 0 0-.675-.063c-.644-.05-1.023.044-1.332.334L0 17.193l.177.088c.094.05.353.234.561.398.215.17.461.347.55.391.088.044.17.088.183.101s-.089.17-.228.353c-.435.581-.593.871-.574 1.048.019.164.032.17.43.17.517-.006.826-.056 1.261-.208.65-.233 2.058-.94 2.784-1.4.776-.5 1.717-.998 1.956-1.042.082-.02.354-.07.594-.114.58-.107 1.464-.095 2.587.05.108.013.373.045.6.064.227.025.43.057.454.076.026.012.474.037.998.056.934.026 1.104.007 1.3-.189.126-.133.385-.631.498-.985.209-.643.417-.921.366-.492-.113.966-.322 1.692-.713 2.411-.259.499-.663 1.092-.934 1.395-.322.347-.315.36.088.315.619-.063 1.471-.397 2.096-.82.827-.562 1.647-1.691 2.19-3.03.107-.27.22-.22.183.083-.013.094-.038.315-.057.498l-.031.328.353-.202c.833-.48 1.414-1.262 2.127-2.884.227-.518.877-2.922 1.073-3.976a10 10 0 0 1 .271-1.042c.127-.429.196-.555.48-.858.183-.19.625-.555.978-.808.72-.505.953-.75 1.187-1.205.208-.417.284-1.13.132-1.357-.132-.202-.284-.196-.763.006" />
                    </svg></span> <strong><em>MariaDB - InnoDB</em></strong></p>
                <ul>
                  <li>
                    <p>Un bloque almacena los datos de tablas e índices mediante páginas, normalmente de 16 KB.</p>
                  </li>
                  <li>
                    <p>Los bloques se almacenan en un archivo de <ins>tablespace</ins> (generalmente
                      <code>ibdata1</code> para bases de datos que comparten un <em>tablespace</em>, o en un archivo por
                      tabla).
                    </p>
                  </li>
                  <li>
                    <p>Respecto a las filas, se almacenan utilizando un formato compacto o redondeado, dependiendo de la
                      configuración. Cada fila contiene una clave primaria (o un índice que actúa como clave primaria) y
                      los datos correspondientes.</p>
                  </li>
                </ul>
              </li>
              <li>
                <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M23.56 14.723a.5.5 0 0 0-.057-.12q-.21-.395-1.007-.231c-1.654.34-2.294.13-2.526-.02 1.342-2.048 2.445-4.522 3.041-6.83.272-1.05.798-3.523.122-4.73a1.6 1.6 0 0 0-.15-.236C21.693.91 19.8.025 17.51.001c-1.495-.016-2.77.346-3.116.479a10 10 0 0 0-.516-.082 8 8 0 0 0-1.312-.127c-1.182-.019-2.203.264-3.05.84C8.66.79 4.729-.534 2.296 1.19.935 2.153.309 3.873.43 6.304c.041.818.507 3.334 1.243 5.744q.69 2.26 1.433 3.582.83 1.493 1.714 1.79c.448.148 1.133.143 1.858-.729a56 56 0 0 1 1.945-2.206c.435.235.906.362 1.39.377v.004a11 11 0 0 0-.247.305c-.339.43-.41.52-1.5.745-.31.064-1.134.233-1.146.811a.6.6 0 0 0 .091.327c.227.423.922.61 1.015.633 1.335.333 2.505.092 3.372-.679-.017 2.231.077 4.418.345 5.088.221.553.762 1.904 2.47 1.904q.375.001.829-.094c1.782-.382 2.556-1.17 2.855-2.906.15-.87.402-2.875.539-4.101.017-.07.036-.12.057-.136 0 0 .07-.048.427.03l.044.007.254.022.015.001c.847.039 1.911-.142 2.531-.43.644-.3 1.806-1.033 1.595-1.67M2.37 11.876c-.744-2.435-1.178-4.885-1.212-5.571-.109-2.172.417-3.683 1.562-4.493 1.837-1.299 4.84-.54 6.108-.13l-.01.01C6.795 3.734 6.843 7.226 6.85 7.44c0 .082.006.199.016.36.034.586.1 1.68-.074 2.918-.16 1.15.194 2.276.973 3.089q.12.126.252.237c-.347.371-1.1 1.193-1.903 2.158-.568.682-.96.551-1.088.508-.392-.13-.813-.587-1.239-1.322-.48-.839-.963-2.032-1.415-3.512m6.007 5.088a1.6 1.6 0 0 1-.432-.178c.089-.039.237-.09.483-.14 1.284-.265 1.482-.451 1.915-1 .099-.127.211-.27.367-.443a.4.4 0 0 0 .074-.13c.17-.151.272-.11.436-.042.156.065.308.26.37.475.03.102.062.295-.045.445-.904 1.266-2.222 1.25-3.168 1.013m2.094-3.988-.052.14c-.133.357-.257.689-.334 1.004-.667-.002-1.317-.288-1.81-.803-.628-.655-.913-1.566-.783-2.5.183-1.308.116-2.447.08-3.059l-.013-.22c.296-.262 1.666-.996 2.643-.772.446.102.718.406.83.928.585 2.704.078 3.83-.33 4.736a9 9 0 0 0-.23.546m7.364 4.572q-.024.266-.062.596l-.146.438a.4.4 0 0 0-.018.108c-.006.475-.054.649-.115.87-.064.229-.135.488-.18 1.057-.11 1.414-.878 2.227-2.417 2.556-1.515.325-1.784-.496-2.02-1.221a7 7 0 0 0-.078-.227c-.215-.586-.19-1.412-.157-2.555.016-.561-.025-1.901-.33-2.646q.006-.44.019-.892a.4.4 0 0 0-.016-.113 2 2 0 0 0-.044-.208c-.122-.428-.42-.786-.78-.935-.142-.059-.403-.167-.717-.087.067-.276.183-.587.309-.925l.053-.142c.06-.16.134-.325.213-.5.426-.948 1.01-2.246.376-5.178-.237-1.098-1.03-1.634-2.232-1.51-.72.075-1.38.366-1.709.532a6 6 0 0 0-.196.104c.092-1.106.439-3.174 1.736-4.482a4 4 0 0 1 .303-.276.35.35 0 0 0 .145-.064c.752-.57 1.695-.85 2.802-.833q.616.01 1.174.081c1.94.355 3.244 1.447 4.036 2.383.814.962 1.255 1.931 1.431 2.454-1.323-.134-2.223.127-2.68.78-.992 1.418.544 4.172 1.282 5.496.135.242.252.452.289.54.24.583.551.972.778 1.256.07.087.138.171.189.245-.4.116-1.12.383-1.055 1.717-.013.156-.043.447-.084.815-.046.208-.07.46-.1.766m.89-1.621c-.04-.832.27-.919.597-1.01l.135-.041a1 1 0 0 0 .134.103c.57.376 1.583.421 3.007.134-.202.177-.519.4-.953.601-.41.19-1.096.333-1.747.364-.72.034-1.086-.08-1.173-.151m.57-9.271c-.006.35-.054.669-.105 1.001-.055.358-.112.728-.127 1.177-.014.436.04.89.093 1.33.107.887.216 1.8-.207 2.701a4 4 0 0 1-.188-.385 8 8 0 0 0-.325-.617c-.616-1.104-2.057-3.69-1.32-4.744.38-.543 1.342-.566 2.179-.463m.228 7.013-.085-.107-.035-.044c.726-1.2.584-2.387.457-3.439-.052-.432-.1-.84-.088-1.222.013-.407.066-.755.118-1.092.064-.415.13-.844.111-1.35a.6.6 0 0 0 .012-.19c-.046-.486-.6-1.938-1.73-3.253a7.8 7.8 0 0 0-2.688-2.04A9.3 9.3 0 0 1 17.62.746c2.052.046 3.675.814 4.824 2.283a1 1 0 0 1 .067.1c.723 1.356-.276 6.275-2.987 10.54m-8.816-6.116c-.025.18-.31.423-.621.423a1 1 0 0 1-.081-.006.8.8 0 0 1-.506-.315c-.046-.06-.12-.178-.106-.285a.22.22 0 0 1 .093-.149c.118-.089.352-.122.61-.086.316.044.642.193.61.418m7.93-.411c.011.08-.049.2-.153.31a.72.72 0 0 1-.408.223 1 1 0 0 1-.075.005c-.293 0-.541-.234-.56-.371-.024-.177.264-.31.56-.352.298-.042.612.009.636.185" />
                    </svg></span> <strong><em>PostgreSQL</em></strong></p>
                <ul>
                  <li>
                    <p>De manera predeterminada, todas las bases de datos utilizan el <em>tablespace</em>
                      <code>pg_default</code>, pero se pueden crear otros <em>tablespaces</em> personalizados.
                    </p>
                  </li>
                  <li>
                    <p>Cada base de datos se representa por un directorio con un nombre numérico (OID) dentro del
                      <em>tablespace</em>. Dentro de esta carpeta se encuentran archivos que representan tablas,
                      índices, secuencias y otros objetos de la base de datos.
                    </p>
                  </li>
                  <li>
                    <p>Cada tabla se almacena en un archivo separado, y estos archivos están divididos en páginas de 8
                      KB. Si una tabla crece más allá de un tamaño específico (1 GB), se fragmenta en varios archivos
                      con un sufijo numérico.</p>
                  </li>
                  <li>
                    <p>Las filas se organizan dentro de páginas de 8 KB, donde cada página contiene múltiples tuplas
                      (filas). Cada fila o tupla en una tabla tiene un ctid (<em>tuple identifier</em>) que identifica
                      su ubicación física en el archivo de datos.</p>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
          <h4 id="juegos-de-caracteres">Juegos de caracteres<a class="headerlink" href="05ddl.html#juegos-de-caracteres"
              title="Permanent link">&para;</a></h4>
          <p>Entendemos como <strong>juego de caracteres</strong> (<em>character sets</em>) a la codificación que
            utiliza el SGBD para representar los datos, definiendo qué caracteres pueden almacenarse en la base de datos
            y cómo esos caracteres son codificados internamente.</p>
          <p>Tal como ya habéis estudiado en el módulo profesional de <em>Sistemas Informáticos</em>, los juegos de
            caracteres más conocidos son <code>ASCII</code> (caracteres básicos en inglés),
            <code>iso-8859-1 latin</code> (expande ASCII para incluir los caracteres acentuados y símbolos de los
            lenguajes occidentales) y <code>utf-8</code>, el cual parte de la familia de estándares <em>Unicode</em>,
            que puede representar caracteres de casi todos los lenguajes del mundo, incluidos caracteres
            <em>multibyte</em>.
          </p>
          <p>Además, podemos configurar la <strong>colación</strong> (<em>collation</em>), la cual define cómo se
            comparan y ordenan las cadenas de texto para un juego de caracteres específico (por ejemplo, la
            <code>ñ</code> después de la <code>n</code> y no conforme a la tabla de códigos ASCII), teniendo en cuenta
            cosas como el uso de mayúsculas y minúsculas o el tratamiento de acentos (por ejemplo, si <code>Á</code> es
            igual que <code>á</code>).
          </p>
          <p>En <em>MariaDB</em> y <em>PostgreSQL</em>, los juegos de caracteres y las colaciones juegan un papel
            importante en cómo se almacenan y comparan las cadenas de texto. Cada sistema maneja los juegos de
            caracteres de manera diferente, y a continuación vamos a estudiar cómo funciona en cada uno:</p>
          <div class="grid cards">
            <ul>
              <li>
                <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M23.157 4.412c-.676.284-.79.31-1.673.372-.65.045-.757.057-1.212.209-.75.246-1.395.75-2.02 1.59-.296.398-1.249 1.913-1.249 1.988 0 .057-.65.998-.915 1.32-.574.713-1.08 1.079-2.14 1.59-.77.36-1.224.524-4.102 1.477-1.073.353-2.133.738-2.367.864-.852.449-1.515 1.036-2.203 1.938-1.003 1.32-.972 1.313-3.042.947a12 12 0 0 0-.675-.063c-.644-.05-1.023.044-1.332.334L0 17.193l.177.088c.094.05.353.234.561.398.215.17.461.347.55.391.088.044.17.088.183.101s-.089.17-.228.353c-.435.581-.593.871-.574 1.048.019.164.032.17.43.17.517-.006.826-.056 1.261-.208.65-.233 2.058-.94 2.784-1.4.776-.5 1.717-.998 1.956-1.042.082-.02.354-.07.594-.114.58-.107 1.464-.095 2.587.05.108.013.373.045.6.064.227.025.43.057.454.076.026.012.474.037.998.056.934.026 1.104.007 1.3-.189.126-.133.385-.631.498-.985.209-.643.417-.921.366-.492-.113.966-.322 1.692-.713 2.411-.259.499-.663 1.092-.934 1.395-.322.347-.315.36.088.315.619-.063 1.471-.397 2.096-.82.827-.562 1.647-1.691 2.19-3.03.107-.27.22-.22.183.083-.013.094-.038.315-.057.498l-.031.328.353-.202c.833-.48 1.414-1.262 2.127-2.884.227-.518.877-2.922 1.073-3.976a10 10 0 0 1 .271-1.042c.127-.429.196-.555.48-.858.183-.19.625-.555.978-.808.72-.505.953-.75 1.187-1.205.208-.417.284-1.13.132-1.357-.132-.202-.284-.196-.763.006" />
                    </svg></span> <strong><em>MariaDB</em></strong></p>
                <p>Admite múltiples juegos de caracteres y colaciones, que pueden establecerse a nivel de base de datos,
                  tabla, columna o incluso a nivel de sesión.</p>
                <p>Así pues, ofrece una gran flexibilidad con varios juegos de caracteres (como <code>utf8</code>,
                  <code>utf8mb4</code>, <code>latin1</code>, etc.) y permite especificar colaciones para determinar cómo
                  se comparan y ordenan los textos.
                </p>
              </li>
              <li>
                <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M23.56 14.723a.5.5 0 0 0-.057-.12q-.21-.395-1.007-.231c-1.654.34-2.294.13-2.526-.02 1.342-2.048 2.445-4.522 3.041-6.83.272-1.05.798-3.523.122-4.73a1.6 1.6 0 0 0-.15-.236C21.693.91 19.8.025 17.51.001c-1.495-.016-2.77.346-3.116.479a10 10 0 0 0-.516-.082 8 8 0 0 0-1.312-.127c-1.182-.019-2.203.264-3.05.84C8.66.79 4.729-.534 2.296 1.19.935 2.153.309 3.873.43 6.304c.041.818.507 3.334 1.243 5.744q.69 2.26 1.433 3.582.83 1.493 1.714 1.79c.448.148 1.133.143 1.858-.729a56 56 0 0 1 1.945-2.206c.435.235.906.362 1.39.377v.004a11 11 0 0 0-.247.305c-.339.43-.41.52-1.5.745-.31.064-1.134.233-1.146.811a.6.6 0 0 0 .091.327c.227.423.922.61 1.015.633 1.335.333 2.505.092 3.372-.679-.017 2.231.077 4.418.345 5.088.221.553.762 1.904 2.47 1.904q.375.001.829-.094c1.782-.382 2.556-1.17 2.855-2.906.15-.87.402-2.875.539-4.101.017-.07.036-.12.057-.136 0 0 .07-.048.427.03l.044.007.254.022.015.001c.847.039 1.911-.142 2.531-.43.644-.3 1.806-1.033 1.595-1.67M2.37 11.876c-.744-2.435-1.178-4.885-1.212-5.571-.109-2.172.417-3.683 1.562-4.493 1.837-1.299 4.84-.54 6.108-.13l-.01.01C6.795 3.734 6.843 7.226 6.85 7.44c0 .082.006.199.016.36.034.586.1 1.68-.074 2.918-.16 1.15.194 2.276.973 3.089q.12.126.252.237c-.347.371-1.1 1.193-1.903 2.158-.568.682-.96.551-1.088.508-.392-.13-.813-.587-1.239-1.322-.48-.839-.963-2.032-1.415-3.512m6.007 5.088a1.6 1.6 0 0 1-.432-.178c.089-.039.237-.09.483-.14 1.284-.265 1.482-.451 1.915-1 .099-.127.211-.27.367-.443a.4.4 0 0 0 .074-.13c.17-.151.272-.11.436-.042.156.065.308.26.37.475.03.102.062.295-.045.445-.904 1.266-2.222 1.25-3.168 1.013m2.094-3.988-.052.14c-.133.357-.257.689-.334 1.004-.667-.002-1.317-.288-1.81-.803-.628-.655-.913-1.566-.783-2.5.183-1.308.116-2.447.08-3.059l-.013-.22c.296-.262 1.666-.996 2.643-.772.446.102.718.406.83.928.585 2.704.078 3.83-.33 4.736a9 9 0 0 0-.23.546m7.364 4.572q-.024.266-.062.596l-.146.438a.4.4 0 0 0-.018.108c-.006.475-.054.649-.115.87-.064.229-.135.488-.18 1.057-.11 1.414-.878 2.227-2.417 2.556-1.515.325-1.784-.496-2.02-1.221a7 7 0 0 0-.078-.227c-.215-.586-.19-1.412-.157-2.555.016-.561-.025-1.901-.33-2.646q.006-.44.019-.892a.4.4 0 0 0-.016-.113 2 2 0 0 0-.044-.208c-.122-.428-.42-.786-.78-.935-.142-.059-.403-.167-.717-.087.067-.276.183-.587.309-.925l.053-.142c.06-.16.134-.325.213-.5.426-.948 1.01-2.246.376-5.178-.237-1.098-1.03-1.634-2.232-1.51-.72.075-1.38.366-1.709.532a6 6 0 0 0-.196.104c.092-1.106.439-3.174 1.736-4.482a4 4 0 0 1 .303-.276.35.35 0 0 0 .145-.064c.752-.57 1.695-.85 2.802-.833q.616.01 1.174.081c1.94.355 3.244 1.447 4.036 2.383.814.962 1.255 1.931 1.431 2.454-1.323-.134-2.223.127-2.68.78-.992 1.418.544 4.172 1.282 5.496.135.242.252.452.289.54.24.583.551.972.778 1.256.07.087.138.171.189.245-.4.116-1.12.383-1.055 1.717-.013.156-.043.447-.084.815-.046.208-.07.46-.1.766m.89-1.621c-.04-.832.27-.919.597-1.01l.135-.041a1 1 0 0 0 .134.103c.57.376 1.583.421 3.007.134-.202.177-.519.4-.953.601-.41.19-1.096.333-1.747.364-.72.034-1.086-.08-1.173-.151m.57-9.271c-.006.35-.054.669-.105 1.001-.055.358-.112.728-.127 1.177-.014.436.04.89.093 1.33.107.887.216 1.8-.207 2.701a4 4 0 0 1-.188-.385 8 8 0 0 0-.325-.617c-.616-1.104-2.057-3.69-1.32-4.744.38-.543 1.342-.566 2.179-.463m.228 7.013-.085-.107-.035-.044c.726-1.2.584-2.387.457-3.439-.052-.432-.1-.84-.088-1.222.013-.407.066-.755.118-1.092.064-.415.13-.844.111-1.35a.6.6 0 0 0 .012-.19c-.046-.486-.6-1.938-1.73-3.253a7.8 7.8 0 0 0-2.688-2.04A9.3 9.3 0 0 1 17.62.746c2.052.046 3.675.814 4.824 2.283a1 1 0 0 1 .067.1c.723 1.356-.276 6.275-2.987 10.54m-8.816-6.116c-.025.18-.31.423-.621.423a1 1 0 0 1-.081-.006.8.8 0 0 1-.506-.315c-.046-.06-.12-.178-.106-.285a.22.22 0 0 1 .093-.149c.118-.089.352-.122.61-.086.316.044.642.193.61.418m7.93-.411c.011.08-.049.2-.153.31a.72.72 0 0 1-.408.223 1 1 0 0 1-.075.005c-.293 0-.541-.234-.56-.371-.024-.177.264-.31.56-.352.298-.042.612.009.636.185" />
                    </svg></span> <strong><em>PostgreSQL</em></strong></p>
                <p>Está optimizado principalmente para el uso de <code>utf8</code>, con menos enfoque en otros juegos de
                  caracteres.</p>
                <p>Las colaciones son más dependientes de las configuraciones del sistema operativo y se aplican al
                  nivel de la base de datos o columna, pero la mayoría de los sistemas de producción usan
                  <code>utf8</code> por su versatilidad.
                </p>
              </li>
            </ul>
          </div>
          <p>Del mismo modo, la configuración del juego de caracteres y la colación dependen del SGBD empleado, y se
            indican a la hora de crear la base de datos:</p>
          <div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1"
              name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" />
            <div class="tabbed-labels"><label for="__tabbed_5_1">MariaDB</label><label
                for="__tabbed_5_2">PostgreSQL</label></div>
            <div class="tabbed-content">
              <div class="tabbed-block">
                <p>La codificación y la colación se especifican al crear una base de datos mediante <a
                    href="https://mariadb.com/kb/en/create-database/"><code>CREATE DATABASE</code></a> con las opciones
                  <code>CHARACTER SET</code> y <code>COLLATE</code>.
                </p>
                <p>Además de <code>utf8</code>, <code>latin1</code>y <code>ascii</code> ya comentados previamente, una
                  codificación muy empleado es <strong><code>utf8mb4</code></strong>, la cual es una extensión de
                  <code>utf8</code> que permite almacenar todos los caracteres de <em>Unicode</em>, incluidos emojis y
                  otros símbolos que no se pueden representar en <code>utf8</code>.
                </p>
                <p>Además, luego para cada juego de caracteres, tenemos sus colaciones. Por ejemplo, el juego de
                  caracteres <code>utf8</code> tiene varias colaciones como:</p>
                <ul>
                  <li><code>utf8_general_ci</code>: Colación insensible a mayúsculas/minúsculas
                    (<em>case-insensitive</em>).</li>
                  <li><code>utf8_bin</code>: Colación binaria, sensible a mayúsculas/minúsculas y que compara los
                    caracteres basándose en sus valores binarios.</li>
                </ul>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">mi_base_de_datos</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">CHARACTER</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">utf8mb4</span>
<span class="linenos" data-linenos="3 "></span><span class="k">COLLATE</span><span class="w"> </span><span class="n">utf8mb4_unicode_ci</span><span class="p">;</span>
</code></pre>
                </div>
              </div>
              <div class="tabbed-block">
                <p>La codificación y la colación se especifican al crear una base de datos mediante <a
                    href="https://www.postgresql.org/docs/current/sql-createdatabase.html"><code>CREATE DATABASE</code></a>
                  con las opciones <code>ENCODING</code> y <code>LC_COLLATE</code>.</p>
                <p>Las colaciones más comunes son:</p>
                <ul>
                  <li><code>en_US.UTF-8</code>: Colación en inglés, sensible a mayúsculas/minúsculas.</li>
                  <li><code>es_ES.UTF-8</code>: Colación en español.</li>
                </ul>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="n">mi_base_de_datos</span>
<span class="linenos" data-linenos="2 "></span><span class="k">WITH</span><span class="w"> </span><span class="k">ENCODING</span><span class="w"> </span><span class="s1">&#39;UTF8&#39;</span>
<span class="linenos" data-linenos="3 "></span><span class="n">LC_COLLATE</span><span class="w"> </span><span class="s1">&#39;es_ES.UTF-8&#39;</span>
<span class="linenos" data-linenos="4 "></span><span class="n">LC_CTYPE</span><span class="w"> </span><span class="s1">&#39;es_ES.UTF-8&#39;</span><span class="p">;</span>
</code></pre>
                </div>
              </div>
            </div>
          </div>
          <h3 id="tipos-de-datos">Tipos de datos<a class="headerlink" href="05ddl.html#tipos-de-datos"
              title="Permanent link">&para;</a></h3>
          <p>Antes de entrar a ver cómo podemos crear las tablas, necesitamos conocer los tipos de datos que van a poder
            tener las columnas que definamos. De forma general, los tipos de datos se agrupan en las siguientes
            categorías:</p>
          <ul>
            <li>Numéricos, como <code>INT</code> o <code>DOUBLE</code></li>
            <li>Cadena, como <code>CHAR</code>, <code>VARCHAR</code> o <code>TEXT</code></li>
            <li>Fecha/Hora, como <code>DATE</code> o <code>TIMESTAMP</code></li>
            <li>Binarios, como <code>BINARY</code></li>
            <li>Otros, como <code>XML</code></li>
          </ul>
          <p>Dicho esto, los tipos más empleados en <a href="https://mariadb.com/kb/en/data-types/">MariaDB</a> y <a
              href="https://www.postgresql.org/docs/current/datatype.html#DATATYPE-TABLE">PostgreSQL</a> son:</p>
          <table>
            <thead>
              <tr>
                <th>Tipo de dato</th>
                <th><em>MariaDB</em></th>
                <th><em>PostgreSQL</em></th>
                <th>Descripción</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Numéricos</strong></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td><code>TINYINT</code></td>
                <td>Sí</td>
                <td>No</td>
                <td>Entero pequeño, de 1 byte (<em>MariaDB</em>)</td>
              </tr>
              <tr>
                <td><code>SMALLINT</code></td>
                <td>Sí</td>
                <td>Sí, alias <code>int2</code></td>
                <td>Entero pequeño, de 2 bytes</td>
              </tr>
              <tr>
                <td><code>MEDIUMINT</code></td>
                <td>Sí</td>
                <td>No</td>
                <td>Entero de 3 bytes (<em>MariaDB</em>)</td>
              </tr>
              <tr>
                <td><code>INT</code>, <code>INTEGER</code></td>
                <td>Sí</td>
                <td>Sí, alias <code>int4</code></td>
                <td>Entero estándar de 4 bytes</td>
              </tr>
              <tr>
                <td><code>BIGINT</code></td>
                <td>Sí</td>
                <td>Sí, alias <code>int8</code></td>
                <td>Entero grande de 8 bytes</td>
              </tr>
              <tr>
                <td><code>DECIMAL</code>, <code>NUMERIC</code></td>
                <td>Sí</td>
                <td>Sí</td>
                <td>Número con precisión fija (exacta)</td>
              </tr>
              <tr>
                <td><code>FLOAT</code></td>
                <td>Sí</td>
                <td>Sí</td>
                <td>Número de coma flotante de precisión simple</td>
              </tr>
              <tr>
                <td><code>DOUBLE</code></td>
                <td>Sí</td>
                <td>Sí, alias <code>float8</code></td>
                <td>Número de coma flotante de precisión doble</td>
              </tr>
              <tr>
                <td><code>SERIAL</code></td>
                <td>No</td>
                <td>Sí, alias <code>serial4</code></td>
                <td>Entero autoincremental (<em>PostgreSQL</em>) <sup id="fnref:1"><a class="footnote-ref"
                      href="05ddl.html#fn:1">1</a></sup></td>
              </tr>
              <tr>
                <td><strong>Cadenas</strong></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td><code>CHAR(n)</code></td>
                <td>Sí</td>
                <td>Sí</td>
                <td>Cadena de longitud fija</td>
              </tr>
              <tr>
                <td><code>VARCHAR(n)</code></td>
                <td>Sí</td>
                <td>Sí</td>
                <td>Cadena de longitud variable</td>
              </tr>
              <tr>
                <td><code>TEXT</code></td>
                <td>Sí</td>
                <td>Sí</td>
                <td>Cadena de longitud ilimitada</td>
              </tr>
              <tr>
                <td><strong>Fechas y horas</strong></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td><code>DATE</code></td>
                <td>Sí</td>
                <td>Sí</td>
                <td>Fecha (año, mes, día)</td>
              </tr>
              <tr>
                <td><code>TIME</code></td>
                <td>Sí</td>
                <td>Sí</td>
                <td>Hora (sin zona horaria)</td>
              </tr>
              <tr>
                <td><code>DATETIME</code></td>
                <td>Sí</td>
                <td>No</td>
                <td>Fecha y hora (<em>MariaDB</em>)</td>
              </tr>
              <tr>
                <td><code>TIMESTAMP</code></td>
                <td>Sí</td>
                <td>Sí</td>
                <td>Marca de tiempo (con o sin zona horaria)</td>
              </tr>
              <tr>
                <td><strong>Booleanos</strong></td>
                <td></td>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td><code>BOOLEAN</code></td>
                <td>Sí (alias de <code>TINYINT</code>)</td>
                <td>Sí, alias <code>bool</code></td>
                <td>Tipo booleano (en <em>MariaDB</em> es alias de <code>TINYINT</code>)</td>
              </tr>
            </tbody>
          </table>
          <p>Algunos ejemplos de tipos serían:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="nb">BIGINT</span>
<span class="linenos" data-linenos="2 "></span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="linenos" data-linenos="3 "></span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span>
<span class="linenos" data-linenos="4 "></span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="c1">-- 5 dígitos en total, con 2 decimales, por ejemplo 123,45</span>
</code></pre>
          </div>
          <div class="admonition question">
            <p class="admonition-title">¿El tamaño importa?</p>
            <p>Si el almacenamiento y la memoria son cada vez más baratos, ¿Por qué hemos de preocuparnos que un campo
              ocupe 2 o 4 bytes? Cuando la base de datos es pequeña, el resultado es despreciable. Pero conforme crece,
              los costes computacionales y los requisitos de memoria también lo hacen.</p>
            <p>Por ello, cuanto menos ocupen los datos, menor será el tiempo necesario para realizar las consultas (ya
              que los datos se cargan antes en memoria), la transmisión de datos será más eficiente, así como su
              almacenamiento.</p>
          </div>
          <h4 id="cadenas">Cadenas<a class="headerlink" href="05ddl.html#cadenas" title="Permanent link">&para;</a></h4>
          <p>Para almacenar <a
              href="https://mariadb.com/docs/server/reference/data-types/string-data-types">cadenas</a>, hemos visto que
            podemos emplear, principalmente, <a
              href="https://mariadb.com/docs/server/reference/data-types/string-data-types/char"><code>CHAR</code></a>,
            <a
              href="https://mariadb.com/docs/server/reference/data-types/string-data-types/varchar"><code>VARCHAR</code></a>
            o <a
              href="https://mariadb.com/docs/server/reference/data-types/string-data-types/text"><code>TEXT</code></a>.
          </p>
          <p>Algunas recomendaciones para elegir uno u otro tipo son:</p>
          <ul>
            <li>Cuando un campo tenga una longitud uniforme, utiliza <code>CHAR</code>. Por ejemplo, para un código
              postal emplearemos <code>CHAR(5)</code> mientras que para una matrícula <code>CHAR(7)</code> (cuatro
              dígitos más tres letras). </li>
            <li>Cuando un campo tenga una longitud variable pero relativamente corta, utiliza <code>VARCHAR</code>. Por
              ejemplo, para almacenar el nombre de un cliente, podemos emplear <code>VARCHAR(32)</code> o para el nombre
              de una asignatura <code>VARCHAR(64)</code>. ¿En qué punto dejamos de considerar que una cadena es
              <em>relativamente corta</em>? Cuando no puedas estimar su tamaño, quizás a partir de 500 caracteres, o
              como mucho 2KB.
            </li>
            <li>Cuando el campo contenga una gran cantidad de datos textuales, que normalmente exceden el millar de
              caracteres, debes decantarte por <code>TEXT</code>. Por ejemplo, el manual de un producto o el texto de un
              libro.</li>
          </ul>
          <p>Hay casos en los que la línea que separa un <code>VARCHAR</code> de un <code>TEXT</code> no está clara.
            Aunque los estudiaremos más adelante, debes saber que si, necesitas comparar, ordenar o agrupar por ese
            campo en una consulta, es preferible usar <code>VARCHAR</code>.</p>
          <p>En <em>MariaDB</em>, además de los tipos, tenemos modificadores sobre ellos que fijan lo longitud máxima de
            cada tipo de dato. Así pues, un <code>CHAR</code> puede llegar hasta los 255 caracteres, mientras que tanto
            un <code>VARCHAR</code> como <code>TEXT</code> pueden alcanzar hasta 65.532 caracteres; <a
              href="https://mariadb.com/docs/server/reference/data-types/string-data-types/mediumtext"><code>MEDIUMTEXT</code></a>
            hasta 16.777.215 y finalmente <a
              href="https://mariadb.com/docs/server/reference/data-types/string-data-types/longtext"><code>LONGTEXT</code></a>
            a 4.294.967.295 caracteres (4GB). </p>
          <h4 id="numericos">Numéricos<a class="headerlink" href="05ddl.html#numericos"
              title="Permanent link">&para;</a></h4>
          <p>Para almacenar valores <a
              href="https://mariadb.com/docs/server/reference/data-types/numeric-data-types">numéricos</a>, hemos visto
            que podemos emplear <a
              href="https://mariadb.com/docs/server/reference/data-types/numeric-data-types/tinyint"><code>TINYINT</code></a>,
            <a
              href="https://mariadb.com/docs/server/reference/data-types/numeric-data-types/smallint"><code>SMALLINT</code></a>,
            <a href="https://mariadb.com/docs/server/reference/data-types/numeric-data-types/int"><code>INT</code></a> y
            <a
              href="https://mariadb.com/docs/server/reference/data-types/numeric-data-types/bigint"><code>BIGINT</code></a>
            para números enteros y <code>FLOAT</code>, <code>DOUBLE</code> y <code>DECIMAL</code> cuando tenemos
            decimales.
          </p>
          <p>Respecto a los <strong>números enteros</strong>, cada tipo tiene su propio rango y, por tanto, puede
            almacenar números más grandes (a costa de ocupar más memoria). Estos tipos tienen valores mínimos y máximos,
            dependiendo de si se configuran con o sin signo (<code>SIGNED</code> o <code>UNSIGNED</code>). Los números
            sin signo, en la gran mayoría de SGBD, no pueden ser negativos.</p>
          <table>
            <thead>
              <tr>
                <th>Tipo</th>
                <th>Tamaño (bytes)</th>
                <th>Rango <code>SIGNED</code></th>
                <th>Rango <code>UNSIGNED</code></th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>TINYINT</code></td>
                <td>1</td>
                <td>de -128 a 127</td>
                <td>de 0 a 255</td>
              </tr>
              <tr>
                <td><code>SMALLINT</code></td>
                <td>2</td>
                <td>de -32,768 a 32,767</td>
                <td>de 0 a 65,535</td>
              </tr>
              <tr>
                <td><code>INT</code></td>
                <td>4</td>
                <td>de -2,147,483,648 a 2,147,483,647 (algo más de 2 billones)</td>
                <td>de 0 a 4,294,967,295 (4 billones)</td>
              </tr>
              <tr>
                <td><code>BIGINT</code></td>
                <td>8</td>
                <td>de -9,223,372,036,854,775,808 a 9,223,372,036,854,775,807 (más de 9 quintillones)</td>
                <td>de 0 a 18,446,744,073,709,551,615 (18 quintillones)</td>
              </tr>
            </tbody>
          </table>
          <p>Respecto a los números con decimales, hemos de diferenciar entre los de coma flotante y los de coma fija.
            Los ejemplos típicos de <strong>coma flotante</strong> son <a
              href="https://mariadb.com/docs/server/reference/data-types/numeric-data-types/float"><code>FLOAT</code></a>
            con 32 bits y <a
              href="https://mariadb.com/docs/server/reference/data-types/numeric-data-types/double"><code>DOUBLE</code></a>
            con una precisión de 64 bits, los cuales no tienen una precisión uniforme y puede producir errores de
            redondeo. Estos tipos se utilizan cuando la precisión no es estrictamente necesaria, como en la lectura de
            sensores, el análisis estadístico y la simulación física.</p>
          <p>Cuando se requiere precisión, hasta el punto de tener que preocuparse por cada valor decimal, debemos
            evitar los tipos de coma flotante y utilizar números de <strong>coma fija</strong>, donde el punto decimal
            está en una posición predeterminada y fija, ocupando siempre el mismo espacio y teniendo siempre la misma
            precisión. Para ello, utilizaremos el tipo <a
              href="https://mariadb.com/docs/server/reference/data-types/numeric-data-types/decimal"><code>DECIMAL(p,s)</code></a>
            (o su sinónimo <code>NUMERIC</code>). donde <code>p</code> indica la precisión, esto es, el número total de
            dígitos y <code>s</code> la escala, es decir, la cantidad de decimales. Así pues, <code>DECIMAL(5,2)</code>
            tendrá un máximo de 3 dígitos en su parte entera y tendrá dos en la decimal, permitiendo valores desde
            <code>-999.99</code> hasta <code>999.99</code>.
          </p>
          <p>¿Pero realmente cambia el comportamiento entre un tipo y otro? Por ejemplo, si multiplicamos
            <code>0.1</code> por <code>0.3</code> y luego le restamos <code>0.3</code>, deberíamos obtener
            <code>0.0</code>, ¿verdad?
          </p>
          <p>Vamos a comprobarlo directamente sobre <em>MariaDB</em>:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">precision_test</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">valor_float</span><span class="w"> </span><span class="nb">FLOAT</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">valor_decimal</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos" data-linenos=" 4 "></span><span class="p">);</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">precision_test</span><span class="w"> </span><span class="p">(</span><span class="n">valor_float</span><span class="p">,</span><span class="w"> </span><span class="n">valor_decimal</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="k">SELECT</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">(</span><span class="n">valor_float</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">error_float</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">(</span><span class="n">valor_decimal</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">3</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">error_decimal</span>
<span class="linenos" data-linenos="11 "></span><span class="k">FROM</span><span class="w"> </span><span class="n">precision_test</span><span class="p">;</span>
<span class="linenos" data-linenos="12 "></span><span class="c1">-- +----------------------------+---------------+</span>
<span class="linenos" data-linenos="13 "></span><span class="c1">-- | error_float                | error_decimal |</span>
<span class="linenos" data-linenos="14 "></span><span class="c1">-- +----------------------------+---------------+</span>
<span class="linenos" data-linenos="15 "></span><span class="c1">-- | 0.000000004470348369256527 |           0.0 |</span>
<span class="linenos" data-linenos="16 "></span><span class="c1">-- +----------------------------+---------------+</span>
</code></pre>
          </div>
          <p>Si entrar en detalle en la sintaxis SQL para la creación de la tabla, la inserción de datos o la consulta,
            podemos observar como al utilizar un campo de tipo coma flotante el resultado no es el esperado.</p>
          <p>En resumen, se recomienda utilizar:</p>
          <ul>
            <li><code>FLOAT</code> o <code>DOUBLE</code> cuando la velocidad y el rango sean más importantes que la
              precisión (por ejemplo, en datos científicos).</li>
            <li><code>DECIMAL</code> o <code>NUMERIC</code> cuando la precisión sea crítica, como en aplicaciones
              contables, financieras o bancarias.<br />
              Por ejemplo, para almacenar dinero, se suele emplear <code>DECIMAL(10,2)</code></li>
          </ul>
          <h4 id="temporales">Temporales<a class="headerlink" href="05ddl.html#temporales"
              title="Permanent link">&para;</a></h4>
          <p>Los tipos de datos temporales permiten almacenar fecha, horas o marcas temporales (<em>timestamps</em>),
            mediante los tipos <code>DATE</code>, <code>TIME</code> y <code>TIMESTAMP</code> respectivamente.</p>
          <div class="admonition info inline end">
            <p class="admonition-title">UTC</p>
            <p><a href="https://es.wikipedia.org/wiki/Tiempo_universal_coordinado">Tiempo Universal Coordinado (UTC)</a>
              es como un gran reloj que todo el mundo está de acuerdo en seguir. Es la misma hora para todos, estén
              donde estén.<br />
              Si vives en España y tus amigos de Chile quieren informarte de su hora local sin darte explícitamente la
              hora exacta, pueden decirte "Nuestra hora local, en invierno, es UTC menos 4 horas". Sabiendo que en
              España en invierno estamos en <code>UTC+1</code> (Canarias es <code>UTC+0</code>), sabemos que la
              diferencia es de 5 horas.</p>
          </div>
          <p>Cada SGBD tiene sus particularidades, pero a modo general, usaremos:</p>
          <ul>
            <li><code>DATE</code> cuando necesitamos una fecha concreta, como una fecha de nacimiento o la fecha de un
              contrato. Por ejemplo, <code>2025-07-16</code> representa el 16 de julio de 2025.</li>
            <li><code>TIME</code> para almacenar eventos que ocurren durante un día, como la hora de entrada a la
              empresa. Por ejemplo, <code>14:30:00</code> representa las dos y media de la tarde.</li>
            <li><code>DATETIME</code> para almacenar tanto la fecha como la hora, por ejemplo, un evento de una reunión
              la próxima semana podríamos expresarla mediante <code>2025-07-22 12:15:00</code>. No almacena la zona
              horaria ni convierte a UTC.</li>
            <li><code>TIMESTAMP</code> para registrar el momento exacto de un evento que debe ser coherente en todas las
              zonas horarias, como las marcas de tiempo de registro, la creación de registros y las horas de
              modificación. Normalmente, el SGBD gestiona automáticamente la conversión de zonas horarias en los datos
              <code>TIMESTAMP</code>.
            </li>
          </ul>
          <p>Es importante tener en cuenta que, si está diseñando una base de datos para una aplicación cuyos usuarios
            son estrictamente locales, como un sistema de pedidos para un restaurante, no necesitaremos preocuparnos por
            los problemas de zona horaria. Pero si estamos creando una aplicación que podría utilizarse en todo el
            mundo, sí deberíamos almacenar los datos de la zona horaria como parte de los atributos de datos temporales.
            Independientemente de las especificaciones del SGBD empleado, es recomendable almacenar los valores de fecha
            y hora en UTC, porque garantiza la coherencia y evita problemas con los cambios de horario de verano, las
            diferentes zonas horarias y los usuarios que viajan.</p>
          <!-- Continuar revisión con ChatGPT -->

          <h4 id="enumeraciones">Enumeraciones<a class="headerlink" href="05ddl.html#enumeraciones"
              title="Permanent link">&para;</a></h4>
          <p>Además de los tipos vistos, podemos crear enumeraciones como un conjunto de valores restringidos que puede
            tomar un determinado campo, definiendo una lista de valores posibles.</p>
          <p>Para ello haremos uso de la <em>keyword</em> <code>ENUM</code> tanto en <a
              href="https://mariadb.com/kb/en/enum/">MariaDB</a> como en <a
              href="https://www.postgresql.org/docs/16/datatype-enum.html">PostgreSQL</a>:</p>
          <div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1"
              name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" />
            <div class="tabbed-labels"><label for="__tabbed_6_1">MariaDB</label><label
                for="__tabbed_6_2">PostgreSQL</label></div>
            <div class="tabbed-content">
              <div class="tabbed-block">
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">curso</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="2 "></span><span class="n">horario</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;mañana&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;tarde&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;noche&#39;</span><span class="p">)</span>
<span class="linenos" data-linenos="3 "></span><span class="n">estado</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;pendiente&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;en_proceso&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;finalizado&#39;</span><span class="p">)</span>
</code></pre>
                </div>
              </div>
              <div class="tabbed-block">
                <p>Primero debemos definir un tipo y luego asociar ese tipo al campo:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="n">animo</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;feliz&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;triste&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;normal&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="n">estado</span><span class="w"> </span><span class="n">animo</span><span class="p">;</span>
</code></pre>
                </div>
              </div>
            </div>
          </div>
          <p>Internamente, el valor se almacena como un entero (1 byte si hay ≤255 valores, 2 bytes si hay más) y al
            definir los valores posibles, éstos están limitados y controlados.</p>
          <p>Usaremos enumeraciones cuando el conjunto de valores sea fijo y pequeño, y no cambie con frecuencia.
            Además, obtendremos validación automática por parte del motor de la base de datos, mediante una
            almacenamiento eficiente sin perder legibilidad.</p>
          <p>Por el contrario, cuando el conjunto de valores es inestable y puede cambiar con el tiempo, no se
            recomienda utilizar una enumeración. Tampoco es adecuada si necesitamos traducir los valores o asociarles
            información adicional (como colores, iconos, etc.), en cuyo caso es preferible emplear una tabla de
            referencia junto con una clave foránea.</p>
          <hr />
          <div class="admonition question">
            <p class="admonition-title">Autoevaluación</p>
            <p>Piensa en el tipo de dato que asignarías a cada uno de los siguientes campos:</p>
            <p>
            <ol
              style="display: grid; grid-template-columns: repeat(3, 1fr); padding-left: 1em; column-gap:1.5em; row-gap: 0.3em;">
              <li>DNI de un usuario</li>
              <li>Nombre completo de un cliente</li>
              <li>Correo electrónico del cliente</li>
              <li>Hora de entrada del turno</li>
              <li>Precio de un producto</li>
              <li>Cantidad de empleados de una empresa</li>
              <li>ISBN de un libro</li>
              <li>Talla de una camiseta</li>
              <li>Prólogo de un libro</li>
              <li>Momento que entró por última vez a la aplicación</li>
              <li>Peso del producto (en kg)</li>
              <li>Fecha de nacimiento de un cliente</li>
              <li>Código de país (ES, FR, DE, etc.)</li>
              <li>Estado de un pedido</li>
              <li>Identificador de un cliente</li>
              <li>Número de la tarjeta de crédito</li>
              <li>Sexo de una persona</li>
              <li>¿Está casado/a?</li>
              <li>Contraseña de un usuario</li>
              <li>Categoría de un producto</li>
              <li>Altura de una persona</li>
              <li>Color de una camiseta</li>
              <li>Número de teléfono de un cliente</li>
              <li>Instante de la compra de un producto</li>
            </ol>
            </p>
          </div>
          <h4 id="creando-tipos-y-dominios">Creando tipos y dominios<a class="headerlink"
              href="05ddl.html#creando-tipos-y-dominios" title="Permanent link">&para;</a></h4>
          <p>Además de todos los tipos de datos vistos (y algunos más que se salen del alcance del curso), en algunos
            SGBD (por ejemplo, <em>PostgreSQL</em> sí que lo permite, pero <em>MariaDB</em> no), podemos crear nuestros
            propios tipos de datos o dominios.</p>
          <p>Mediante <code>CREATE TYPE</code> podemos definir tipos de datos complejos, como tipos de registros, arrays
            o tipos compuestos de varios atributos. Por ejemplo, podemos crear un tipo de dato para almacenar
            coordenadas:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="n">coordenada</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">  </span><span class="n">x</span><span class="w"> </span><span class="nb">FLOAT</span><span class="p">,</span>
<span class="linenos" data-linenos="3 "></span><span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="nb">FLOAT</span>
<span class="linenos" data-linenos="4 "></span><span class="p">);</span>
</code></pre>
          </div>
          <p>Por otro lado, mediante <code>CREATE DOMAIN</code> podemos definir un tipo de dato basado en un tipo
            existente, pero con restricciones adicionales (como validaciones, reglas de longitud, formatos, etc.). Por
            ejemplo, podemos crear un dominio para almacenar números naturales (enteros positivos):</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DOMAIN</span><span class="w"> </span><span class="n">nnatural</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">VALUE</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</code></pre>
          </div>
          <h3 id="tablas">Tablas<a class="headerlink" href="05ddl.html#tablas" title="Permanent link">&para;</a></h3>
          <p>Dentro de la definición de datos, la creación de tablas es la parte más importante ya que nos permite
            trasladar nuestro modelo relacional al modelo físico.</p>
          <p>Para crear una tabla emplearemos la sentencia <code>CREATE TABLE</code>. La sintaxis básica compartida por
            todos los SGBD es la siguiente:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="p">[</span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="p">]</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">basededatos</span><span class="p">.]</span><span class="n">nombreDeTabla</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">columna1</span><span class="w"> </span><span class="n">tipoDato1</span><span class="w"> </span><span class="p">[</span><span class="n">propiedadesColumna</span><span class="p">],</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="p">...</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">columnaN</span><span class="w"> </span><span class="n">tipoDatoN</span><span class="w"> </span><span class="p">[</span><span class="n">propiedadesColumna</span><span class="p">],</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="p">[</span><span class="n">restriccionesTabla</span><span class="p">]</span>
<span class="linenos" data-linenos="6 "></span><span class="p">);</span>
</code></pre>
          </div>
          <p>Conviene revisar la sintaxis de <a href="https://mariadb.com/kb/en/create-table/">MariaDB</a> y <a
              href="https://www.postgresql.org/docs/current/sql-createtable.html">PostgreSQL</a> para comprobar los
            detalles de cada SGBD.</p>
          <p>Por ejemplo, para crear una tabla con un único atributo podríamos hacer:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">USUARIO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="linenos" data-linenos="3 "></span><span class="p">);</span>
</code></pre>
          </div>
          <p>Algunas restricciones que hemos de tener en cuenta son:</p>
          <ul>
            <li>No puede haber nombres de tablas repetidas.</li>
            <li>El nombre de la tabla debe comenzar por un carácter alfabético y su longitud máxima es de 30 caracteres.
              Sólo se permiten letras del alfabeto inglés, dígitos o el signo de guión bajo.</li>
            <li>No podemos crear tablas cuyo nombre coincida con las palabras reservadas de SQL (por ejemplo, no podemos
              llamar a una tabla <code>WHERE</code>).</li>
            <li>Como convención, vamos a nombrar las TABLAS en MAYÚSCULAS y las columnas en minúsculas.</li>
            <li>En principio, respecto a los nombre de las tablas y las columnas, los SGBD no son <em>case
                sensitive</em> (no distinguen entre mayúsculas y minúsculas), aunque puede depender de la configuración
              del sistema operativo (sobre todo en sistemas Linux/Unix) o el uso de comillas dobles (no recomendado). En
              cambio, en los datos, depende de la configuración de la colación. </li>
          </ul>
          <p>A continuación, tenemos algunos ejemplos de creaciones de tablas con diferentes tipos de datos:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PROVEEDOR</span><span class="p">(</span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">));</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CLIENTE</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="n">localidad</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;Elche&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PRESTAMO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="n">idPrestamo</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">UNSIGNED</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="n">fechaPrestamo</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="p">,</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="n">instantePrestamo</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CIUDAD</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="n">poblacion</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="n">codigoPostal</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;03203&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="16 "></span>
<span class="linenos" data-linenos="17 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PROVINCIA</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="n">poblacion</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">5000</span><span class="p">);</span>
</code></pre>
          </div>
          <p>Con estos ejemplos, hemos visto que algunas de las propiedades de columna que podemos indicar son los
            valores no nulos (mediante <code>NOT NULL</code>) o valores por defecto (mediante <code>DEFAULT</code>). En
            el apartado <a href="05ddl.html#restricciones">Restricciones</a> las estudiaremos en profundidad.</p>
          <p>En todo momento, podemos obtener la estructura de una tabla mediante el comando <a
              href="https://mariadb.com/kb/en/describe"><code>DESCRIBE nombreTabla</code></a> en <em>MariaDB</em> como
            mediante <a
              href="https://www.postgresql.org/docs/current/app-psql.html#APP-PSQL-META-COMMANDS"><code>\d nombreTabla</code></a>
            en <em>PostgreSQL</em>:</p>
          <div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1"
              name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" />
            <div class="tabbed-labels"><label for="__tabbed_7_1">MariaDB</label><label
                for="__tabbed_7_2">PostgreSQL</label></div>
            <div class="tabbed-content">
              <div class="tabbed-block">
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DESCRIBE</span><span class="w"> </span><span class="n">CIUDAD</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">-- +--------------+--------------+------+-----+---------+-------+</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">-- | Field        | Type         | Null | Key | Default | Extra |</span>
<span class="linenos" data-linenos="4 "></span><span class="c1">-- +--------------+--------------+------+-----+---------+-------+</span>
<span class="linenos" data-linenos="5 "></span><span class="c1">-- | nombre       | varchar(20)  | NO   |     | NULL    |       |</span>
<span class="linenos" data-linenos="6 "></span><span class="c1">-- | poblacion    | int(11)      | YES  |     | NULL    |       |</span>
<span class="linenos" data-linenos="7 "></span><span class="c1">-- | codigoPostal | char(5)      | NO   |     | 03203   |       |</span>
<span class="linenos" data-linenos="8 "></span><span class="c1">-- +--------------+--------------+------+-----+---------+-------+</span>
<span class="linenos" data-linenos="9 "></span><span class="c1">-- 3 rows in set (0.000 sec)</span>
</code></pre>
                </div>
              </div>
              <div class="tabbed-block">
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="err">\</span><span class="n">d</span><span class="w"> </span><span class="n">CIUDAD</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">--                            Table &quot;mi_esquema.ciudad&quot;</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">--     Column    |         Type          | Collation | Nullable |     Default     </span>
<span class="linenos" data-linenos="4 "></span><span class="c1">-- --------------+-----------------------+-----------+----------+-----------------</span>
<span class="linenos" data-linenos="5 "></span><span class="c1">--  nombre       | character varying(20) |           | not null | </span>
<span class="linenos" data-linenos="6 "></span><span class="c1">--  poblacion    | integer               |           |          | </span>
<span class="linenos" data-linenos="7 "></span><span class="c1">--  codigopostal | character(5)          |           | not null | &#39;03203&#39;::bpchar</span>
</code></pre>
                </div>
              </div>
            </div>
          </div>
          <h4 id="a-partir-de-consultas">A partir de consultas<a class="headerlink"
              href="05ddl.html#a-partir-de-consultas" title="Permanent link">&para;</a></h4>
          <p>Un caso particular de la creación de tablas es hacerlo a partir del resultado de una consulta, de manera
            que contiene la estructura (tipos de datos) y los datos obtenidos del resultado obtenido. Para ello, en vez
            de indicar los campos y restricciones, realizamos la consulta mediante <a
              href="https://mariadb.com/docs/server/reference/sql-statements/data-definition/create/create-table#create-table-select"><code>CREATE TABLE ... AS SELECT</code></a>:
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nombreTabla</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="err">…</span>
</code></pre>
          </div>
          <p>Por ejemplo, para crear una tabla <code>GERENTE</code> con los datos de empleados catalogados como
            <code>Gerente</code>, haríamos:
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">GERENTE</span><span class="w"> </span><span class="k">AS</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">apellido1</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">apellido2</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">email</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="n">e</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">puesto</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">&quot;%Gerente%&quot;</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Volveremos a esta posibilidad cuando aprendamos a realizar <a href="08sql-subquerys.html#ddl">consultas
              mediante SQL y DDL</a> en la Unidad 8.</p>
          <h4 id="clave-primaria">Clave primaria<a class="headerlink" href="05ddl.html#clave-primaria"
              title="Permanent link">&para;</a></h4>
          <p>Una vez visto cómo crear las tablas y sus atributos, nos centramos en la creación de la clave primaria.
            Toda tabla debe tener una clave primaria (ya sea simple o compuesta). Para ello, si tenemos un atributo
            simple, podemos añadir la propiedad <code>PRIMARY KEY</code> al atributo, aunque por convenciones de código,
            es mejor definir la clave primaria después de todos los atributos, a modo de restricción: </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CIUDAD</span><span class="w"> </span><span class="p">(</span>
<span class="hll"><span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span><span class="w"> </span><span class="c1">-- clave primaria como propiedad</span>
</span><span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">poblacion</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">5000</span><span class="p">);</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PROVINCIA</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="n">poblacion</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span>
<span class="hll"><span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">nombre</span><span class="p">));</span><span class="w"> </span><span class="c1">-- clave primaria como restricción</span>
</span><span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">COMUNIDAD</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="n">poblacion</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">5000</span><span class="p">,</span>
<span class="hll"><span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_COMUNIDAD</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">nombre</span><span class="p">));</span><span class="w"> </span><span class="c1">-- clave primaria como restricción con nombre</span>
</span><span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="n">codigo</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="n">UNSIGNED</span><span class="p">,</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="n">departamento</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span>
<span class="linenos" data-linenos="18 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="hll"><span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">codigo</span><span class="p">,</span><span class="w"> </span><span class="n">departamento</span><span class="p">));</span><span class="w"> </span><span class="c1">-- clave primaria compuesta</span>
</span></code></pre>
          </div>
          <h5 id="clave-subrogada">Clave subrogada<a class="headerlink" href="05ddl.html#clave-subrogada"
              title="Permanent link">&para;</a></h5>
          <p>También podemos añadir una clave subrogada a modo de código (o <code>id</code>) asociado a un número entero
            autoincrementable. Para ello, en <em>MariaDB</em>, tras la definición del atributo como entero (sin signo),
            añadiremos la propiedad <code>AUTO_INCREMENT</code> en la definición del atributo.</p>
          <div class="highlight"><span class="filename">MariaDB</span>
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PERSONA_AI</span><span class="w"> </span><span class="p">(</span>
<span class="hll"><span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">UNSIGNED</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
</span><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">fecha</span><span class="w"> </span><span class="nb">DATE</span><span class="p">);</span>
</code></pre>
          </div>
          <p>En <em>PostgreSQL</em> existe el tipo <a
              href="https://www.postgresql.org/docs/current/datatype-numeric.html#DATATYPE-SERIAL"><code>SERIAL</code></a>
            (o <code>BIGSERIAL</code> el cual utiliza 8 <em>bytes</em>, si necesitamos un número mayor) para crear un
            identificador único.</p>
          <div class="highlight"><span class="filename">PostgreSQL</span>
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PERSONA_SERIAL</span><span class="w"> </span><span class="p">(</span>
<span class="hll"><span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
</span><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">fecha</span><span class="w"> </span><span class="nb">DATE</span><span class="p">);</span>
</code></pre>
          </div>
          <p>Un caso menos conocido incluido en el <em>standard</em> SQL:2011 es la cláusula <a
              href="https://www.postgresql.org/docs/current/ddl-identity-columns.html"><code>GENERATED { ALWAYS | BY DEFAULT } AS IDENTITY</code></a>
            para definir columnas autoincrementales de manera portable. El problema es que ni <em>MariaDB</em> ni
            <em>MySQL</em> lo soportan, aunque sí <em>PostgreSQL</em>, <em>Oracle</em> o <em>DB2</em>, entre otros:
          </p>
          <div class="highlight"><span class="filename">PostgreSQL</span>
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PERSONA_IDENTITY</span><span class="w"> </span><span class="p">(</span>
<span class="hll"><span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">BIGINT</span><span class="w"> </span><span class="k">GENERATED</span><span class="w"> </span><span class="n">ALWAYS</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">IDENTITY</span><span class="p">,</span>
</span><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">fecha</span><span class="w"> </span><span class="nb">DATE</span><span class="p">);</span>
</code></pre>
          </div>
          <p>Finalmente, comentar la posibilidad de utilizar <strong>secuencias</strong> en vez de los tipos
            autoincrementables, tanto en <em>PostgreSQL</em> como en <em>Oracle</em>. Antes de crear una tabla,
            crearemos una secuencia mediante <a
              href="https://www.postgresql.org/docs/current/sql-createsequence.html"><code>CREATE SEQUENCE</code></a>.
            Además, previamente a cada inserción, hemos de recuperar el siguiente valor de la secuencia mediante la
            función <code>nextval</code>:</p>
          <div class="highlight"><span class="filename">PostgreSQL</span>
            <pre><span></span><code><span class="hll"><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="n">SEQUENCE</span><span class="w"> </span><span class="n">pid_seq</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">;</span>
</span><span class="linenos" data-linenos="2 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PERSONA_SEQ</span><span class="w"> </span><span class="p">(</span>
<span class="hll"><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;pid_seq&#39;</span><span class="p">),</span>
</span><span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="n">fecha</span><span class="w"> </span><span class="nb">DATE</span>
<span class="linenos" data-linenos="6 "></span><span class="p">);</span>
<span class="linenos" data-linenos="7 "></span>
<span class="hll"><span class="linenos" data-linenos="8 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">PERSONA_SEQ</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="n">nextval</span><span class="p">(</span><span class="s1">&#39;pid_seq&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;Juani Moya&#39;</span><span class="p">);</span>
</span></code></pre>
          </div>
          <div class="admonition info">
            <p class="admonition-title">UUID</p>
            <p>El tipo de datos <a href="https://es.wikipedia.org/wiki/Identificador_%C3%BAnico_universal">UUID</a> está
              pensado para el almacenamiento de datos UUID (<em>Universally Unique Identifier</em>) de 128 bits, el cual
              es una alternativa común a las claves primarias numéricas respaldadas por secuencias o números
              auto-incrementables. Un ejemplo de dato sería <code>93aac041-1a14-11ec-ab4e-f859713e4be4</code>.</p>
            <p>Los sistemas más antiguos se diseñaron en una época donde las aplicaciones eran principalmente
              monolíticas y centralizadas. En ese contexto, usar claves primarias auto-incrementables era más eficiente
              y lógico.</p>
            <p>Con el auge de los sistemas distribuidos, las aplicaciones web escalables y la necesidad de sincronizar
              datos entre múltiples sistemas, los UUID se volvieron cada vez más valiosos. Un UUID permite generar
              identificadores únicos en cualquier parte de un sistema distribuido sin temer colisiones, lo cual es
              imposible con claves auto-incrementales.</p>
            <p>Tanto <em>MariaDB</em> como <em>PostgreSQL</em> soportan el tipo de dato <code>UUID</code>, pero cada
              SGBD utiliza diferentes funciones para su uso (en <em>MariaDB</em> disponemos de la función <a
                href="https://mariadb.com/docs/server/reference/sql-functions/secondary-functions/miscellaneous-functions/uuid"><code>UUID()</code></a>
              mientras que en <em>PostgreSQL</em> usaremos <a
                href="https://www.postgresql.org/docs/current/functions-uuid.html"><code>gen_random_uuid()</code></a>).
            </p>
            <p>Veamos un ejemplo sobre una tabla de usuarios:</p>
            <div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1"
                name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" />
              <div class="tabbed-labels"><label for="__tabbed_8_1">MariaDB</label><label
                  for="__tabbed_8_2">PostgreSQL</label></div>
              <div class="tabbed-content">
                <div class="tabbed-block">
                  <div class="highlight">
                    <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">USUARIO_UUID</span><span class="w"> </span><span class="p">(</span>
<span class="hll"><span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="n">UUID</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">UUID</span><span class="p">(),</span>
</span><span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="n">fecha_creacion</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span>
<span class="linenos" data-linenos=" 6 "></span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="c1">-- 3. Insertar datos (UUID se genera automáticamente)</span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">USUARIO_UUID</span><span class="w"> </span><span class="p">(</span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span>
<span class="linenos" data-linenos="10 "></span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Ana Martínez&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ana@ejemplo.com&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="c1">-- 4. Insertar con UUID específico usando el tipo nativo</span>
<span class="linenos" data-linenos="13 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">USUARIO_UUID</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span>
<span class="linenos" data-linenos="14 "></span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;550e8400-e29b-41d4-a716-446655440000&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Luis Rodríguez&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;luis@ejemplo.com&#39;</span><span class="p">);</span><span class="w">        </span>
<span class="linenos" data-linenos="15 "></span>
<span class="linenos" data-linenos="16 "></span><span class="c1">-- 5. Consultar datos</span>
<span class="linenos" data-linenos="17 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">USUARIO_UUID</span><span class="p">;</span>
<span class="linenos" data-linenos="18 "></span>
<span class="linenos" data-linenos="19 "></span><span class="c1">-- 6. Generar UUID manualmente</span>
<span class="hll"><span class="linenos" data-linenos="20 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">UUID</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">nuevo_uuid</span><span class="p">;</span>
</span></code></pre>
                  </div>
                </div>
                <div class="tabbed-block">
                  <div class="highlight">
                    <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">USUARIO_UUID</span><span class="w"> </span><span class="p">(</span>
<span class="hll"><span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="n">UUID</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">gen_random_uuid</span><span class="p">(),</span>
</span><span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="n">fecha_creacion</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span>
<span class="linenos" data-linenos=" 6 "></span><span class="p">);</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">USUARIO_UUID</span><span class="w"> </span><span class="p">(</span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Juan Pérez&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;juan@ejemplo.com&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="10 "></span>
<span class="linenos" data-linenos="11 "></span><span class="c1">-- 4. Insertar con UUID específico</span>
<span class="linenos" data-linenos="12 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">USUARIO_UUID</span><span class="w"> </span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">)</span><span class="w"> </span>
<span class="linenos" data-linenos="13 "></span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;550e8400-e29b-41d4-a716-446655440000&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;María García&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;maria@ejemplo.com&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="c1">-- 5. Consultar datos</span>
<span class="linenos" data-linenos="16 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">USUARIO_UUID</span><span class="p">;</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="c1">-- 6. Generar UUID manualmente</span>
<span class="hll"><span class="linenos" data-linenos="19 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">gen_random_uuid</span><span class="p">()</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">nuevo_uuid</span><span class="p">;</span>
</span></code></pre>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!--
FIXME: probar y pegar resultados.. cambiar comentarios
-->

          <h4 id="modificando-tablas">Modificando tablas<a class="headerlink" href="05ddl.html#modificando-tablas"
              title="Permanent link">&para;</a></h4>
          <p>Una vez creada una tabla, podemos modificar su estructura mediante las sentencias
            <strong><code>ALTER TABLE</code></strong>, tanto en <a
              href="https://mariadb.com/kb/en/alter-table/">MariaDB</a> como en <a
              href="https://www.postgresql.org/docs/current/sql-altertable.html">PostgreSQL</a>.
          </p>
          <p>Para añadir columnas, usaremos la opción <strong><code>ADD</code></strong>:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nombreTabla</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">nombreColumna</span><span class="w"> </span><span class="n">tipoDatos</span><span class="w"> </span><span class="p">[</span><span class="n">propiedades</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="k">FIRST</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">AFTER</span><span class="w"> </span><span class="n">nombreColumna</span><span class="p">]</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="p">[,</span><span class="n">columnaSiguiente</span><span class="w"> </span><span class="n">tipoDatos</span><span class="w"> </span><span class="p">[</span><span class="n">propiedades</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="k">FIRST</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">AFTER</span><span class="w"> </span><span class="n">nombreColumna</span><span class="p">]</span><span class="err">…</span><span class="p">)</span>
</code></pre>
          </div>
          <p>De este modo, si queremos añadir un campo para almacenar el teléfono de los empleados (sus campos estarán
            inicializados a <code>NULL</code> para cada registro de la tabla <code>EMPLEADO</code>), haríamos:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="n">telefono</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">12</span><span class="p">);</span>
</code></pre>
          </div>
          <p>Si la hubiéramos querido añadir como la primera columna de la tabla, necesitamos indicar el parámetro
            <code>FIRST</code>, o si queremos que vaya detrás de una determinada columna, usaremos
            <code>AFTER nombreColumna</code>:
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">UNSIGNED</span><span class="w"> </span><span class="k">FIRST</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="n">apellidos</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w"> </span><span class="k">AFTER</span><span class="w"> </span><span class="n">nombre</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Si comprobamos qué columnas tenemos veremos que se han añadido las nuevas en las posiciones indicadas:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">describe</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">-- +--------------+------------------+------+-----+---------+-------+</span>
<span class="linenos" data-linenos=" 3 "></span><span class="c1">-- | Field        | Type             | Null | Key | Default | Extra |</span>
<span class="linenos" data-linenos=" 4 "></span><span class="c1">-- +--------------+------------------+------+-----+---------+-------+</span>
<span class="linenos" data-linenos=" 5 "></span><span class="c1">-- | id           | int(10) unsigned | YES  |     | NULL    |       |</span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">-- | codigo       | varchar(9)       | NO   | PRI | NULL    |       |</span>
<span class="linenos" data-linenos=" 7 "></span><span class="c1">-- | departamento | varchar(15)      | NO   | PRI | NULL    |       |</span>
<span class="linenos" data-linenos=" 8 "></span><span class="c1">-- | nombre       | varchar(40)      | YES  |     | NULL    |       |</span>
<span class="linenos" data-linenos=" 9 "></span><span class="c1">-- | apellidos    | varchar(128)     | YES  |     | NULL    |       |</span>
<span class="linenos" data-linenos="10 "></span><span class="c1">-- | telefono     | char(12)         | YES  |     | NULL    |       |</span>
<span class="linenos" data-linenos="11 "></span><span class="c1">-- +--------------+------------------+------+-----+---------+-------+</span>
<span class="linenos" data-linenos="12 "></span><span class="c1">-- 6 rows in set (0.002 sec)</span>
</code></pre>
          </div>
          <p>En cambio, si queremos eliminar una columna, usaremos la opción <code>DROP</code>:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nombreTabla</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="p">(</span><span class="n">columna</span><span class="w"> </span><span class="p">[,</span><span class="n">columnaSiguiente</span><span class="p">,...]);</span>
</code></pre>
          </div>
          <p>Así pues, si queremos eliminar el teléfono recién creado, haremos:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="p">(</span><span class="n">telefono</span><span class="p">);</span>
</code></pre>
          </div>
          <p>Finalmente, si queremos modificar el tipo de una columna, usaremos la opción
            <strong><code>MODIFY</code></strong>:
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nombreTabla</span><span class="w"> </span><span class="k">MODIFY</span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">columna</span><span class="w"> </span><span class="n">tipo</span><span class="w"> </span><span class="p">[</span><span class="n">propiedades</span><span class="p">]</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="p">[,</span><span class="n">columnaSiguiente</span><span class="w"> </span><span class="n">tipo</span><span class="w"> </span><span class="p">[</span><span class="n">propiedades</span><span class="p">]]</span>
</code></pre>
          </div>
          <p>Un caso particular de las operaciones de modificación es renombrar una tabla. Para ello, usaremos la opción
            <code>RENAME TO</code>:
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nombreTablaViejo</span><span class="w"> </span><span class="k">RENAME</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">nombreNuevo</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Finalmente, si queremos <a href="https://mariadb.com/kb/en/setting-character-sets-and-collations/">cambiar
              el juego de caracteres</a> (y la colación) de una tabla concreta, haremos:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">nombreTabla</span><span class="w"> </span><span class="k">CONVERT</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="nb">CHARACTER</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">nuevoJuego</span><span class="w"> </span><span class="p">[</span><span class="k">COLLATE</span><span class="w"> </span><span class="n">nuevaColacion</span><span class="p">];</span>
</code></pre>
          </div>
          <div class="admonition question">
            <p class="admonition-title">Autoevaluación</p>
            <p>Si tenemos las siguientes tablas:</p>
            <div class="highlight">
              <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CLIENTE</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">dni</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">direccion</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">60</span><span class="p">));</span>
<span class="linenos" data-linenos="5 "></span>
<span class="linenos" data-linenos="6 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="n">codigo</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos="8 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="linenos" data-linenos="9 "></span><span class="w">    </span><span class="n">raza</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">));</span>
</code></pre>
            </div>
            <p>¿Sabes qué realizan las siguientes operaciones?</p>
            <div class="highlight">
              <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="n">especie</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AFTER</span><span class="w"> </span><span class="n">raza</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="n">cliente</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="k">AFTER</span><span class="w"> </span><span class="n">nombre</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">fk_duenyo</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">cliente</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">CLIENTE</span><span class="p">(</span><span class="n">dni</span><span class="p">);</span>
<span class="linenos" data-linenos="4 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="k">MODIFY</span><span class="w"> </span><span class="n">codigo</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">;</span>
</code></pre>
            </div>
            <p>Las siguientes instrucciones realizan la misma operación pero en diferente SGBD. ¿Sabrías averiguar de
              quién es cada sentencia?</p>
            <div class="highlight">
              <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="n">CHANGE</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="n">nomMascota</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">MASCOTA</span><span class="w"> </span><span class="k">RENAME</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="n">nomMascota</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span>
</code></pre>
            </div>
          </div>
          <h4 id="eliminando-tablas">Eliminando tablas<a class="headerlink" href="05ddl.html#eliminando-tablas"
              title="Permanent link">&para;</a></h4>
          <p>Para eliminar tablas se emplea la instrucción <code>DROP TABLE nombreTabla</code>, tanto en <a
              href="https://mariadb.com/kb/en/drop-table/">MariaDB</a> como en <a
              href="https://www.postgresql.org/docs/current/sql-droptable.html">PostgreSQL</a>. Hemos de tener en cuenta
            que cuando tenemos un base de datos con tablas relacionadas mediante claves ajenas, la integridad
            referencial restringe el borrado de una clave primaria referenciada por una clave ajena. Es por ello que el
            orden importa, y tenemos que ir eliminando primero las tablas que contienen las claves ajenas y no son
            referenciadas por otras tablas.</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CLIENTE</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Si queremos borrar una tabla para volver a crearla, bien podemos hacerla mediante un
            <code>DROP TABLE</code> seguido de un <code>CREATE TABLE</code>, o directamente realiza un
            <code>CREATE OR REPLACE TABLE</code>:
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CLIENTE</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">dni</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">cnombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">direccion</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">60</span><span class="p">));</span>
</code></pre>
          </div>
          <h3 id="restricciones">Restricciones<a class="headerlink" href="05ddl.html#restricciones"
              title="Permanent link">&para;</a></h3>
          <p>Una vez hemos visto los casos más sencillos, hemos de saber que las tablas van a contener restricciones que
            aportan mayor integridad a los datos, en forma de claves ajenas, validaciones de campos, campos no nulos,
            únicos, etc... representando las restricciones estudiadas en el modelo relacional.</p>
          <p>Así pues, si volvemos a la creación de tablas, podemos indicar las restricciones mediante diferentes
            parámetros:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="p">[</span><span class="k">TEMPORARY</span><span class="p">]</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">db</span><span class="p">.]</span><span class="n">tabla</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">campo1</span><span class="w"> </span><span class="n">tipo</span><span class="w"> </span><span class="p">[(</span><span class="n">tamaño</span><span class="p">)]</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">        </span><span class="p">[</span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NULL</span><span class="p">]</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">        </span><span class="p">[</span><span class="k">DEFAULT</span><span class="w"> </span><span class="n">valor</span><span class="p">]</span><span class="w"> </span><span class="c1">-- valor por defecto</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">        </span><span class="p">[</span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">[</span><span class="k">KEY</span><span class="p">]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">]</span><span class="w"> </span><span class="c1">-- clave única o primaria</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="p">[</span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">tablaexterna</span><span class="w"> </span><span class="p">[(</span><span class="n">campoexterno1</span><span class="p">,</span><span class="w"> </span><span class="n">campoexterno2</span><span class="p">)]</span><span class="w"> </span><span class="c1">-- atributo clave ajena</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">            </span><span class="p">[</span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="err">{</span><span class="k">CASCADE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w"> </span><span class="n">ACTION</span><span class="err">}</span><span class="p">]</span><span class="w"> </span><span class="c1">-- propagación de borrados</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">            </span><span class="p">[</span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="err">{</span><span class="k">CASCADE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">NO</span><span class="w"> </span><span class="n">ACTION</span><span class="err">}</span><span class="p">],</span><span class="w"> </span><span class="c1">-- propagación de actualizaciones</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="p">....,</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="p">[</span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">múltiples</span><span class="w"> </span><span class="n">campos</span><span class="p">])</span><span class="w"> </span><span class="c1">-- definición de restricciones</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="n">ENGINE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Innodb</span><span class="p">;</span><span class="w"> </span><span class="c1">-- motor de ejecución</span>
</code></pre>
          </div>
          <p>Las restricciones las podemos definir a nivel de opciones dentro de cada campo, o tras la definición de
            todos los campos, mediante la <em>keyword</em> <code>CONSTRAINT</code> tanto en <a
              href="https://mariadb.com/kb/en/constraint/">MariaDB</a> como en <a
              href="https://www.postgresql.org/docs/current/ddl-constraints.html">PostgreSQL</a>.</p>
          <h4 id="claves-unicas">Claves únicas<a class="headerlink" href="05ddl.html#claves-unicas"
              title="Permanent link">&para;</a></h4>
          <p>Cuando marcamos en el modelo relacional una propiedad como <code>UK</code>, es decir, clave única o
            alternativa, estamos indicando que dicho atributo no permite repetidos. Para ello, en el modelo físico y
            mediante SQL, ahora usaremos la propiedad <strong><code>UNIQUE</code></strong>, que provocará la creación de
            un índice (los índices los estudiaremos en la unidad 9).</p>
          <p>Recuerda que las claves alternativas, normalmente, son una de las claves candidatas que no hemos elegido
            como clave primaria:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">dni</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="hll"><span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nSegSocial</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
</span><span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">));</span>
</code></pre>
          </div>
          <p>La principal diferencia entre una clave primaria y una clave única es que la clave única permite valores
            nulos.</p>
          <div class="admonition tip">
            <p class="admonition-title">Buenas prácticas - Nombrando las restricciones</p>
            <p>Aunque hemos visto que podemos añadir las restricciones asociadas a cada campo, es mucho mejor definirlas
              tras todos los campos, haciendo uso de la <em>keyword</em> <a
                href="https://mariadb.com/kb/en/constraint/"><code>CONSTRAINT</code></a> poniéndole un nombre a la
              restricción. Así pues, como norma general, nombraremos las restricciones con <code>PK</code>,
              <code>UK</code>, <code>FK</code>, etc... y utilizando la barra de subrayado como separador, seguido del
              nombre de la tabla y/o los campos implicados.
            </p>
            <p>Al asignarles un nombre, más adelante podremos acceder a las restricciones para modificarlas o
              eliminarlas. Además, si ocurre alguna violación de una restricción, el mensaje de error contendrá el
              nombre de la restricción, lo que nos facilitará identificar el problema.</p>
            <p>De este modo, la tabla anterior queda mucho mejor si la definimos mediante:</p>
            <div class="highlight">
              <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">dni</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nSegSocial</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">),</span>
<span class="hll"><span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_EMPLEADO</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dni</span><span class="p">),</span>
</span><span class="hll"><span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">UK_EMPLEADO_SEGSOC</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">nSegSocial</span><span class="p">)</span>
</span><span class="linenos" data-linenos="7 "></span><span class="p">);</span>
</code></pre>
            </div>
            <p>Por supuesto, si no le asignamos un nombre a una restricción, el SGBD le asignará un nombre
              automáticamente.</p>
            <p>Por último, ciertas restricciones, como <code>NOT NULL</code> y <code>DEFAULT</code>, no se suelen
              nombran. Estas restricciones es mejor definirlas a nivel de columna, ya que rara vez podrían referenciarse
              por separado, y así son más fáciles de escribir y más sencillos de leer.</p>
          </div>
          <h4 id="claves-ajenas">Claves ajenas<a class="headerlink" href="05ddl.html#claves-ajenas"
              title="Permanent link">&para;</a></h4>
          <p>Para indicar las claves ajenas, aunque podemos hacerlo a nivel de campo, es mucho mejor acostumbrarse a
            definirlas siempre como restricciones. Para ello, usaremos la siguiente estructura, donde <code>col</code>
            es el campo que apunta a la clave primaria <code>clave</code> de la tabla <code>tabla</code>. </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">col</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="p">(</span><span class="n">clave</span><span class="p">)</span>
</code></pre>
          </div>
          <p>Como norma general, nombraremos a las claves ajenas como
            <code>FK_&lt;TABLAPADRE&gt;_&lt;TABLAHIJO&gt;</code> sustituyendo los nombres de las tablas por los tres
            primeros caracteres de cada una de ellas.
          </p>
          <p>Así pues, un ejemplo de tabla con clave primaria y claves ajenas definidas mediante <code>CONSTRAINT</code>
            sería:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ALQUILER</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">dni</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">codPelicula</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">UNSIGNED</span><span class="p">,</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_ALQUILER</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dni</span><span class="p">,</span><span class="w"> </span><span class="n">codPelicula</span><span class="p">),</span>
<span class="hll"><span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_ALQ_CLI</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">dni</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">CLIENTE</span><span class="p">(</span><span class="n">dni</span><span class="p">),</span>
</span><span class="hll"><span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_ALQ_PEL</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">codPelicula</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">PELICULA</span><span class="p">(</span><span class="n">cod</span><span class="p">)</span>
</span><span class="linenos" data-linenos="7 "></span><span class="p">);</span>
</code></pre>
          </div>
          <p>Cuando tenemos una clave ajena compuesta, sólo hemos de indicar los atributos separándolos con comas:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EXISTIR</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">tipo</span><span class="w"> </span><span class="nb">CHAR</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">modelo</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">numAlmacen</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="n">cantidad</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_EXISTIR</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">tipo</span><span class="p">,</span><span class="w"> </span><span class="n">modelo</span><span class="p">,</span><span class="w"> </span><span class="n">numAlmacen</span><span class="p">),</span>
<span class="hll"><span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_EXI_PIE</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">tipo</span><span class="p">,</span><span class="w"> </span><span class="n">modelo</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">PIEZA</span><span class="p">,</span>
</span><span class="linenos" data-linenos="8 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_EXI_ALM</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">numAlmacen</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">ALMACEN</span>
<span class="linenos" data-linenos="9 "></span><span class="p">);</span>
</code></pre>
          </div>
          <h4 id="propagacion">Propagación<a class="headerlink" href="05ddl.html#propagacion"
              title="Permanent link">&para;</a></h4>
          <p>Cuando se elimina (<code>ON DELETE</code>) o actualiza (<code>ON UPDATE</code>) un campo que está
            referenciado mediante una clave ajena, debemos indicar qué comportamiento de propagación debe realizar el
            SGBD con los datos en las tablas origen. Estas operaciones se conocen como acciones referenciales.</p>
          <p>Vamos a retomar el ejemplo que vimos en la unidad 3, sobre un estudiante y las asignaturas que cursa, el
            cual se podría traducir en el siguiente DDL:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ESTUDIANTE</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">nif</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">codigo</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="n">fMatricula</span><span class="w"> </span><span class="nb">date</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="n">direccion</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">),</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_ESTUDIANTE</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">nif</span><span class="p">)</span>
<span class="linenos" data-linenos=" 8 "></span><span class="p">);</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CURSAR</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="n">nifEstudiante</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="n">asignatura</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="n">anyo</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="linenos" data-linenos="14 "></span><span class="w">    </span><span class="n">repetidor</span><span class="w"> </span><span class="nb">boolean</span><span class="p">,</span>
<span class="linenos" data-linenos="15 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_CURSAR</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">nifEstudiante</span><span class="p">,</span><span class="w"> </span><span class="n">asignatura</span><span class="p">,</span><span class="w"> </span><span class="n">anyo</span><span class="p">),</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_CUR_EST</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">nifEstudiante</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">ESTUDIANTE</span><span class="p">(</span><span class="n">nif</span><span class="p">)</span>
<span class="linenos" data-linenos="17 "></span><span class="p">);</span>
</code></pre>
          </div>
          <p>Y un ejemplo de las tablas con datos sería:</p>
          <ul>
            <li>
              <p><code>ESTUDIANTE</code></p>
              <table>
                <thead>
                  <tr>
                    <th><ins>nif</ins></th>
                    <th>codigo</th>
                    <th>nombre</th>
                    <th>fMatricula</th>
                    <th>direccion</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>12345678A</td>
                    <td>1</td>
                    <td>Pedro Casas</td>
                    <td>1/9/24</td>
                    <td>Avenida de la libertad, 23</td>
                  </tr>
                  <tr>
                    <td>48123456B</td>
                    <td>2</td>
                    <td>Mireia Vidal</td>
                    <td>1/9/24</td>
                    <td>Porta de la Morera, 6</td>
                  </tr>
                </tbody>
              </table>
            </li>
            <li>
              <p><code>CURSAR</code></p>
              <table>
                <thead>
                  <tr>
                    <th><ins>nifEstudiante</ins>*</th>
                    <th><ins>asignatura</ins></th>
                    <th><ins>anyo</ins></th>
                    <th>repetidor</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>12345678A</td>
                    <td>1</td>
                    <td>2024</td>
                    <td><code>TRUE</code></td>
                  </tr>
                  <tr>
                    <td>48123456B</td>
                    <td>1</td>
                    <td>2024</td>
                    <td><code>FALSE</code></td>
                  </tr>
                  <tr>
                    <td>12345678A</td>
                    <td>2</td>
                    <td>2023</td>
                    <td><code>FALSE</code></td>
                  </tr>
                </tbody>
              </table>
            </li>
          </ul>
          <p>¿Cómo repercute el sistema si eliminamos el estudiante <code>12345678A</code> de la tabla
            <code>ESTUDIANTE</code>? ¿O le cambiamos el <code>nif</code> (algo inusual, pero que puede pasar si nos
            hemos equivocado al teclearlo)? ¿Qué opciones tenemos para respetar la integridad referencial?
          </p>
          <p>Las posibilidades son:</p>
          <ul>
            <li><strong><code>RESTRICT</code> / <code>NO ACTION</code></strong>: se impide la operación, rechazando el
              borrado o la actualización. Este es el comportamiento por defecto si no indicamos nada.</li>
            <li><strong><code>CASCADE</code></strong>: la operación se propaga de la tabla origen a la de destino. Esto
              es, si borramos el estudiante, borrará los registros de <code>CURSAR</code>. Si modificamos su
              <code>nif</code>, también modificará los <code>nifEstudiante</code> de <code>CURSAR</code>.
            </li>
            <li><strong><code>SET NULL</code></strong>: la clave ajena se pone a <code>NULL</code>, de manera que se
              pierde la relación existente, provocando probablemente inconsistencia de datos.</li>
          </ul>
          <p>Si volvemos a definir la tabla <code>CURSAR</code> indicando las restricciones de propagación, podríamos
            hacer:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CURSAR</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">nifEstudiante</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">asignatura</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">anyo</span><span class="w"> </span><span class="nb">int</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="n">repetidor</span><span class="w"> </span><span class="nb">boolean</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_CURSAR</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">(</span><span class="n">nifEstudiante</span><span class="p">,</span><span class="w"> </span><span class="n">asignatura</span><span class="p">,</span><span class="w"> </span><span class="n">anyo</span><span class="p">),</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_CUR_EST</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">nifEstudiante</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">ESTUDIANTE</span><span class="p">(</span><span class="n">nif</span><span class="p">)</span>
<span class="hll"><span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span>
</span><span class="hll"><span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">NO</span><span class="w"> </span><span class="n">ACTION</span>
</span><span class="linenos" data-linenos="10 "></span><span class="p">);</span>
</code></pre>
          </div>
          <div class="admonition question">
            <p class="admonition-title">Autoevaluación</p>
            <p>¿Por qué en este caso concreto no podemos indicar la acción <code>SET NULL</code>?</p>
          </div>
          <h4 id="validaciones">Validaciones<a class="headerlink" href="05ddl.html#validaciones"
              title="Permanent link">&para;</a></h4>
          <p>Para poder incluir restricciones de validación y que los datos introducidos cumplan ciertas condiciones,
            emplearemos el atributo <code>CHECK</code>, tanto tras la definición de un atributo como una restricción con
            <code>CONSTRAINT</code>:
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">INGRESO1</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">cod</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">concepto</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="hll"><span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">importe</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">importe</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">importe</span><span class="o">&lt;</span><span class="mi">8000</span><span class="p">));</span>
</span><span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">INGRESO2</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="n">cod</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="n">concepto</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="n">importe</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="hll"><span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">CK_INGRESO</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">importe</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">importe</span><span class="o">&lt;</span><span class="mi">8000</span><span class="p">));</span>
</span></code></pre>
          </div>
          <p>También podemos crear validaciones que comparen el valor de dos atributos de la tabla:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">INGRESO3</span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">cod</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">concepto</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">importeMax</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="n">importe</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_INGRESO</span><span class="w"> </span><span class="p">(</span><span class="n">cod</span><span class="p">),</span>
<span class="hll"><span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">CK_INGRESO</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">importe</span><span class="o">&lt;</span><span class="n">importeMax</span><span class="p">));</span>
</span></code></pre>
          </div>
          <!--
TODO: Ampliar con conjunto de valores (restringir valores)

Hacer una actividad donde hagan CHECK y comparen con otra implementación mediante relación 1:N ¿Cuando es mejor una y no la otra?
-->

          <h4 id="gestionando">Gestionando<a class="headerlink" href="05ddl.html#gestionando"
              title="Permanent link">&para;</a></h4>
          <p>Además de indicar las restricciones mientras creamos una tabla, podemos añadirlas sobre una tabla existente
            mediante sentencia <code>ALTER TABLE</code>.</p>
          <p>Así pues, para añadir una nueva restricción usaremos la opción <code>ADD</code>:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="p">[</span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">nombre</span><span class="p">]</span><span class="w"> </span><span class="n">tipoDeRestricción</span><span class="w"> </span><span class="p">(</span><span class="n">columnas</span><span class="p">);</span>
</code></pre>
          </div>
          <p>Para eliminar, la opción <code>DROP</code>:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="err">{</span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">nombreRestricción</span><span class="err">}</span><span class="w"> </span><span class="p">[</span><span class="k">CASCADE</span><span class="p">]</span>
</code></pre>
          </div>
          <p>Algunos ejemplos de gestión de restricciones sobre los esquemas que hemos ido trabajando serían:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">-- Borramos una clave ajena</span>
<span class="linenos" data-linenos="2 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CURSAR</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_CUR_EST</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">-- La volvemos a crear</span>
<span class="linenos" data-linenos="4 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CURSAR</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_CUR_EST_NUEVA</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">nifEstudiante</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">ESTUDIANTE</span><span class="p">(</span><span class="n">nif</span><span class="p">);</span>
<span class="linenos" data-linenos="5 "></span><span class="c1">-- Borramos una validación</span>
<span class="linenos" data-linenos="6 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">INGRESO3</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">CK_INGRESO</span><span class="p">;</span>
<span class="linenos" data-linenos="7 "></span><span class="c1">-- La volvemos a crear</span>
<span class="linenos" data-linenos="8 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">INGRESO3</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">CK_INGRESO_NUEVA</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">importe</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">importe</span><span class="o">&lt;</span><span class="n">importeMax</span><span class="p">));</span>
</code></pre>
          </div>
          <p>Debes tener en cuenta que para eliminar una clave primaria, no debe haber ninguna clave ajena apuntando a
            ella. Además, si la clave primaria ya es clave ajena, antes de poder borrar la clave, deberemos borrar las
            claves ajenas que formen parte de la clave primaria y luego borrar sus índices. Por ejemplo:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">relacionNM</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">PK_MUCHOS_N</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">relacionNM</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">PK_MUCHOS_M</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">relacionNM</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">FK_MUCHO_N</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">relacionNM</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="n">FK_MUCHO_M</span><span class="p">;</span>
<span class="linenos" data-linenos="5 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">relacionNM</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Respecto a las claves, si queremos deshabilitarlas para hacer algún tipo de modificación, haremos uso de
            las opciones <code>ENABLE</code> o <code>DISABLE</code> según convenga:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="n">ENABLE</span><span class="w"> </span><span class="n">KEYS</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="n">DISABLE</span><span class="w"> </span><span class="n">KEYS</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Finalmente, si queremos comprobar todas las restricciones que tiene una tabla, podemos ejecutar la
            sentencia <code>SHOW CREATE TABLE</code>.</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">SHOW</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">CURSAR</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">-- +--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="linenos" data-linenos=" 3 "></span><span class="c1">-- | Table  | Create Table                                                                                                                                                                                                                                                                                                                                                                         |</span>
<span class="linenos" data-linenos=" 4 "></span><span class="c1">-- +--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="linenos" data-linenos=" 5 "></span><span class="c1">-- | CURSAR | CREATE TABLE `CURSAR` (</span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">--   `nifEstudiante` varchar(9) NOT NULL,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="c1">--   `asignatura` int(11) NOT NULL,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="c1">--   `anyo` int(11) NOT NULL,</span>
<span class="linenos" data-linenos=" 9 "></span><span class="c1">--   `repetidor` tinyint(1) DEFAULT NULL,</span>
<span class="linenos" data-linenos="10 "></span><span class="c1">--   PRIMARY KEY (`nifEstudiante`,`asignatura`,`anyo`),</span>
<span class="linenos" data-linenos="11 "></span><span class="c1">--   CONSTRAINT `FK_CUR_EST` FOREIGN KEY (`nifEstudiante`) REFERENCES `ESTUDIANTE` (`nif`)</span>
<span class="linenos" data-linenos="12 "></span><span class="c1">-- ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_uca1400_ai_ci |</span>
<span class="linenos" data-linenos="13 "></span><span class="c1">-- +--------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span>
<span class="linenos" data-linenos="14 "></span><span class="c1">-- 1 row in set (0.001 sec)</span>
</code></pre>
          </div>
          <div class="admonition tip">
            <p class="admonition-title">Organizando las restricciones</p>
            <p>Para tener una mejor organización de las restricciones, definiremos:</p>
            <ul>
              <li>a nivel de columnas: <code>DEFAULT</code>, <code>NOT NULL</code> y <code>AUTO_INCREMENT</code>.</li>
              <li>mediante <code>CONSTRAINT</code> tras la definición de las columnas: <code>PRIMARY KEY</code>,
                <code>UNIQUE</code>, <code>FOREIGN KEY</code> y <code>CHECK</code>.
              </li>
            </ul>
          </div>
          <div class="admonition info">
            <p class="admonition-title">Otros elementos</p>
            <p>Existen otras estructuras que forman parte de DDL pero que veremos más adelante son:</p>
            <ul>
              <li><strong>Vistas</strong>: Permiten crear una representación externa (tabla virtual) a partir de una
                consulta, mediante <code>CREATE VIEW</code>. Las estudiaremos en la <a
                  href="07sql-group.html#vistas">unidad 7</a>.</li>
              <li><strong>Índices</strong>: Se utilizan para acelerar las consultas, mediante <code>CREATE INDEX</code>.
                Los estudiaremos en la <a href="08sql-subquerys.html#indices">unidad 9</a>.</li>
              <li><strong>Disparadores</strong> (<em>triggers</em>): Se asocian a operaciones que se producen en el
                sistema (evento) para realizar otra acción. Los estudiaremos en la <a
                  href="11triggers.html#triggers">unidad 11</a>.</li>
            </ul>
          </div>
          <h3 id="supuesto-ddl">Supuesto DDL<a class="headerlink" href="05ddl.html#supuesto-ddl"
              title="Permanent link">&para;</a></h3>
          <p>Para integrar todos los conceptos planteados, vamos a realizar un supuesto que partiendo de unas tablas con
            datos, generemos el DDL y sus restricciones.</p>
          <p>Así pues, dadas las siguientes tablas de una base de datos: </p>
          <div class="grid cards">
            <ul>
              <li>
                <p><code>VEHICULO</code></p>
                <table>
                  <thead>
                    <tr>
                      <th>MATRICULA</th>
                      <th>MARCA</th>
                      <th>MODELO</th>
                      <th>PERSONA</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>2345AAA</td>
                      <td>Seat</td>
                      <td>Altea</td>
                      <td><code>NULL</code></td>
                    </tr>
                    <tr>
                      <td>1234BBB</td>
                      <td>Opel</td>
                      <td>Astra</td>
                      <td>15</td>
                    </tr>
                    <tr>
                      <td>5555CCC</td>
                      <td>Seat</td>
                      <td>Ibiza</td>
                      <td><code>NULL</code></td>
                    </tr>
                    <tr>
                      <td>9876DDD</td>
                      <td>Lexus</td>
                      <td>LC</td>
                      <td>10</td>
                    </tr>
                    <tr>
                      <td>1111FFF</td>
                      <td>Seat</td>
                      <td>Ibiza</td>
                      <td><code>NULL</code></td>
                    </tr>
                    <tr>
                      <td>2222GGG</td>
                      <td>Opel</td>
                      <td>Astra</td>
                      <td>20</td>
                    </tr>
                  </tbody>
                </table>
              </li>
              <li>
                <p><code>EMPLEADO</code></p>
                <table>
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>NOMBRE</th>
                      <th>DNI</th>
                      <th>JEFE</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>10</td>
                      <td>ANA MARTIN</td>
                      <td>1111A</td>
                      <td><code>NULL</code></td>
                    </tr>
                    <tr>
                      <td>15</td>
                      <td>JUAN LOPEZ</td>
                      <td>2222B</td>
                      <td>10</td>
                    </tr>
                    <tr>
                      <td>20</td>
                      <td>CARMEN DIAZ</td>
                      <td>3333C</td>
                      <td>10</td>
                    </tr>
                    <tr>
                      <td>25</td>
                      <td>ERNESTO GOMEZ</td>
                      <td>4444D</td>
                      <td>20</td>
                    </tr>
                    <tr>
                      <td>30</td>
                      <td>SILVIA GONZALEZ</td>
                      <td>5555E</td>
                      <td>15</td>
                    </tr>
                    <tr>
                      <td>35</td>
                      <td>FERNANDO SIERRA</td>
                      <td>7777F</td>
                      <td>15</td>
                    </tr>
                  </tbody>
                </table>
              </li>
              <li>
                <p><code>ASIGNACION</code></p>
                <table>
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>CODIGO</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>10</td>
                      <td>101</td>
                    </tr>
                    <tr>
                      <td>15</td>
                      <td>101</td>
                    </tr>
                    <tr>
                      <td>20</td>
                      <td>101</td>
                    </tr>
                    <tr>
                      <td>10</td>
                      <td>102</td>
                    </tr>
                    <tr>
                      <td>15</td>
                      <td>102</td>
                    </tr>
                    <tr>
                      <td>30</td>
                      <td>102</td>
                    </tr>
                    <tr>
                      <td>35</td>
                      <td>102</td>
                    </tr>
                    <tr>
                      <td>20</td>
                      <td>103</td>
                    </tr>
                  </tbody>
                </table>
              </li>
              <li>
                <p><code>PROYECTO</code></p>
                <table>
                  <thead>
                    <tr>
                      <th>CODIGO</th>
                      <th>NOMBRE</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>101</td>
                      <td>GRIS</td>
                    </tr>
                    <tr>
                      <td>102</td>
                      <td>BLANCO</td>
                    </tr>
                    <tr>
                      <td>103</td>
                      <td>NEGRO</td>
                    </tr>
                    <tr>
                      <td>104</td>
                      <td>VERDE</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
          <p>Se nos plantea escribir las sentencias DDL necesarias para crear las tablas anteriores, respetando los
            nombre y los tipos de las columnas, y deduciendo la relaciones existentes entre las tablas. Además, debe
            cumplir las siguientes especificaciones:</p>
          <ol>
            <li>Cuando un proyecto es eliminado o modificado, se eliminan o modifican automáticamente las asignaciones
              correspondientes.</li>
            <li>Si un empleado se elimina o actualiza, se eliminan o actualizan las asignaciones de proyecto que pudiera
              tener.</li>
            <li>Cuando un empleado es eliminado, el vehículo que pudiera tener concertado no es eliminado y si la
              persona actualiza su identificación, automáticamente se actualiza también en su vehículo si lo tuviera.
            </li>
            <li>Cuando un empleado se elimina, su jefe sigue permaneciendo. Y si la persona actualiza su identificación,
              se actualiza automáticamente para todos aquellos que esa persona sea su jefe.</li>
          </ol>
          <p>A continuación, se nos pide realizar las siguientes operaciones:</p>
          <ol>
            <li>Eliminar la columna <code>MODELO</code> de la tabla <code>VEHICULO</code>.</li>
            <li>Añadir una columna a <code>VEHICULO</code> que se llame COLOR que acepte los valores
              <code>Blanco</code>, <code>Negro</code> o <code>Otro</code>.
            </li>
            <li>Añadir una columna a <code>VEHICULO</code> que se llame precio que almacene el precio del vehículo, el
              cual siempre debe ser superior a 1000€.</li>
            <li>Vaciar la tabla <code>VEHICULO</code></li>
            <li>Eliminar la tabla <code>VEHICULO</code>.</li>
          </ol>
          <details class="example">
            <summary>Solución</summary>
            <p>El primer paso es definir el modelo relacional para identificar las claves y las relaciones existentes.
            </p>
            <p><code>
<strong>VEHICULO</strong> (<ins>MATRICULA</ins>, MARCA, MODELO, PERSONA<code>*</code>)<br />
              · PK: (MATRICULA)<br />
              · FK: (PERSONA) → EMPLEADO
              </code></p>
            <p><code>
<strong>EMPLEADO</strong> (<ins>ID</ins>, NOMBRE, DNI, JEFE<code>*</code>)<br />
              · PK: (ID)<br />
              · FK: (JEFE) → EMPLEADO<br />
              · VNN: (NOMBRE) <br />
              · VNN: (DNI) <br />
              </code></p>
            <p><code>
<strong>PROYECTO</strong> (<ins>CODIGO</ins>, NOMBRE)<br />
· PK: (CODIGO)<br />
</code></p>
            <p><code>
<strong>ASIGNACION</strong> (<ins>ID</ins><code>*</code>, <ins>CODIGO</ins><code>*</code>)<br />
              · PK: (ID, CODIGO)<br />
              · FK: (ID) → EMPLEADO<br />
              · FK: (CODIGO) → PROYECTO
              </code></p>
            <p>Del modelo relacional deducimos que la tabla <code>ASIGNACIÓN</code> es una relación N:M entre
              <code>EMPLEADO</code> y <code>PROYECTO</code>, y que el atributo <code>EMPLEADO.JEFE</code> es una clave
              ajena que representa una relación reflexiva.
            </p>
            <p>Si empleamos <a href="https://dbdiagram.io/">DBDiagrams</a> para generar un diagrama a partir del esquema
              lógico mediante <a href="https://dbml.dbdiagram.io/docs">DBML</a> indicando los tipos de datos,
              tendríamos:</p>
            <div class="highlight">
              <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">Table</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="err">{</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">ID</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="p">[</span><span class="n">pk</span><span class="p">,</span><span class="w"> </span><span class="k">increment</span><span class="p">]</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">NOMBRE</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="p">]</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">DNI</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="k">unique</span><span class="p">,</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="p">]</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="n">JEFE</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="p">[</span><span class="k">ref</span><span class="p">:</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">.</span><span class="n">ID</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">FK</span><span class="w"> </span><span class="n">autoreferencial</span>
<span class="linenos" data-linenos=" 6 "></span><span class="err">}</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="k">Table</span><span class="w"> </span><span class="n">VEHICULO</span><span class="w"> </span><span class="err">{</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="n">MATRICULA</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">pk</span><span class="p">]</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="n">MARCA</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="n">MODELO</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="n">PERSONA</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="p">[</span><span class="k">ref</span><span class="p">:</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">.</span><span class="n">ID</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">FK</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">EMPLEADO</span>
<span class="linenos" data-linenos="13 "></span><span class="err">}</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="k">Table</span><span class="w"> </span><span class="n">PROYECTO</span><span class="w"> </span><span class="err">{</span>
<span class="linenos" data-linenos="16 "></span><span class="w">    </span><span class="n">CODIGO</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">pk</span><span class="p">]</span>
<span class="linenos" data-linenos="17 "></span><span class="w">    </span><span class="n">NOMBRE</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="linenos" data-linenos="18 "></span><span class="err">}</span>
<span class="linenos" data-linenos="19 "></span>
<span class="linenos" data-linenos="20 "></span><span class="k">Table</span><span class="w"> </span><span class="n">ASIGNACION</span><span class="w"> </span><span class="err">{</span>
<span class="linenos" data-linenos="21 "></span><span class="w">    </span><span class="n">ID</span><span class="w"> </span><span class="nb">int</span><span class="w"> </span><span class="p">[</span><span class="n">pk</span><span class="p">,</span><span class="w"> </span><span class="k">ref</span><span class="p">:</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">.</span><span class="n">ID</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">FK</span><span class="w"> </span><span class="n">compuesta</span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="n">CODIGO</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="n">pk</span><span class="p">,</span><span class="w"> </span><span class="k">ref</span><span class="p">:</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">PROYECTO</span><span class="p">.</span><span class="n">CODIGO</span><span class="p">]</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">FK</span><span class="w"> </span><span class="n">compuesta</span>
<span class="linenos" data-linenos="23 "></span><span class="err">}</span>
</code></pre>
            </div>
            <p>Obteniendo el siguiente diagrama:</p>
            <p>
            <figure style="align: center;">
              <img src="../images/05ddl-supuesto-proyecto.png" width="848" title="Supuesto DDL proyecto">
              <figcaption>Supuesto DDL Proyecto</figcaption>
            </figure>
            </p>
            <!--
<pre class="mermaid"><code>---
config:
look: handDrawn
---
erDiagram
direction LR

EMPLEADO {
    INT ID PK
    VARCHAR NOMBRE
    VARCHAR DNI
    INT JEFE FK
}

VEHICULO {
    VARCHAR MATRICULA PK
    VARCHAR MARCA
    VARCHAR MODELO
    INT PERSONA FK
}

PROYECTO {
    VARCHAR CODIGO PK
    VARCHAR NOMBRE
}

ASIGNACION {
    INT ID PK,FK
    VARCHAR CODIGO PK,FK
}

EMPLEADO |o--o{ VEHICULO : "conducir"
EMPLEADO |o--o| EMPLEADO : "supervisar"
EMPLEADO ||--o{ ASIGNACION : "participar"
PROYECTO ||--o{ ASIGNACION : "incluir"</code></pre>
-->
            <p>Una vez generado el diagrama y analizado las relaciones y los tipos de los datos, ya estamos en
              disposición de crear el código DDL:</p>
            <div class="highlight">
              <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">supuesto_ddl_proyecto</span><span class="p">;</span><span class="w"> </span>
<span class="linenos" data-linenos=" 2 "></span><span class="n">USE</span><span class="w"> </span><span class="n">supuesto_ddl_proyecto</span><span class="p">;</span>
<span class="linenos" data-linenos=" 3 "></span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="n">ID</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">    </span><span class="n">NOMBRE</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="n">DNI</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">    </span><span class="n">JEFE</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="linenos" data-linenos=" 9 "></span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_EMPLEADO</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">ID</span><span class="p">),</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_EMPLEADO_JEFE</span><span class="w"> </span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">JEFE</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">NULL</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="linenos" data-linenos="16 "></span><span class="p">);</span>
<span class="linenos" data-linenos="17 "></span>
<span class="linenos" data-linenos="18 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">PROYECTO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="19 "></span><span class="w">    </span><span class="n">CODIGO</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="linenos" data-linenos="20 "></span><span class="w">    </span><span class="n">NOMBRE</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="linenos" data-linenos="21 "></span>
<span class="linenos" data-linenos="22 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_PROYECTO</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">CODIGO</span><span class="p">)</span>
<span class="linenos" data-linenos="23 "></span><span class="p">);</span>
<span class="linenos" data-linenos="24 "></span>
<span class="linenos" data-linenos="25 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">VEHICULO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="26 "></span><span class="w">    </span><span class="n">MATRICULA</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="linenos" data-linenos="27 "></span><span class="w">    </span><span class="n">MARCA</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="linenos" data-linenos="28 "></span><span class="w">    </span><span class="n">MODELO</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="linenos" data-linenos="29 "></span><span class="w">    </span><span class="n">PERSONA</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="linenos" data-linenos="30 "></span>
<span class="linenos" data-linenos="31 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_VEHICULO</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">MATRICULA</span><span class="p">),</span>
<span class="linenos" data-linenos="32 "></span>
<span class="linenos" data-linenos="33 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_VEHICULO_PERSONA</span><span class="w"> </span>
<span class="linenos" data-linenos="34 "></span><span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">PERSONA</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
<span class="linenos" data-linenos="35 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">NULL</span>
<span class="linenos" data-linenos="36 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="linenos" data-linenos="37 "></span><span class="p">);</span>
<span class="linenos" data-linenos="38 "></span>
<span class="linenos" data-linenos="39 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ASIGNACION</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="40 "></span><span class="w">    </span><span class="n">ID</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos="41 "></span><span class="w">    </span><span class="n">CODIGO</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos="42 "></span>
<span class="linenos" data-linenos="43 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_ASIGNACION</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">CODIGO</span><span class="p">),</span>
<span class="linenos" data-linenos="44 "></span>
<span class="linenos" data-linenos="45 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_ASIGNACION_EMPLEADO</span><span class="w"> </span>
<span class="linenos" data-linenos="46 "></span><span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
<span class="linenos" data-linenos="47 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="linenos" data-linenos="48 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span>
<span class="linenos" data-linenos="49 "></span>
<span class="linenos" data-linenos="50 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_ASIGNACION_PROYECTO</span><span class="w"> </span>
<span class="linenos" data-linenos="51 "></span><span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">CODIGO</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">PROYECTO</span><span class="p">(</span><span class="n">CODIGO</span><span class="p">)</span>
<span class="linenos" data-linenos="52 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="linenos" data-linenos="53 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="linenos" data-linenos="54 "></span><span class="p">);</span>
</code></pre>
            </div>
            <p>Una vez tenemos el DDL, procedemos a realizar las operaciones solicitadas:</p>
            <ol>
              <li>
                <p>Elimina la columna <code>MODELO</code> de la tabla <code>VEHICULO</code>.</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">VEHICULO</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">MODELO</span><span class="p">;</span>
</code></pre>
                </div>
              </li>
              <li>
                <p>Añade una columna a <code>VEHICULO</code> que se llame COLOR que acepte los valores
                  <code>Blanco</code>, <code>Negro</code> o <code>Otro</code>.
                </p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">VEHICULO</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">COLOR</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;Blanco&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Negro&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Otro&#39;</span><span class="p">);</span>
</code></pre>
                </div>
              </li>
              <li>
                <p>Añade una columna a <code>VEHICULO</code> que se llame precio que almacene el precio del vehículo, el
                  cual siempre debe ser superior a 1000€.</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">VEHICULO</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">PRECIO</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="linenos" data-linenos="2 "></span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">CHK_PRECIO_MINIMO</span><span class="w"> </span><span class="k">CHECK</span><span class="w"> </span><span class="p">(</span><span class="n">PRECIO</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1000</span><span class="p">);</span>
</code></pre>
                </div>
              </li>
              <li>
                <p>Vacía la tabla <code>VEHICULO</code></p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">VEHICULO</span><span class="p">;</span>
</code></pre>
                </div>
              </li>
              <li>
                <p>Elimina la tabla <code>VEHICULO</code>.</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">VEHICULO</span><span class="p">;</span>
</code></pre>
                </div>
              </li>
            </ol>
          </details>
          <h2 id="cargando-datos">Cargando datos<a class="headerlink" href="05ddl.html#cargando-datos"
              title="Permanent link">&para;</a></h2>
          <p>A la hora de cargar datos en una base de datos, además de las operaciones de inserción individual o
            múltiple de registros, todos los SGBD incorporan herramientas para la importación tanto de datos como
            recuperación de copias de seguridad que nos sirven para tener un entorno listo para trabajar.</p>
          <h3 id="ejecutando-un-script">Ejecutando un script<a class="headerlink" href="05ddl.html#ejecutando-un-script"
              title="Permanent link">&para;</a></h3>
          <p>Si ya tenemos un <em>script</em>, por ejemplo, con las sentencias <code>CREATE TABLE</code> definidas o
            diferentes instrucciones que insertan o modifican datos, mediante la línea de comandos podemos ejecutarlas a
            través de la entrada estándar (<strong><code>&lt;</code></strong>) o haciendo uso de parámetros:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span>mariadb<span class="w"> </span>-u<span class="w"> </span>usuario<span class="w"> </span>-p<span class="w"> </span>nombre_de_base_de_datos<span class="w"> </span>&lt;<span class="w"> </span>archivo.sql
<span class="linenos" data-linenos="2 "></span>psql<span class="w"> </span>-U<span class="w"> </span>usuario<span class="w"> </span>-d<span class="w"> </span>nombre_de_base_de_datos<span class="w"> </span>&lt;<span class="w"> </span>archivo.sql
<span class="linenos" data-linenos="3 "></span>psql<span class="w"> </span>-U<span class="w"> </span>usuario<span class="w"> </span>-d<span class="w"> </span>nombre_de_base_de_datos<span class="w"> </span>-f<span class="w"> </span>archivo.sql
</code></pre>
          </div>
          <p>Si en cambio lo queremos hacer dentro de cada cliente (una vez nos hemos autenticado con el usuario y
            contraseña):</p>
          <div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1"
              name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" />
            <div class="tabbed-labels"><label for="__tabbed_9_1">MariaDB</label><label
                for="__tabbed_9_2">PostgreSQL</label></div>
            <div class="tabbed-content">
              <div class="tabbed-block">
                <p>En <em>MariaDB</em> usaremos el comando <a
                    href="https://mariadb.com/kb/en/mariadb-command-line-client/">source</a>:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">source</span><span class="w"> </span><span class="n">archivo</span><span class="p">.</span><span class="k">sql</span>
</code></pre>
                </div>
              </div>
              <div class="tabbed-block">
                <p>En <em>PostgreSQL</em> usaremos el metacomando <a
                    href="https://www.postgresql.org/docs/current/app-psql.html#APP-PSQL-META-COMMAND-INCLUDE">\i</a> o
                  <code>\include</code>:
                </p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="err">\</span><span class="n">i</span><span class="w"> </span><span class="n">archivo</span><span class="p">.</span><span class="k">sql</span>
<span class="linenos" data-linenos="2 "></span><span class="err">\</span><span class="n">include</span><span class="w"> </span><span class="n">archivo</span><span class="p">.</span><span class="k">sql</span>
</code></pre>
                </div>
              </div>
            </div>
          </div>
          <h3 id="cargando-datos-desde-archivos">Cargando datos desde archivos<a class="headerlink"
              href="05ddl.html#cargando-datos-desde-archivos" title="Permanent link">&para;</a></h3>
          <p>Si en vez de un <em>script</em> tenemos los datos a cargar y ya tenemos nuestra estructura de datos creada
            (y probablemente con datos ya existentes), tenemos otras posibilidades:</p>
          <div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1"
              name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" />
            <div class="tabbed-labels"><label for="__tabbed_10_1">MariaDB</label><label
                for="__tabbed_10_2">PostgreSQL</label></div>
            <div class="tabbed-content">
              <div class="tabbed-block">
                <p>En <em>MariaDB</em> usaremos la herramienta <a
                    href="https://mariadb.com/kb/en/mariadb-import/">mariadb-import</a> que permite cargar datos en
                  formato texto, csv, etc...:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">mariadb</span><span class="o">-</span><span class="n">import</span><span class="w"> </span><span class="c1">--local -u usuario -p nombre_de_base_de_datos /ruta/al/archivo.csv</span>
</code></pre>
                </div>
                <p>Otra forma es hacer uso de datos almacenados en ficheros de texto y cargarlos directamente en una
                  tabla es utilizar el comando <a
                    href="https://mariadb.com/kb/en/load-data-infile"><code>LOAD DATA INFILE</code></a>:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">LOAD</span><span class="w"> </span><span class="k">DATA</span><span class="w"> </span><span class="n">INFILE</span><span class="w"> </span><span class="s1">&#39;/ruta/al/archivo.csv&#39;</span><span class="w"> </span>
<span class="linenos" data-linenos="2 "></span><span class="k">INTO</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">empleados</span>
<span class="linenos" data-linenos="3 "></span><span class="n">FIELDS</span><span class="w"> </span><span class="n">TERMINATED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;,&#39;</span><span class="w"> </span><span class="c1">-- Separador de campos (coma)</span>
<span class="linenos" data-linenos="4 "></span><span class="n">LINES</span><span class="w"> </span><span class="n">TERMINATED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;\n&#39;</span><span class="w">  </span><span class="c1">-- Fin de línea</span>
<span class="linenos" data-linenos="5 "></span><span class="k">IGNORE</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">LINES</span><span class="w">            </span><span class="c1">-- Ignora la primera línea (encabezados)</span>
<span class="linenos" data-linenos="6 "></span><span class="p">(</span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">puesto</span><span class="p">,</span><span class="w"> </span><span class="n">salario</span><span class="p">);</span><span class="w"> </span><span class="c1">-- Especifica las columnas</span>
</code></pre>
                </div>
                <p>Esta opción es mucho más eficiente que ejecutar múltiples sentencias <code>INSERT</code>.</p>
                <p>En cambio, para exportar los datos, podemos crear un volcado de la base de datos mediante <a
                    href="https://mariadb.com/kb/en/mariadb-dump/">mariadb-dump</a>:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span>mariadb-dump<span class="w"> </span>-u<span class="w"> </span>usuario<span class="w"> </span>-p<span class="w"> </span>nombre_de_base_de_datos<span class="w"> </span>&gt;<span class="w"> </span>dump.sql
<span class="linenos" data-linenos="2 "></span>mariadb-dump<span class="w"> </span>-u<span class="w"> </span>usuario<span class="w"> </span>-p<span class="w"> </span>--all-databases<span class="w"> </span>&gt;<span class="w"> </span>dump.sql
</code></pre>
                </div>
              </div>
              <div class="tabbed-block">
                <p>Usaremos las herramientas <a
                    href="https://www.postgresql.org/docs/current/app-pgdump.html">pg_dump</a> y <a
                    href="https://www.postgresql.org/docs/current/app-pgrestore.html">pg_restore</a> para,
                  respectivamente, extraer a un archivo y restaurar los datos de una base de datos.</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span>pg_dump<span class="w"> </span>-Fc<span class="w"> </span>mydb<span class="w"> </span>&gt;<span class="w"> </span>db.dump
</code></pre>
                </div>
                <p>Si queremos exportar todas las bases de datos, usaremos el comando <a
                    href="https://www.postgresql.org/docs/current/app-pg-dumpall.html">pg-dumpall</a>:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span>pg_dumpall<span class="w"> </span>&gt;<span class="w"> </span>db.out
</code></pre>
                </div>
                <p>Para restaurarlas todas haríamos:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span>psql<span class="w"> </span>-f<span class="w"> </span>db.out<span class="w"> </span>postgres
</code></pre>
                </div>
              </div>
            </div>
          </div>
          <div class="admonition info">
            <p class="admonition-title">Importando datos en binario</p>
            <p>Para un administrador de bases de datos, es muy común cargar datos a partir de una copia de seguridad.
              Para ello, dependiendo del SGBD, utilizaremos una herramienta u otra.</p>
            <div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1"
                name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" />
              <div class="tabbed-labels"><label for="__tabbed_11_1">MariaDB</label><label
                  for="__tabbed_11_2">PostgreSQL</label></div>
              <div class="tabbed-content">
                <div class="tabbed-block">
                  <p>Usaremos la herramienta <a href="https://mariadb.com/kb/en/mariabackup-overview/">mariabackup</a>,
                    la cual es una herramienta de <em>MariaDB</em> para crear copias de seguridad físicas (binarias) de
                    las bases de datos.</p>
                  <p>Para restaurar una copia de seguridad haremos:</p>
                  <div class="highlight">
                    <pre><span></span><code><span class="linenos" data-linenos="1 "></span>mariabackup<span class="w"> </span>--copy-back<span class="w"> </span>--target-dir<span class="o">=</span>/ruta/a/la/copia_de_seguridad
</code></pre>
                  </div>
                  <p>Y para realizar la copia de seguridad:</p>
                  <div class="highlight">
                    <pre><span></span><code><span class="linenos" data-linenos="1 "></span>mariabackup<span class="w"> </span>--prepare<span class="w"> </span>--target-dir<span class="o">=</span>/ruta/a/la/copia_de_seguridad
</code></pre>
                  </div>
                </div>
                <div class="tabbed-block">
                  <p>La herramienta <a
                      href="https://www.postgresql.org/docs/current/app-pgbasebackup.html">pg_basebackup</a> permite
                    crear copias de seguridad en <em>PostgreSQL</em></p>
                  <p>Para crear la copia de seguridad haremos:</p>
                  <div class="highlight">
                    <pre><span></span><code><span class="linenos" data-linenos="1 "></span>pg_basebackup<span class="w"> </span>-D<span class="w"> </span>/ruta/destino<span class="w"> </span>-Fp<span class="w"> </span>-Xs<span class="w"> </span>-P<span class="w"> </span>-U<span class="w"> </span>usuario
</code></pre>
                  </div>
                  <p>Para restaurar los datos, hemos de copiar los archivos del <em>backup</em> a la ruta del directorio
                    de datos y reiniciar el servicio (tareas normalmente realizadas por perfiles más cercanos a la
                    administración de sistemas que a un desarrollador).</p>
                </div>
              </div>
            </div>
          </div>
          <h2 id="dml">DML<a class="headerlink" href="05ddl.html#dml" title="Permanent link">&para;</a></h2>
          <p>Una vez que ya sabemos cómo crear las estructuras de datos para guardar la información, vamos a aprender a
            gestionarla.</p>
          <div class="admonition tip inline end">
            <p class="admonition-title">CRUD</p>
            <p>Las operaciones DML se asocian al acrónimo CRUD:</p>
            <ul>
              <li><strong><em>C</em></strong><em>reate</em>: insertar</li>
              <li><strong><em>R</em></strong><em>ead</em>: consultar</li>
              <li><strong><em>U</em></strong><em>pdate</em>: modificar</li>
              <li><strong><em>D</em></strong><em>elete</em>: eliminar</li>
            </ul>
          </div>
          <p>Sobre una tabla, las operaciones que vamos a poder realizar son:</p>
          <ul>
            <li>insertar datos en una tabla</li>
            <li>modificar datos de una tabla</li>
            <li>eliminar datos de una tabla</li>
            <li>consultar datos de una o más tablas.</li>
          </ul>
          <p>Cuando hablamos de "datos de una tabla", podemos referirnos a registros completos, campos concretos o
            incluso elementos relacionados de varias tablas.</p>
          <p>Para realizar estas operaciones, se utiliza el subconjunto DML (<em>Data Manipulation Language</em>) de
            SQL. En esta unidad nos vamos a centrar en la inserción, modificación y eliminación de datos, dejando las
            consultas para trabajarlas en profundidad en las siguientes unidades.</p>
          <p>Para los siguientes ejemplos vamos a trabajar con la siguiente tabla:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">dml8a</span><span class="w"> </span><span class="p">(</span><span class="w"> </span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">nombre</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="ss">&quot;Chuck Norris&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">));</span>
</code></pre>
          </div>
          <h3 id="inserciones">Inserciones<a class="headerlink" href="05ddl.html#inserciones"
              title="Permanent link">&para;</a></h3>
          <p>La sentencia para insertar datos es <code>INSERT INTO</code>, tanto en <a
              href="https://mariadb.com/kb/en/insert">MariaDB</a> como en <a
              href="https://www.postgresql.org/docs/current/sql-insert.html">PostgreSQL</a>:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">tabla</span><span class="p">(</span><span class="n">col1</span><span class="p">,</span><span class="w"> </span><span class="n">col2</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="n">valor1</span><span class="p">,</span><span class="w"> </span><span class="n">valor2</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
</code></pre>
          </div>
          <p>A la hora de indicar la tabla, podemos omitir el nombre de las columnas, lo que implicará que deberemos
            indicar los valores para todas las columnas de la tabla. Si en cambio sólo queremos insertar valores en
            algunas columnas, hemos de indicarlas de forma explícita al lado del nombre de la tabla.</p>
          <p>Veamos unos ejemplos. Podemos insertar en la tabla <code>dml8a</code> utilizando:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">dml8a</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Aitor Medrano&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;a.medrano@edu.gva.es&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">dml8a</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">nombre</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Pedro Casas&quot;</span><span class="p">);</span>
</code></pre>
          </div>
          <p>Es decir, si no ponemos los nombres de los campos detrás del nombre de la tabla, en los valores deberemos
            introducir todos los valores siguiendo el orden de los campos según fueron creados (siempre puedes consultar
            la estructura de una tabla mediante <code>DESCRIBE nombre_tabla</code>). Además, los tipos de los datos
            deben concordar, incluso en el tamaño o precisión, debiendo haber una correspondencia posicional uno a uno
            entre las columnas y los valores introducidos.</p>
          <p>Si queremos insertar varios registros con una única instrucción, los indicaremos separados por comas:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">dml8a</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;María Sánchez&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;maria@gmail.com&quot;</span><span class="p">),</span>
<span class="linenos" data-linenos="2 "></span><span class="w">                         </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Eva Amaral&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;eva@gmail.com&quot;</span><span class="p">);</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">-- Query OK, 2 rows affected (0.002 sec)</span>
<span class="linenos" data-linenos="4 "></span><span class="c1">-- Records: 2  Duplicates: 0  Warnings: 0</span>
</code></pre>
          </div>
          <p>Cuando trabajamos con claves subrogadas, como es el caso de <code>id</code> que es un campo auto
            incrementable, podemos omitir su valor, y automáticamente se le asignará el siguiente valor de la secuencia:
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">dml8a</span><span class="p">(</span><span class="n">nombre</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;José Manuel Pérez&quot;</span><span class="p">);</span>
</code></pre>
          </div>
          <p>Cuando insertarmos un registro en una tabla autoincrementable, podemos recuperar el valor creado mediante
            la función <a
              href="https://mariadb.com/docs/server/reference/sql-functions/secondary-functions/information-functions/last_insert_id"><code>LAST_INSERT_ID()</code></a>.
            En el bloque de programación mediante PL/SQL profundizaremos en su uso:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">LAST_INSERT_ID</span><span class="p">();</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">-- +------------------+</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">-- | LAST_INSERT_ID() |</span>
<span class="linenos" data-linenos="4 "></span><span class="c1">-- +------------------+</span>
<span class="linenos" data-linenos="5 "></span><span class="c1">-- |                5 |</span>
<span class="linenos" data-linenos="6 "></span><span class="c1">-- +------------------+</span>
<span class="linenos" data-linenos="7 "></span><span class="c1">-- 1 row in set (0.001 sec)</span>
</code></pre>
          </div>
          <p>En el caso de <em>PostgreSQL</em>, si queremos recuperar la información sobre la fila recién insertada,
            podemos emplear la cláusula <a
              href="https://www.postgresql.org/docs/current/dml-returning.html"><code>RETURNING</code></a>:</p>
          <div class="highlight"><span class="filename">PostgreSQL</span>
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">dml8a</span><span class="w"> </span><span class="p">(</span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">)</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;David Suárez&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;david@gmail.com&quot;</span><span class="p">)</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">RETURNING</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Finalmente, si queremos insertar los valores por defectos asociados a una columna o un valor nulo (por
            ejemplo, a una clave ajena) usaremos <code>DEFAULT</code> y <code>NULL</code> respectivamente. Por ejemplo:
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">dml8a</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">66</span><span class="p">,</span><span class="w"> </span><span class="k">DEFAULT</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">dml8a</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="mi">66</span><span class="p">;</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">-- +----+--------------+-------+</span>
<span class="linenos" data-linenos="4 "></span><span class="c1">-- | id | nombre       | email |</span>
<span class="linenos" data-linenos="5 "></span><span class="c1">-- +----+--------------+-------+</span>
<span class="linenos" data-linenos="6 "></span><span class="c1">-- | 66 | Chuck Norris | NULL  |</span>
<span class="linenos" data-linenos="7 "></span><span class="c1">-- +----+--------------+-------+</span>
<span class="linenos" data-linenos="8 "></span><span class="c1">-- 1 row in set (0.003 sec)</span>
</code></pre>
          </div>
          <h4 id="supuesto-dml">Supuesto DML<a class="headerlink" href="05ddl.html#supuesto-dml"
              title="Permanent link">&para;</a></h4>
          <p>A partir del <a href="05ddl.html#supuesto-ddl">Supuesto DDL</a>, vamos a insertar los datos de las tablas
            para rellenar la base de datos (pero sin aplicar las modificaciones <code>ALTER TABLE</code>, trabajaremos
            directamente sobre el <em>script</em> de <code>CREATE TABLE</code>).</p>
          <p>Para ello, es importante respetar las dependencias de las claves ajenas para primero insertar las tablas
            que no tienen dependencias. Por esta razón, primero insertaremos los datos en <code>PROYECTO</code> y luego
            en <code>EMPLEADO</code>, para posteriomente las tablas <code>VEHICULO</code> y <code>ASIGNACION</code> que
            dependen de las anteriores. Si no respetamos el orden, y por ejemplo, insertaramos los vehículos antes que
            los empleados, al hacerlo, obtendríamos diversos errores de integridad referencial.</p>
          <p>Así pues, los comandos SQL necesarios son:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">PROYECTO</span><span class="w"> </span><span class="p">(</span><span class="n">CODIGO</span><span class="p">,</span><span class="w"> </span><span class="n">NOMBRE</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span>
<span class="linenos" data-linenos=" 2 "></span><span class="p">(</span><span class="s1">&#39;101&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GRIS&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos=" 3 "></span><span class="p">(</span><span class="s1">&#39;102&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;BLANCO&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos=" 4 "></span><span class="p">(</span><span class="s1">&#39;103&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;NEGRO&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos=" 5 "></span><span class="p">(</span><span class="s1">&#39;104&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;VERDE&#39;</span><span class="p">);</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">NOMBRE</span><span class="p">,</span><span class="w"> </span><span class="n">DNI</span><span class="p">,</span><span class="w"> </span><span class="n">JEFE</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span>
<span class="linenos" data-linenos=" 8 "></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ANA MARTIN&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1111A&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">),</span>
<span class="linenos" data-linenos=" 9 "></span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;JUAN LOPEZ&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2222B&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span>
<span class="linenos" data-linenos="10 "></span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CARMEN DIAZ&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;3333C&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span>
<span class="linenos" data-linenos="11 "></span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ERNESTO GOMEZ&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;4444D&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">),</span>
<span class="linenos" data-linenos="12 "></span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SILVIA GONZALEZ&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;5555E&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">),</span>
<span class="linenos" data-linenos="13 "></span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;FERNANDO SIERRA&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;7777F&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">);</span>
<span class="linenos" data-linenos="14 "></span>
<span class="linenos" data-linenos="15 "></span><span class="c1">-- VEHICULO referencia a EMPLEADO</span>
<span class="linenos" data-linenos="16 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">VEHICULO</span><span class="w"> </span><span class="p">(</span><span class="n">MATRICULA</span><span class="p">,</span><span class="w"> </span><span class="n">MARCA</span><span class="p">,</span><span class="w"> </span><span class="n">MODELO</span><span class="p">,</span><span class="w"> </span><span class="n">PERSONA</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span>
<span class="linenos" data-linenos="17 "></span><span class="p">(</span><span class="s1">&#39;2345AAA&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Seat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Altea&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">),</span>
<span class="linenos" data-linenos="18 "></span><span class="p">(</span><span class="s1">&#39;1234BBB&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Opel&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Astra&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">),</span>
<span class="linenos" data-linenos="19 "></span><span class="p">(</span><span class="s1">&#39;5555CCC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Seat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Ibiza&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">),</span>
<span class="linenos" data-linenos="20 "></span><span class="p">(</span><span class="s1">&#39;9876DDD&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Lexus&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;LC&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span>
<span class="linenos" data-linenos="21 "></span><span class="p">(</span><span class="s1">&#39;1111FFF&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Seat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Ibiza&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">),</span>
<span class="linenos" data-linenos="22 "></span><span class="p">(</span><span class="s1">&#39;2222GGG&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Opel&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Astra&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">);</span>
<span class="linenos" data-linenos="23 "></span>
<span class="linenos" data-linenos="24 "></span><span class="c1">-- ASIGNACION referencia tanto a EMPLEADO como a PROYECTO</span>
<span class="linenos" data-linenos="25 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">ASIGNACION</span><span class="w"> </span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">CODIGO</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span>
<span class="linenos" data-linenos="26 "></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;101&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="27 "></span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;101&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="28 "></span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;101&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="29 "></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;102&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="30 "></span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;102&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="31 "></span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;102&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="32 "></span><span class="p">(</span><span class="mi">35</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;102&#39;</span><span class="p">),</span>
<span class="linenos" data-linenos="33 "></span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;103&#39;</span><span class="p">);</span>
</code></pre>
          </div>
          <p>¿Y si quiero insertar dos empleados, de manera que el primero sea el jefe del segundo, pero para ninguno de
            ellos quiero asignarle su código de manera explicita, ya que lo debe autogenerar el SGBD?</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="c1">-- Insertamos el primer empleado</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="p">(</span><span class="n">NOMBRE</span><span class="p">,</span><span class="w"> </span><span class="n">DNI</span><span class="p">,</span><span class="w"> </span><span class="n">JEFE</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;Empleado Nuevo 1&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;8888G&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="linenos" data-linenos=" 3 "></span><span class="c1">-- Al segundo empleado le asignamos como jefe el identificador de la última inserción</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="p">(</span><span class="n">NOMBRE</span><span class="p">,</span><span class="w"> </span><span class="n">DNI</span><span class="p">,</span><span class="w"> </span><span class="n">JEFE</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;Empleado Nuevo 2&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;9999G&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">LAST_INSERT_ID</span><span class="p">());</span>
<span class="linenos" data-linenos=" 5 "></span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">-- Comprobamos los resultados</span>
<span class="linenos" data-linenos=" 7 "></span><span class="c1">-- (recuperamos los empleados con un identificador superior al último que habíamos insertado)</span>
<span class="linenos" data-linenos=" 8 "></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">35</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="c1">-- +----+------------------+-------+------+</span>
<span class="linenos" data-linenos="10 "></span><span class="c1">-- | ID | NOMBRE           | DNI   | JEFE |</span>
<span class="linenos" data-linenos="11 "></span><span class="c1">-- +----+------------------+-------+------+</span>
<span class="linenos" data-linenos="12 "></span><span class="c1">-- | 36 | Empleado Nuevo 1 | 8888G |   10 |</span>
<span class="linenos" data-linenos="13 "></span><span class="c1">-- | 37 | Empleado Nuevo 2 | 9999G |   36 |</span>
<span class="linenos" data-linenos="14 "></span><span class="c1">-- +----+------------------+-------+------+</span>
</code></pre>
          </div>
          <div class="admonition danger">
            <p class="admonition-title">Gestión de errores</p>
            <p>Si insertamos datos con tipos diferentes, dejamos campos no nulos en blanco, o insertamos datos en un
              campo que es clave ajena y no cumplimos la integridad referencial, el SGBD nos devolverá diferentes
              mensajes:</p>
            <div class="highlight">
              <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;cuarenta&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Empleado con errores&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;1234&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">-- ERROR 1366 (22007): Incorrect integer value: &#39;cuarenta&#39; for column `pruebas`.`EMPLEADO`.`ID` at row 1</span>
</code></pre>
            </div>
            <p>En cambio, si ejecutamos <code
                class="highlight"><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;JUAN PALOMO&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1234</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">);</span></code>
              no dará error porque convertirá el número <code>1234</code> a un <code>string</code> antes de insertarlo.
            </p>
            <p>¿Y qué sucede si insertamos un dato que no cumple la integridad referencial en una clave ajena? Al
              intentar insertar un empleado que apunte a otro que no existe, obtendrémos un error de fallo de la
              restricción de la clave ajena:</p>
            <div class="highlight">
              <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;Empleado con error en integridad referencial&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;5678&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">-- ERROR 1452 (23000): Cannot add or update a child row: a foreign key constraint fails </span>
<span class="linenos" data-linenos="3 "></span><span class="c1">-- (`pruebas`.`EMPLEADO`, CONSTRAINT `FK_EMPLEADO_JEFE` FOREIGN KEY (`JEFE`) REFERENCES `EMPLEADO` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE)</span>
</code></pre>
            </div>
          </div>
          <p>También podemos insertar datos con el resultado de una consulta mediante la instrucción <a
              href="https://mariadb.com/kb/en/insert-select/"><code>INSERT SELECT</code></a>, pero esta operación la
            estudiaremos en profundidad más adelante.</p>
          <h3 id="modificaciones">Modificaciones<a class="headerlink" href="05ddl.html#modificaciones"
              title="Permanent link">&para;</a></h3>
          <p>La sentencia para actualizar datos es <code>UPDATE ... SET</code>, tanto en <a
              href="https://mariadb.com/kb/en/update">MariaDB</a> como en <a
              href="https://www.postgresql.org/docs/current/sql-update.html">PostgreSQL</a>:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">campo</span><span class="o">=</span><span class="n">valor1</span><span class="w"> </span><span class="p">[,</span><span class="n">campo2</span><span class="o">=</span><span class="n">valor2</span><span class="p">];</span>
</code></pre>
          </div>
          <p>Si queremos decidir qué elementos modificar, añadimos la expresión <code>WHERE</code>, ya que, si no,
            actualizaremos todos los registros de la tabla:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">campo</span><span class="o">=</span><span class="n">valor</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">condicion</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Veamos unos ejemplos. Podemos modificar el email de un usuario concreto:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">dml8a</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">email</span><span class="o">=</span><span class="ss">&quot;pedro@gmail.com&quot;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="mi">2</span>
</code></pre>
          </div>
          <p>O modificar varios campos de una sola vez:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">dml8a</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">nombre</span><span class="o">=</span><span class="ss">&quot;Pedro Casas García&quot;</span><span class="p">,</span>
<span class="linenos" data-linenos="2 "></span><span class="w">                 </span><span class="n">email</span><span class="o">=</span><span class="ss">&quot;pedro.casas@gmail.com&quot;</span>
<span class="linenos" data-linenos="3 "></span><span class="w">             </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="mi">2</span>
</code></pre>
          </div>
          <p>También podemos realizar cálculos al modificar un campo:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="c1">-- Incrementamos la población de Elche en un 10%</span>
<span class="linenos" data-linenos="2 "></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">CIUDAD</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">poblacion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">poblacion</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">10</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Elche&quot;</span><span class="p">;</span>
</code></pre>
          </div>
          <p>El filtrado de los datos mediante la instrucción <code>WHERE</code> ofrece múltiples posibilidades, tanto
            con operadores relacionales, aritméticos, funciones de tratamiento de textos, fechas, etc... como
            comparación con el resultado de una consulta u operaciones de conjuntos. A partir de la próxima unidad
            profundizaremos en todas las alternativas del atributo <code>WHERE</code>.</p>
          <h3 id="borrados">Borrados<a class="headerlink" href="05ddl.html#borrados" title="Permanent link">&para;</a>
          </h3>
          <div class="admonition tip inline end">
            <p class="admonition-title">No te olvides...</p>
            <p>Si no conoces este meme, hazte el favor y mira el siguiente <a
                href="https://youtu.be/i_cVJgIz_Cs?si=MPgAHrZyaWcfH4On">vídeo</a>.</p>
            <p>
            <figure style="align: center;">
              <img src="../images/05no-te-olvides.png" width="200" title="Hice un delete...">
              <figcaption>Hice un delete...</figcaption>
            </figure>
            </p>
          </div>
          <p>La sentencia para borrar datos es <code>DELETE FROM ...</code>, tanto en <a
              href="https://mariadb.com/kb/en/delete">MariaDB</a> como en <a
              href="https://www.postgresql.org/docs/current/sql-delete.html">PostgreSQL</a>:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">tabla</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Si queremos decidir qué elementos eliminar, añadimos la expresión <code>WHERE</code>, ya que si no,
            eliminaremos todos los registros de la tabla, lo cual es muy peligroso:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">condicion</span><span class="p">;</span>
</code></pre>
          </div>
          <p>Conviene destacar que, si queremos eliminar todos los datos de una tabla, es mucho más eficiente utilizar
            el comando <code>TRUNCATE TABLE</code>, tanto en <a
              href="https://mariadb.com/kb/en/truncate-table/">MariaDB</a> como en <a
              href="https://www.postgresql.org/docs/current/sql-truncate.html">PostgreSQL</a></p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">dml8a</span>
</code></pre>
          </div>
          <p>Por debajo, cuando truncamos una tabla, realmente está eliminando la tabla y volviéndola a crear,
            eliminando todos los ficheros de datos y reiniciando los campos autonuméricos.</p>
          <h3 id="operaciones-en-cascada">Operaciones en cascada<a class="headerlink"
              href="05ddl.html#operaciones-en-cascada" title="Permanent link">&para;</a></h3>
          <p>Recuerda que, si eliminamos un registro referenciado por una clave ajena, se ejecutará la regla descrita en
            la tabla de origen, de manera, que es posible que no podamos eliminar ciertos datos al estar referenciado
            desde otra tabla (si estaban configuradas con <code>NO ACTION</code> o <code>RESTRICT</code>).</p>
          <p>En cambio, si la clave ajena se configuró con <code>CASCADE</code>, al borrar el registro, se borrarán
            todos los registros de las tablas origen que referenciaban a éste.</p>
          <p>Finalmente, si se configuró con <code>NULL</code>, la tabla origen modificará el valor de su clave ajena se
            pondrá a nulo.</p>
          <p>Para demostrar su uso, nos vamos a basar en el <a href="05ddl.html#supuesto-ddl">Supuesto DDL</a> el cual
            define las siguiente tablas:</p>
          <figure style="align: center;">
            <img src="../images/05ddl-supuesto-proyecto.png" width="848" title="Supuesto DDL proyecto">
            <figcaption>Supuesto DDL Proyecto</figcaption>
          </figure>

          <p>Si nos fijamos en la tabla <code>ASIGNACION</code>, tenemos que su definición de claves tanto hacia
            <code>EMPLEADO</code> como a <code>PROYECTO</code> son siempre en cascada:
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ASIGNACION</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">ID</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">CODIGO</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_ASIGNACION</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">CODIGO</span><span class="p">),</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_ASIGNACION_EMPLEADO</span><span class="w"> </span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span>
<span class="linenos" data-linenos="11 "></span>
<span class="linenos" data-linenos="12 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_ASIGNACION_PROYECTO</span><span class="w"> </span>
<span class="linenos" data-linenos="13 "></span><span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">CODIGO</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">PROYECTO</span><span class="p">(</span><span class="n">CODIGO</span><span class="p">)</span>
<span class="linenos" data-linenos="14 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="linenos" data-linenos="15 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="linenos" data-linenos="16 "></span><span class="p">)</span>
</code></pre>
          </div>
          <p>¿Piensas que es una buena decisión que los borrados se propaguen en cascada? Pues va a depender de cada
            caso. Si borramos un <code>PROYECTO</code>, se entiende que debería eliminar todas las asignaciones que
            tiene. Pero, igual es una operación crítica la cual no queremos que sea tan fácil.</p>
          <p>Si revisamos los datos, teníamos que el proyecto <code>104</code> no tiene ningún proyecto asociado, pero
            sí el <code>103</code>. Al borrar el proyecto <code>103</code>, con la definición de las claves ajenas que
            hemos definido, se borrarán todas las asignaciones a dicho proyecto.</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">delete</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">PROYECTO</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">CODIGO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">103</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">ASIGNACION</span><span class="p">;</span>
<span class="linenos" data-linenos=" 4 "></span><span class="c1">-- +----+--------+</span>
<span class="linenos" data-linenos=" 5 "></span><span class="c1">-- | ID | CODIGO |</span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">-- +----+--------+</span>
<span class="linenos" data-linenos=" 7 "></span><span class="c1">-- | 10 | 101    |</span>
<span class="linenos" data-linenos=" 8 "></span><span class="c1">-- | 15 | 101    |</span>
<span class="linenos" data-linenos=" 9 "></span><span class="c1">-- | 20 | 101    |</span>
<span class="linenos" data-linenos="10 "></span><span class="c1">-- | 10 | 102    |</span>
<span class="linenos" data-linenos="11 "></span><span class="c1">-- | 15 | 102    |</span>
<span class="linenos" data-linenos="12 "></span><span class="c1">-- | 30 | 102    |</span>
<span class="linenos" data-linenos="13 "></span><span class="c1">-- | 35 | 102    |</span>
<span class="linenos" data-linenos="14 "></span><span class="c1">-- +----+--------+</span>
<span class="linenos" data-linenos="15 "></span><span class="c1">-- 7 rows in set (0.001 sec)</span>
</code></pre>
          </div>
          <p>A priori, parece una buena decisión, ya que si eliminamos un proyecto, tiene sentido liberar a los
            empleados de la asignación a dicho proyecto.</p>
          <p>Veamos un ejemplo más problemático. Si nos centramos en la tabla <code>EMPLEADO</code>, tenemos que hay una
            relación reflexiva para expresar si un empleado es jefe de otro empleado, pero en este caso, la clave ajena
            pone a nulos los valores eliminados (en vez de propagar el borrado):</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos=" 2 "></span><span class="w">    </span><span class="n">ID</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="linenos" data-linenos=" 3 "></span><span class="w">    </span><span class="n">NOMBRE</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos=" 4 "></span><span class="w">    </span><span class="n">DNI</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="n">JEFE</span><span class="w"> </span><span class="nb">INT</span><span class="p">,</span>
<span class="linenos" data-linenos=" 6 "></span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">PK_EMPLEADO</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">ID</span><span class="p">),</span>
<span class="linenos" data-linenos=" 8 "></span>
<span class="linenos" data-linenos=" 9 "></span><span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_EMPLEADO_JEFE</span><span class="w"> </span>
<span class="linenos" data-linenos="10 "></span><span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">JEFE</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
<span class="linenos" data-linenos="11 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="k">NULL</span>
<span class="linenos" data-linenos="12 "></span><span class="w">        </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="linenos" data-linenos="13 "></span><span class="p">);</span>
</code></pre>
          </div>
          <p>Por ejemplo, el empleado <code>25</code> tiene configurado al empleado <code>20</code> como su jefe, y a su
            vez, este al <code>10</code>.</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ID</span><span class="o">=</span><span class="mi">25</span><span class="p">;</span>
<span class="linenos" data-linenos=" 2 "></span><span class="c1">-- +----+---------------+-------+------+</span>
<span class="linenos" data-linenos=" 3 "></span><span class="c1">-- | ID | NOMBRE        | DNI   | JEFE |</span>
<span class="linenos" data-linenos=" 4 "></span><span class="c1">-- +----+---------------+-------+------+</span>
<span class="linenos" data-linenos=" 5 "></span><span class="c1">-- | 25 | ERNESTO GOMEZ | 4444D |   20 |</span>
<span class="linenos" data-linenos=" 6 "></span><span class="c1">-- +----+---------------+-------+------+</span>
<span class="linenos" data-linenos=" 7 "></span>
<span class="linenos" data-linenos=" 8 "></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ID</span><span class="o">=</span><span class="mi">20</span><span class="p">;</span>
<span class="linenos" data-linenos=" 9 "></span><span class="c1">-- +----+-------------+-------+------+</span>
<span class="linenos" data-linenos="10 "></span><span class="c1">-- | ID | NOMBRE      | DNI   | JEFE |</span>
<span class="linenos" data-linenos="11 "></span><span class="c1">-- +----+-------------+-------+------+</span>
<span class="linenos" data-linenos="12 "></span><span class="c1">-- | 20 | CARMEN DIAZ | 3333C |   10 |</span>
<span class="linenos" data-linenos="13 "></span><span class="c1">-- +----+-------------+-------+------+</span>
</code></pre>
          </div>
          <p>¿Qué sucederá si eliminamos al empleado <code>20</code>? Pues como la restricción de borrado está puesta a
            nulo, pondrá dicho valor en la clave ajena, indicando que aquellos empleados cuyo jefe era el empleado
            <code>20</code> se han quedado sin jefe, pero no se les ha eliminado a ellos.
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">delete</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="c1">-- +----+---------------+-------+------+</span>
<span class="linenos" data-linenos="5 "></span><span class="c1">-- | ID | NOMBRE        | DNI   | JEFE |</span>
<span class="linenos" data-linenos="6 "></span><span class="c1">-- +----+---------------+-------+------+</span>
<span class="linenos" data-linenos="7 "></span><span class="c1">-- | 25 | ERNESTO GOMEZ | 4444D | NULL |</span>
<span class="linenos" data-linenos="8 "></span><span class="c1">-- +----+---------------+-------+------+</span>
</code></pre>
          </div>
          <p>Si eliminamos la clave ajena y la volvemos a crear para que haga el borrado en cascada, y a continuación
            volvemos a insertar los datos</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">DROP</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_EMPLEADO_JEFE</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="n">FK_EMPLEADO_JEFE</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="n">JEFE</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="k">ON</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">;</span>
<span class="linenos" data-linenos="6 "></span>
<span class="linenos" data-linenos="7 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">NOMBRE</span><span class="p">,</span><span class="w"> </span><span class="n">DNI</span><span class="p">,</span><span class="w"> </span><span class="n">JEFE</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CARMEN DIAZ&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;3333C&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">);</span>
<span class="linenos" data-linenos="8 "></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">JEFE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="p">;</span>
</code></pre>
          </div>
          <p>¿Qué sucederá con el empleado <code>25</code> al eliminar al empleado <code>20</code>?</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">delete</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="c1">-- Empty set (0.001 sec)</span>
</code></pre>
          </div>
          <p>Como el borrado es en cascada, al borrar el empleado <code>20</code> también se elimina el <code>25</code>.
            Y si este fuera jefe de otro, se borrarían todos. Vamos a comprobarlo. Ahora en la tabla sólo nos quedan
            cuatro empleados:</p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="c1">-- +----+-----------------+-------+------+</span>
<span class="linenos" data-linenos="3 "></span><span class="c1">-- | ID | NOMBRE          | DNI   | JEFE |</span>
<span class="linenos" data-linenos="4 "></span><span class="c1">-- +----+-----------------+-------+------+</span>
<span class="linenos" data-linenos="5 "></span><span class="c1">-- | 10 | ANA MARTIN      | 1111A | NULL |</span>
<span class="linenos" data-linenos="6 "></span><span class="c1">-- | 15 | JUAN LOPEZ      | 2222B |   10 |</span>
<span class="linenos" data-linenos="7 "></span><span class="c1">-- | 30 | SILVIA GONZALEZ | 5555E |   15 |</span>
<span class="linenos" data-linenos="8 "></span><span class="c1">-- | 35 | FERNANDO SIERRA | 7777F |   15 |</span>
<span class="linenos" data-linenos="9 "></span><span class="c1">-- +----+-----------------+-------+------+</span>
</code></pre>
          </div>
          <p>Si borramos el empleado <code>10</code>, el cual es jefe del <code>15</code>, el cual es jefe del
            <code>30</code> y del <code>35</code>, ¡provocará un vaciado de todos los datos!
          </p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">delete</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">ID</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span>
<span class="linenos" data-linenos="3 "></span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="p">;</span>
<span class="linenos" data-linenos="4 "></span><span class="c1">-- Empty set (0.000 sec)</span>
</code></pre>
          </div>
          <h3 id="fusionando-datos">Fusionando datos<a class="headerlink" href="05ddl.html#fusionando-datos"
              title="Permanent link">&para;</a></h3>
          <p>En ocasiones, necesitamos fusionar datos de una tabla origen con los datos de otra (destino), facilitando
            la sincronización de tablas o la integración de datos externos. Para ello, desde <em>SQL2003</em> podemos
            emplear la sentencia <code>MERGE INTO</code>, también llamada <code>UPSERT</code> en algunos motores, la
            cual permite combinar en una sola instrucción varias operaciones de manipulación de datos, basándose en una
            condición de coincidencia entre una tabla origen y una tabla destino, y realizando:</p>
          <ul>
            <li><code>INSERT</code>: cuando un registro no existe en la tabla destino.</li>
            <li><code>UPDATE</code>: cuando sí existe y queremos modificarlo.</li>
            <li><code>DELETE</code> (opcional) → cuando se cumple cierta condición adicional.</li>
          </ul>
          <p>El problema es que <em>MariaDB</em> no la soporta. Mientras que <em>PostgreSQL</em> sí que tiene soporte
            completo para <a href="https://www.postgresql.org/docs/current/sql-merge.html"><code>MERGE INTO</code></a>,
            <em>MariaDB</em> ofrece la sentencia <a
              href="https://mariadb.com/docs/server/reference/sql-statements/data-manipulation/inserting-loading-data/insert-on-duplicate-key-update"><code>INSERT ON DUPLICATE KEY UPDATE</code></a>
            que, aunque menos potente, permite obtener un comportamiento similar.
          </p>
          <p>Su sintaxis es:</p>
          <div class="grid cards">
            <ul>
              <li>
                <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M23.157 4.412c-.676.284-.79.31-1.673.372-.65.045-.757.057-1.212.209-.75.246-1.395.75-2.02 1.59-.296.398-1.249 1.913-1.249 1.988 0 .057-.65.998-.915 1.32-.574.713-1.08 1.079-2.14 1.59-.77.36-1.224.524-4.102 1.477-1.073.353-2.133.738-2.367.864-.852.449-1.515 1.036-2.203 1.938-1.003 1.32-.972 1.313-3.042.947a12 12 0 0 0-.675-.063c-.644-.05-1.023.044-1.332.334L0 17.193l.177.088c.094.05.353.234.561.398.215.17.461.347.55.391.088.044.17.088.183.101s-.089.17-.228.353c-.435.581-.593.871-.574 1.048.019.164.032.17.43.17.517-.006.826-.056 1.261-.208.65-.233 2.058-.94 2.784-1.4.776-.5 1.717-.998 1.956-1.042.082-.02.354-.07.594-.114.58-.107 1.464-.095 2.587.05.108.013.373.045.6.064.227.025.43.057.454.076.026.012.474.037.998.056.934.026 1.104.007 1.3-.189.126-.133.385-.631.498-.985.209-.643.417-.921.366-.492-.113.966-.322 1.692-.713 2.411-.259.499-.663 1.092-.934 1.395-.322.347-.315.36.088.315.619-.063 1.471-.397 2.096-.82.827-.562 1.647-1.691 2.19-3.03.107-.27.22-.22.183.083-.013.094-.038.315-.057.498l-.031.328.353-.202c.833-.48 1.414-1.262 2.127-2.884.227-.518.877-2.922 1.073-3.976a10 10 0 0 1 .271-1.042c.127-.429.196-.555.48-.858.183-.19.625-.555.978-.808.72-.505.953-.75 1.187-1.205.208-.417.284-1.13.132-1.357-.132-.202-.284-.196-.763.006" />
                    </svg></span> <strong><em>MariaDB</em></strong></p>
                <p>En <em>MariaDB</em> usaremos <a
                    href="https://mariadb.com/docs/server/reference/sql-statements/data-manipulation/inserting-loading-data/insert-on-duplicate-key-update"><code>INSERT ON DUPLICATE KEY UPDATE</code></a>,
                  ya sea mediante <code>INSERT VALUES</code>:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">tabla_destino</span><span class="w"> </span><span class="p">(</span><span class="n">col1</span><span class="p">,</span><span class="w"> </span><span class="n">col2</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
<span class="linenos" data-linenos="2 "></span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="n">valor1</span><span class="p">,</span><span class="w"> </span><span class="n">valor2</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
<span class="linenos" data-linenos="3 "></span><span class="k">ON</span><span class="w"> </span><span class="n">DUPLICATE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="k">UPDATE</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">col2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valor2</span><span class="p">,</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="n">col3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valor3</span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="p">...;</span>
</code></pre>
                </div>
                <p>O <code>INSERT SELECT</code>:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">tabla_destino</span><span class="w"> </span><span class="p">(</span><span class="n">col1</span><span class="p">,</span><span class="w"> </span><span class="n">col2</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
<span class="linenos" data-linenos="2 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">colA</span><span class="p">,</span><span class="w"> </span><span class="n">colB</span><span class="p">,</span><span class="w"> </span><span class="p">...</span>
<span class="linenos" data-linenos="3 "></span><span class="k">ON</span><span class="w"> </span><span class="n">DUPLICATE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="k">UPDATE</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">col2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="n">colA</span><span class="p">),</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="n">col3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="n">colB</span><span class="p">),</span>
<span class="linenos" data-linenos="6 "></span><span class="w">    </span><span class="p">...;</span>
</code></pre>
                </div>
                <p>Funciona cuando la tabla tiene una clave única (<code>PRIMARY KEY</code> o <code>UNIQUE</code>), de
                  manera que si no existe, se inserta el nuevo registro, pero si existe (y colisiona en clave), entonces
                  ejecuta el <code>UPDATE</code>.</p>
              </li>
              <li>
                <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M23.56 14.723a.5.5 0 0 0-.057-.12q-.21-.395-1.007-.231c-1.654.34-2.294.13-2.526-.02 1.342-2.048 2.445-4.522 3.041-6.83.272-1.05.798-3.523.122-4.73a1.6 1.6 0 0 0-.15-.236C21.693.91 19.8.025 17.51.001c-1.495-.016-2.77.346-3.116.479a10 10 0 0 0-.516-.082 8 8 0 0 0-1.312-.127c-1.182-.019-2.203.264-3.05.84C8.66.79 4.729-.534 2.296 1.19.935 2.153.309 3.873.43 6.304c.041.818.507 3.334 1.243 5.744q.69 2.26 1.433 3.582.83 1.493 1.714 1.79c.448.148 1.133.143 1.858-.729a56 56 0 0 1 1.945-2.206c.435.235.906.362 1.39.377v.004a11 11 0 0 0-.247.305c-.339.43-.41.52-1.5.745-.31.064-1.134.233-1.146.811a.6.6 0 0 0 .091.327c.227.423.922.61 1.015.633 1.335.333 2.505.092 3.372-.679-.017 2.231.077 4.418.345 5.088.221.553.762 1.904 2.47 1.904q.375.001.829-.094c1.782-.382 2.556-1.17 2.855-2.906.15-.87.402-2.875.539-4.101.017-.07.036-.12.057-.136 0 0 .07-.048.427.03l.044.007.254.022.015.001c.847.039 1.911-.142 2.531-.43.644-.3 1.806-1.033 1.595-1.67M2.37 11.876c-.744-2.435-1.178-4.885-1.212-5.571-.109-2.172.417-3.683 1.562-4.493 1.837-1.299 4.84-.54 6.108-.13l-.01.01C6.795 3.734 6.843 7.226 6.85 7.44c0 .082.006.199.016.36.034.586.1 1.68-.074 2.918-.16 1.15.194 2.276.973 3.089q.12.126.252.237c-.347.371-1.1 1.193-1.903 2.158-.568.682-.96.551-1.088.508-.392-.13-.813-.587-1.239-1.322-.48-.839-.963-2.032-1.415-3.512m6.007 5.088a1.6 1.6 0 0 1-.432-.178c.089-.039.237-.09.483-.14 1.284-.265 1.482-.451 1.915-1 .099-.127.211-.27.367-.443a.4.4 0 0 0 .074-.13c.17-.151.272-.11.436-.042.156.065.308.26.37.475.03.102.062.295-.045.445-.904 1.266-2.222 1.25-3.168 1.013m2.094-3.988-.052.14c-.133.357-.257.689-.334 1.004-.667-.002-1.317-.288-1.81-.803-.628-.655-.913-1.566-.783-2.5.183-1.308.116-2.447.08-3.059l-.013-.22c.296-.262 1.666-.996 2.643-.772.446.102.718.406.83.928.585 2.704.078 3.83-.33 4.736a9 9 0 0 0-.23.546m7.364 4.572q-.024.266-.062.596l-.146.438a.4.4 0 0 0-.018.108c-.006.475-.054.649-.115.87-.064.229-.135.488-.18 1.057-.11 1.414-.878 2.227-2.417 2.556-1.515.325-1.784-.496-2.02-1.221a7 7 0 0 0-.078-.227c-.215-.586-.19-1.412-.157-2.555.016-.561-.025-1.901-.33-2.646q.006-.44.019-.892a.4.4 0 0 0-.016-.113 2 2 0 0 0-.044-.208c-.122-.428-.42-.786-.78-.935-.142-.059-.403-.167-.717-.087.067-.276.183-.587.309-.925l.053-.142c.06-.16.134-.325.213-.5.426-.948 1.01-2.246.376-5.178-.237-1.098-1.03-1.634-2.232-1.51-.72.075-1.38.366-1.709.532a6 6 0 0 0-.196.104c.092-1.106.439-3.174 1.736-4.482a4 4 0 0 1 .303-.276.35.35 0 0 0 .145-.064c.752-.57 1.695-.85 2.802-.833q.616.01 1.174.081c1.94.355 3.244 1.447 4.036 2.383.814.962 1.255 1.931 1.431 2.454-1.323-.134-2.223.127-2.68.78-.992 1.418.544 4.172 1.282 5.496.135.242.252.452.289.54.24.583.551.972.778 1.256.07.087.138.171.189.245-.4.116-1.12.383-1.055 1.717-.013.156-.043.447-.084.815-.046.208-.07.46-.1.766m.89-1.621c-.04-.832.27-.919.597-1.01l.135-.041a1 1 0 0 0 .134.103c.57.376 1.583.421 3.007.134-.202.177-.519.4-.953.601-.41.19-1.096.333-1.747.364-.72.034-1.086-.08-1.173-.151m.57-9.271c-.006.35-.054.669-.105 1.001-.055.358-.112.728-.127 1.177-.014.436.04.89.093 1.33.107.887.216 1.8-.207 2.701a4 4 0 0 1-.188-.385 8 8 0 0 0-.325-.617c-.616-1.104-2.057-3.69-1.32-4.744.38-.543 1.342-.566 2.179-.463m.228 7.013-.085-.107-.035-.044c.726-1.2.584-2.387.457-3.439-.052-.432-.1-.84-.088-1.222.013-.407.066-.755.118-1.092.064-.415.13-.844.111-1.35a.6.6 0 0 0 .012-.19c-.046-.486-.6-1.938-1.73-3.253a7.8 7.8 0 0 0-2.688-2.04A9.3 9.3 0 0 1 17.62.746c2.052.046 3.675.814 4.824 2.283a1 1 0 0 1 .067.1c.723 1.356-.276 6.275-2.987 10.54m-8.816-6.116c-.025.18-.31.423-.621.423a1 1 0 0 1-.081-.006.8.8 0 0 1-.506-.315c-.046-.06-.12-.178-.106-.285a.22.22 0 0 1 .093-.149c.118-.089.352-.122.61-.086.316.044.642.193.61.418m7.93-.411c.011.08-.049.2-.153.31a.72.72 0 0 1-.408.223 1 1 0 0 1-.075.005c-.293 0-.541-.234-.56-.371-.024-.177.264-.31.56-.352.298-.042.612.009.636.185" />
                    </svg></span> <strong><em>PostgreSQL</em></strong></p>
                <p>En <em>PostgreSQL</em> usaremos <a
                    href="https://www.postgresql.org/docs/current/sql-merge.html"><code>MERGE INTO</code></a>:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="n">MERGE</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">tabla_destino</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">destino</span>
<span class="linenos" data-linenos="2 "></span><span class="k">USING</span><span class="w"> </span><span class="n">tabla_origen</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">origen</span>
<span class="linenos" data-linenos="3 "></span><span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">condición_de_coincidencia</span><span class="p">)</span>
<span class="linenos" data-linenos="4 "></span><span class="k">WHEN</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">columna1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valor1</span><span class="p">,</span><span class="w"> </span><span class="n">columna2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valor2</span>
<span class="linenos" data-linenos="6 "></span><span class="k">WHEN</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos" data-linenos="7 "></span><span class="w">    </span><span class="k">INSERT</span><span class="w"> </span><span class="p">(</span><span class="n">columna1</span><span class="p">,</span><span class="w"> </span><span class="n">columna2</span><span class="p">,</span><span class="w"> </span><span class="p">...)</span>
<span class="linenos" data-linenos="8 "></span><span class="w">    </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="n">valor1</span><span class="p">,</span><span class="w"> </span><span class="n">valor2</span><span class="p">,</span><span class="w"> </span><span class="p">...);</span>
</code></pre>
                </div>
                <p>La sentencia <code>MERGE INTO</code>, además de poder añadir tantas claúsulas
                  <code>WHEN [NOT] MATCHED</code> como necesitemos, permite añadir condiciones dentro para refinar mejor
                  el comportamiento de la operación.
                </p>
                <p>Por ejemplo <code
                    class="highlight"><span class="k">WHEN</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">origen</span><span class="p">.</span><span class="n">precio</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span></code>
                  seleccionaría los registros que coincide la clave y cuyo precio es superior a 0.</p>
              </li>
            </ul>
          </div>
          <p>Vamos a realizar un ejemplo con ambos sistemas. Supongamos que tenemos una tabla con actualizaciones de
            empleados, los cuales debemos incorporar a nuestra tabla de <code>EMPLEADO</code></p>
          <div class="highlight">
            <pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">ACTUALIZACIONES_EMPLEADO</span><span class="w"> </span><span class="p">(</span>
<span class="linenos" data-linenos="2 "></span><span class="w">    </span><span class="n">ID</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span>
<span class="linenos" data-linenos="3 "></span><span class="w">    </span><span class="n">NOMBRE</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">DNI</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">UNIQUE</span><span class="p">,</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="n">JEFE</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span>
</code></pre>
          </div>
          <div class="grid cards">
            <ul>
              <li>
                <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M23.157 4.412c-.676.284-.79.31-1.673.372-.65.045-.757.057-1.212.209-.75.246-1.395.75-2.02 1.59-.296.398-1.249 1.913-1.249 1.988 0 .057-.65.998-.915 1.32-.574.713-1.08 1.079-2.14 1.59-.77.36-1.224.524-4.102 1.477-1.073.353-2.133.738-2.367.864-.852.449-1.515 1.036-2.203 1.938-1.003 1.32-.972 1.313-3.042.947a12 12 0 0 0-.675-.063c-.644-.05-1.023.044-1.332.334L0 17.193l.177.088c.094.05.353.234.561.398.215.17.461.347.55.391.088.044.17.088.183.101s-.089.17-.228.353c-.435.581-.593.871-.574 1.048.019.164.032.17.43.17.517-.006.826-.056 1.261-.208.65-.233 2.058-.94 2.784-1.4.776-.5 1.717-.998 1.956-1.042.082-.02.354-.07.594-.114.58-.107 1.464-.095 2.587.05.108.013.373.045.6.064.227.025.43.057.454.076.026.012.474.037.998.056.934.026 1.104.007 1.3-.189.126-.133.385-.631.498-.985.209-.643.417-.921.366-.492-.113.966-.322 1.692-.713 2.411-.259.499-.663 1.092-.934 1.395-.322.347-.315.36.088.315.619-.063 1.471-.397 2.096-.82.827-.562 1.647-1.691 2.19-3.03.107-.27.22-.22.183.083-.013.094-.038.315-.057.498l-.031.328.353-.202c.833-.48 1.414-1.262 2.127-2.884.227-.518.877-2.922 1.073-3.976a10 10 0 0 1 .271-1.042c.127-.429.196-.555.48-.858.183-.19.625-.555.978-.808.72-.505.953-.75 1.187-1.205.208-.417.284-1.13.132-1.357-.132-.202-.284-.196-.763.006" />
                    </svg></span> <strong><em>MariaDB</em></strong></p>
                <p>En <em>MariaDB</em> usaremos <code>INSERT SELECT ... ON DUPLICATE KEY UPDATE</code>:</p>
                <div class="highlight">
                  <pre><span></span><code><span class="hll"><span class="linenos" data-linenos="1 "></span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="p">(</span><span class="n">NOMBRE</span><span class="p">,</span><span class="w"> </span><span class="n">DNI</span><span class="p">,</span><span class="w"> </span><span class="n">JEFE</span><span class="p">)</span>
</span><span class="linenos" data-linenos="2 "></span><span class="k">SELECT</span><span class="w"> </span><span class="n">NOMBRE</span><span class="p">,</span><span class="w"> </span><span class="n">DNI</span><span class="p">,</span><span class="w"> </span><span class="n">JEFE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">ACTUALIZACIONES_EMPLEADO</span><span class="w"> </span><span class="n">origen</span>
<span class="hll"><span class="linenos" data-linenos="3 "></span><span class="k">ON</span><span class="w"> </span><span class="n">DUPLICATE</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span>
</span><span class="linenos" data-linenos="4 "></span><span class="w">    </span><span class="n">NOMBRE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="n">origen</span><span class="p">.</span><span class="n">NOMBRE</span><span class="p">),</span>
<span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="n">JEFE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">VALUES</span><span class="p">(</span><span class="n">origen</span><span class="p">.</span><span class="n">JEFE</span><span class="p">);</span>
</code></pre>
                </div>
              </li>
              <li>
                <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M23.56 14.723a.5.5 0 0 0-.057-.12q-.21-.395-1.007-.231c-1.654.34-2.294.13-2.526-.02 1.342-2.048 2.445-4.522 3.041-6.83.272-1.05.798-3.523.122-4.73a1.6 1.6 0 0 0-.15-.236C21.693.91 19.8.025 17.51.001c-1.495-.016-2.77.346-3.116.479a10 10 0 0 0-.516-.082 8 8 0 0 0-1.312-.127c-1.182-.019-2.203.264-3.05.84C8.66.79 4.729-.534 2.296 1.19.935 2.153.309 3.873.43 6.304c.041.818.507 3.334 1.243 5.744q.69 2.26 1.433 3.582.83 1.493 1.714 1.79c.448.148 1.133.143 1.858-.729a56 56 0 0 1 1.945-2.206c.435.235.906.362 1.39.377v.004a11 11 0 0 0-.247.305c-.339.43-.41.52-1.5.745-.31.064-1.134.233-1.146.811a.6.6 0 0 0 .091.327c.227.423.922.61 1.015.633 1.335.333 2.505.092 3.372-.679-.017 2.231.077 4.418.345 5.088.221.553.762 1.904 2.47 1.904q.375.001.829-.094c1.782-.382 2.556-1.17 2.855-2.906.15-.87.402-2.875.539-4.101.017-.07.036-.12.057-.136 0 0 .07-.048.427.03l.044.007.254.022.015.001c.847.039 1.911-.142 2.531-.43.644-.3 1.806-1.033 1.595-1.67M2.37 11.876c-.744-2.435-1.178-4.885-1.212-5.571-.109-2.172.417-3.683 1.562-4.493 1.837-1.299 4.84-.54 6.108-.13l-.01.01C6.795 3.734 6.843 7.226 6.85 7.44c0 .082.006.199.016.36.034.586.1 1.68-.074 2.918-.16 1.15.194 2.276.973 3.089q.12.126.252.237c-.347.371-1.1 1.193-1.903 2.158-.568.682-.96.551-1.088.508-.392-.13-.813-.587-1.239-1.322-.48-.839-.963-2.032-1.415-3.512m6.007 5.088a1.6 1.6 0 0 1-.432-.178c.089-.039.237-.09.483-.14 1.284-.265 1.482-.451 1.915-1 .099-.127.211-.27.367-.443a.4.4 0 0 0 .074-.13c.17-.151.272-.11.436-.042.156.065.308.26.37.475.03.102.062.295-.045.445-.904 1.266-2.222 1.25-3.168 1.013m2.094-3.988-.052.14c-.133.357-.257.689-.334 1.004-.667-.002-1.317-.288-1.81-.803-.628-.655-.913-1.566-.783-2.5.183-1.308.116-2.447.08-3.059l-.013-.22c.296-.262 1.666-.996 2.643-.772.446.102.718.406.83.928.585 2.704.078 3.83-.33 4.736a9 9 0 0 0-.23.546m7.364 4.572q-.024.266-.062.596l-.146.438a.4.4 0 0 0-.018.108c-.006.475-.054.649-.115.87-.064.229-.135.488-.18 1.057-.11 1.414-.878 2.227-2.417 2.556-1.515.325-1.784-.496-2.02-1.221a7 7 0 0 0-.078-.227c-.215-.586-.19-1.412-.157-2.555.016-.561-.025-1.901-.33-2.646q.006-.44.019-.892a.4.4 0 0 0-.016-.113 2 2 0 0 0-.044-.208c-.122-.428-.42-.786-.78-.935-.142-.059-.403-.167-.717-.087.067-.276.183-.587.309-.925l.053-.142c.06-.16.134-.325.213-.5.426-.948 1.01-2.246.376-5.178-.237-1.098-1.03-1.634-2.232-1.51-.72.075-1.38.366-1.709.532a6 6 0 0 0-.196.104c.092-1.106.439-3.174 1.736-4.482a4 4 0 0 1 .303-.276.35.35 0 0 0 .145-.064c.752-.57 1.695-.85 2.802-.833q.616.01 1.174.081c1.94.355 3.244 1.447 4.036 2.383.814.962 1.255 1.931 1.431 2.454-1.323-.134-2.223.127-2.68.78-.992 1.418.544 4.172 1.282 5.496.135.242.252.452.289.54.24.583.551.972.778 1.256.07.087.138.171.189.245-.4.116-1.12.383-1.055 1.717-.013.156-.043.447-.084.815-.046.208-.07.46-.1.766m.89-1.621c-.04-.832.27-.919.597-1.01l.135-.041a1 1 0 0 0 .134.103c.57.376 1.583.421 3.007.134-.202.177-.519.4-.953.601-.41.19-1.096.333-1.747.364-.72.034-1.086-.08-1.173-.151m.57-9.271c-.006.35-.054.669-.105 1.001-.055.358-.112.728-.127 1.177-.014.436.04.89.093 1.33.107.887.216 1.8-.207 2.701a4 4 0 0 1-.188-.385 8 8 0 0 0-.325-.617c-.616-1.104-2.057-3.69-1.32-4.744.38-.543 1.342-.566 2.179-.463m.228 7.013-.085-.107-.035-.044c.726-1.2.584-2.387.457-3.439-.052-.432-.1-.84-.088-1.222.013-.407.066-.755.118-1.092.064-.415.13-.844.111-1.35a.6.6 0 0 0 .012-.19c-.046-.486-.6-1.938-1.73-3.253a7.8 7.8 0 0 0-2.688-2.04A9.3 9.3 0 0 1 17.62.746c2.052.046 3.675.814 4.824 2.283a1 1 0 0 1 .067.1c.723 1.356-.276 6.275-2.987 10.54m-8.816-6.116c-.025.18-.31.423-.621.423a1 1 0 0 1-.081-.006.8.8 0 0 1-.506-.315c-.046-.06-.12-.178-.106-.285a.22.22 0 0 1 .093-.149c.118-.089.352-.122.61-.086.316.044.642.193.61.418m7.93-.411c.011.08-.049.2-.153.31a.72.72 0 0 1-.408.223 1 1 0 0 1-.075.005c-.293 0-.541-.234-.56-.371-.024-.177.264-.31.56-.352.298-.042.612.009.636.185" />
                    </svg></span> <strong><em>PostgreSQL</em></strong></p>
                <p>En <em>PostgreSQL</em> usaremos <code>MERGE INTO</code> indicando el campo por el cual va a comparar
                  la clave (en este caso, el campo incrementable no nos sirve como clave identificadora entre diferentes
                  empleados, y por lo tanto, empleamos el <code>DNI</code>):</p>
                <div class="highlight">
                  <pre><span></span><code><span class="hll"><span class="linenos" data-linenos="1 "></span><span class="n">MERGE</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="n">EMPLEADO</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">destino</span>
</span><span class="linenos" data-linenos="2 "></span><span class="k">USING</span><span class="w"> </span><span class="n">ACTUALIZACIONES_EMPLEADO</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">origen</span>
<span class="linenos" data-linenos="3 "></span><span class="k">ON</span><span class="w"> </span><span class="n">destino</span><span class="p">.</span><span class="n">DNI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">origen</span><span class="p">.</span><span class="n">DNI</span>
<span class="hll"><span class="linenos" data-linenos="4 "></span><span class="k">WHEN</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">THEN</span>
</span><span class="linenos" data-linenos="5 "></span><span class="w">    </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">NOMBRE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">origen</span><span class="p">.</span><span class="n">NOMBRE</span><span class="p">,</span>
<span class="linenos" data-linenos="6 "></span><span class="w">        </span><span class="n">JEFE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">origen</span><span class="p">.</span><span class="n">JEFE</span>
<span class="hll"><span class="linenos" data-linenos="7 "></span><span class="k">WHEN</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">THEN</span>
</span><span class="linenos" data-linenos="8 "></span><span class="w">    </span><span class="k">INSERT</span><span class="w"> </span><span class="p">(</span><span class="n">NOMBRE</span><span class="p">,</span><span class="w"> </span><span class="n">DNI</span><span class="p">,</span><span class="w"> </span><span class="n">JEFE</span><span class="p">)</span>
<span class="linenos" data-linenos="9 "></span><span class="w">    </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="n">origen</span><span class="p">.</span><span class="n">NOMBRE</span><span class="p">,</span><span class="w"> </span><span class="n">origen</span><span class="p">.</span><span class="n">DNI</span><span class="p">,</span><span class="w"> </span><span class="n">origen</span><span class="p">.</span><span class="n">JEFE</span><span class="p">);</span>
</code></pre>
                </div>
              </li>
            </ul>
          </div>
          <!--

Sincronización de productos

<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="n">MERGE</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">productos</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">USING</span><span class="w"> </span><span class="n">productos_nuevos</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">n</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">id_producto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">id_producto</span><span class="p">)</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">WHEN</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">nombre</span><span class="p">,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">precio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">precio</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">stock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">stock</span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">WHEN</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="k">INSERT</span><span class="w"> </span><span class="p">(</span><span class="n">id_producto</span><span class="p">,</span><span class="w"> </span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">precio</span><span class="p">,</span><span class="w"> </span><span class="n">stock</span><span class="p">)</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">id_producto</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">precio</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">stock</span><span class="p">);</span>
</code></pre></div>

Borrado condicionado

<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos=" 1 "></span><span class="n">MERGE</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">productos</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span>
<span class="linenos" data-linenos=" 2 "></span><span class="k">USING</span><span class="w"> </span><span class="n">productos_nuevos</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">n</span>
<span class="linenos" data-linenos=" 3 "></span><span class="k">ON</span><span class="w"> </span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">id_producto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">id_producto</span><span class="p">)</span>
<span class="linenos" data-linenos=" 4 "></span><span class="k">WHEN</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos" data-linenos=" 5 "></span><span class="w">    </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span>
<span class="linenos" data-linenos=" 6 "></span><span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">nombre</span><span class="p">,</span>
<span class="linenos" data-linenos=" 7 "></span><span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">precio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">precio</span><span class="p">,</span>
<span class="linenos" data-linenos=" 8 "></span><span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">stock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">stock</span>
<span class="linenos" data-linenos=" 9 "></span><span class="k">WHEN</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos" data-linenos="10 "></span><span class="w">    </span><span class="k">INSERT</span><span class="w"> </span><span class="p">(</span><span class="n">id_producto</span><span class="p">,</span><span class="w"> </span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">precio</span><span class="p">,</span><span class="w"> </span><span class="n">stock</span><span class="p">)</span>
<span class="linenos" data-linenos="11 "></span><span class="w">    </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">id_producto</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">nombre</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">precio</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">stock</span><span class="p">)</span>
<span class="linenos" data-linenos="12 "></span><span class="k">WHEN</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="n">MATCHED</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">SOURCE</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos" data-linenos="13 "></span><span class="w">    </span><span class="k">DELETE</span><span class="p">;</span>
</code></pre></div>

MERGE INTO combina inserción, actualización y eliminación en una sola instrucción.



Es más eficiente y seguro que ejecutar varias operaciones independientes.

-->

          <h2 id="reto-ii-creamos">Reto II - Creamos<a class="headerlink" href="05ddl.html#reto-ii-creamos"
              title="Permanent link">&para;</a></h2>
          <p>En el <a href="02er.html#reto-i-disenamos">reto anterior</a> diseñamos una base de datos. En este reto nos
            vamos a centrar en la creación del modelo físico, creando y cargando datos, para posteriormente definir una
            serie de informes y KPIs que generaremos mediante consultas utilizando SQL.</p>
          <div class="admonition info">
            <p class="admonition-title">KPI</p>
            <p>Un KPI (<em>key performance indicator</em>) es una métrica cuantitativa que muestra un valor importante
              para el negocio, permitiendo comparar el desempeño de alguna característica.</p>
            <p>Ejemplos de KPIs podrían ser la cantidad de pedido realizados durante el último més, beneficios obtenido
              en el último año, comparación <em>Year-over-year (YoY)</em> de las ventas de este mes respecto a las
              ventas del mismo mes pero en el año pasado, etc... </p>
          </div>
          <p>Así pues, inicialmente crearemos la estructura de datos necesaria, la cargaremos con datos ficticios, y
            deberemos pensar qué información queremos extraer de ella.</p>
          <h2 id="referencias">Referencias<a class="headerlink" href="05ddl.html#referencias"
              title="Permanent link">&para;</a></h2>
          <!--
https://jorgesanchez.net/manuales/sql/intro-sql-sql2016.html
-->

          <ul>
            <li>
              <p>Sintaxis SQL oficial de <a
                  href="https://www.postgresql.org/docs/current/sql-commands.html">PostgreSQL</a> y <a
                  href="https://mariadb.com/kb/en/sql-statements/">MariaDB</a>.</p>
            </li>
            <li>
              <p>Materiales sobre el módulo de BD:</p>
              <ul>
                <li><em><a
                      href="https://ioc.xtec.cat/materials/FP/Recursos/fp_dam_m02_/web/fp_dam_m02_htmlindex/WebContent/u5/a2/continguts.html">DDL</a>
                    y <a
                      href="https://ioc.xtec.cat/materials/FP/Recursos/fp_dam_m02_/web/fp_dam_m02_htmlindex/WebContent/u5/a1/continguts.html">DML</a>
                    - Institut Obert de Catalunya</em></li>
                <li><a href="https://josejuansanchez.org/bd/unidad-04-teoria/index.html">Creación de bases de datos en
                    MySQL</a> de <em>José Juan Sánchez</em></li>
                <li><a href="https://jorgesanchez.net/manuales/sql/intro-sql-sql2016.html">Introducción a SQL</a>, <a
                    href="https://jorgesanchez.net/manuales/sql/ddl-tablas-sql2016.html">DDL</a> y <a
                    href="https://jorgesanchez.net/manuales/sql/dml-sql2016.html">DML</a> de <em>Jorge Sánchez</em></li>
                <li><a href="https://apuntes-daw.javiergutierrez.trade/bases-de-datos/ut5/recopila.html">Tratamiento de
                    datos</a> de <em>Javier Gutiérrez</em></li>
                <li><a href="https://gestionbasesdatos.readthedocs.io/es/latest/Tema3/index.html">Diseño físico de bases
                    de datos - DDL</a> y <a
                    href="https://gestionbasesdatos.readthedocs.io/es/latest/Tema5/index.html">Modificación de bases de
                    datos - DML</a> de gestionbasesdatos.readthedocs.io</li>
                <li><a href="https://www.cs.us.es/cursos/bd-2023/temas/BD-Tema-5.pdf">Introducción a SQL</a>, por
                  <em>Luis Valencia</em> y <em>David Orellana</em>, de la <em>Universidad de Sevilla</em>.
                </li>
              </ul>
            </li>
          </ul>
          <h2 id="actividades">Actividades<a class="headerlink" href="05ddl.html#actividades"
              title="Permanent link">&para;</a></h2>
          <p><a name="AC501"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z" />
                  </svg></span> <strong>AC501</strong>. (<abbr
                  title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr>
                // <abbr title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr>, <abbr
                  title="Se han utilizado asistentes, herramientas gráficas y los lenguajes de definición y control de datos.">CE2h</abbr>
                // 3p) En <em>MariaDB</em>, descarga la base de datos <a
                  href="resources/world.sql.zip">world.sql.zip</a> y tras descomprimirla, cárgala mediante
                <em>PhpMyAdmin</em>. A continuación, responde a las siguientes cuestiones y adjunta una captura de
                pantalla para cada una de ellas:
              </p>
              <ul>
                <li>¿Cuántas tablas tiene?</li>
                <li>¿Cuántos y de qué tipos son los campos de la tabla <code>city</code>?</li>
                <li>¿Cuál es el formato de almacenamiento de la base de datos? ¿Qué motor de almacenamiento emplea?</li>
              </ul>
              <p>A continuación, mediante <em>DBeaver</em>, conéctate a la URL que tienes en <em>Aules</em> y averigua:
              </p>
              <ul>
                <li>¿Qué bases de datos existen?</li>
                <li>¿Cuantas tablas tiene cada base de datos?</li>
                <li>¿Qué tabla tiene más datos (indica el tamaño que ocupan y cuantos registros hay exactamente)?</li>
              </ul>
            </li>
          </ul>
          <p><a name="AP502"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M13 3c3.88 0 7 3.14 7 7 0 2.8-1.63 5.19-4 6.31V21H9v-3H8c-1.11 0-2-.89-2-2v-3H4.5c-.42 0-.66-.5-.42-.81L6 9.66A7.003 7.003 0 0 1 13 3m-2.68 4.39h1.93c.01-.3.1-.53.28-.69a1 1 0 0 1 .66-.23c.31 0 .57.1.75.28.18.19.26.45.26.75 0 .32-.07.59-.23.82-.14.23-.35.43-.61.59-.51.34-.86.64-1.05.91-.2.26-.31.68-.31 1.18h2c0-.31.04-.56.13-.74.09-.19.26-.36.51-.52.45-.24.82-.53 1.11-.93s.44-.81.44-1.31c0-.76-.27-1.37-.81-1.82-.53-.45-1.26-.68-2.19-.68-.87 0-1.57.2-2.11.59-.52.41-.78.98-.77 1.77zM12 14h2v-2h-2zm1-13C8.41 1 4.61 4.42 4.06 8.9L2.5 11h-.03l-.02.03c-.55.76-.62 1.76-.19 2.59.36.69 1 1.17 1.74 1.32V16c0 1.85 1.28 3.42 3 3.87V23h11v-5.5c2.5-1.67 4-4.44 4-7.5 0-4.97-4.04-9-9-9" />
                  </svg></span> <strong>AP502</strong>. (<abbr
                  title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr>
                // <abbr title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr> // 3p) En
                <em>PostgreSQL</em>, mediante SQL, crea una base de datos con un <em>tablespace</em> definido
                previamente y el juego de caracteres que permita el uso de <em>emojis</em> y que no sea <em>case
                  sensitive</em>.
              </p>
              <p>En dicha tabla, crea una tabla cuya clave sea un valor autonumérico y tenga un atributo que permita
                introducir cadenas de texto.</p>
              <p>A continuación, mediante <em>PgAdmin</em>, obtén la información tanto de la base de datos como de la
                tabla, e inserta una frase que contenga algún emoji. Comprueba que la información se ha almacenado
                correctamente.</p>
              <p>Debes entregar en <em>Aules</em>:</p>
              <ul>
                <li>Comandos SQL empleados.</li>
                <li>Capturas de pantalla de <em>PgAdmin</em> con la información solicitada.</li>
              </ul>
            </li>
          </ul>
          <p><a name="AC503"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z" />
                  </svg></span> <strong>AC503</strong>. (<abbr
                  title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr>
                // <abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr
                  title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr
                  title="Se han definido los campos clave en las tablas.">CE2d</abbr> // 3p) Crea el siguiente modelo
                relacional en <em>MariaDB</em> (y opcionalmente en <em>PostgreSQL</em>), y adjunta tanto las
                instrucciones DDL como capturas de pantalla con la estructura de las tablas una vez creadas (utiliza el
                comando para describirlas):</p>
              <ul>
                <li>
                  <p>Tabla <code>FABRICANTE</code></p>
                  <ul>
                    <li>Campos:<ul>
                        <li><code>codFabricante</code>: entero autoincrementable</li>
                        <li><code>nombre</code>: cadena 32</li>
                        <li><code>pais</code>: cadena 32</li>
                      </ul>
                    </li>
                    <li>Restricciones:<ul>
                        <li>La clave primaria es <code>codFabricante</code></li>
                        <li>El <code>nombre</code> no puede ser nulo</li>
                      </ul>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>Tabla <code>ARTICULO</code></p>
                  <ul>
                    <li>Campos:<ul>
                        <li><code>codigo</code>: cadena 32</li>
                        <li><code>codFabricante</code>: entero</li>
                        <li><code>peso</code>: numérico con dos decimales</li>
                        <li><code>categoria</code>: cadena 16</li>
                        <li><code>precioVenta</code>: numérico con dos decimales</li>
                        <li><code>precioCompra</code>: numérico con dos decimales</li>
                        <li><code>existencias</code>: entero sin signo</li>
                      </ul>
                    </li>
                    <li>Restricciones:<ul>
                        <li>La clave primaria es: <code>codigo</code>, <code>codFabricante</code>, <code>peso</code>,
                          <code>categoría</code>.
                        </li>
                        <li>La <code>categoria</code> ha de ser <code>primera</code>, <code>segunda</code> o
                          <code>tercera</code>.
                        </li>
                      </ul>
                    </li>
                  </ul>
                </li>
              </ul>
              <ol>
                <li>Modifica el atributo <code>pais</code> de la tabla <code>FABRICANTE</code> para que el valor por
                  defecto sea <code>España</code>.</li>
                <li>Añade una columna antes de <code>pais</code> en la tabla <code>FABRICANTE</code> para guardar la
                  <code>provincia</code>.
                </li>
                <li>Renombra la tabla <code>ARTICULO</code> a <code>PRODUCTO</code>.</li>
              </ol>
            </li>
          </ul>
          <p><a name="AC504"></a></p>
          <!-- Restricciones -->
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z" />
                  </svg></span> <strong>AC504</strong>. (<abbr
                  title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr>
                // <abbr title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr> // 3p)
                A partir del ejercicio <a href="05ddl.html#AC503">AC503</a>, vuelve a indicar la instrucción
                <code>CREATE TABLE</code> de la tabla <code>PRODUCTO</code>, pero ahora llámala <code>PIEZA</code>, de
                manera que:
              </p>
              <ul>
                <li><code>codFabricante</code> sea una clave ajena que apunta a <code>FABRICANTE</code>.</li>
                <li>al eliminar un fabricante concreto, si hay artículos de dicho fabricante, se deben prohibir la
                  operación. En cambio, si modificamos el código de la tabla <code>FABRICANTE</code>, la clave ajena
                  también cambiará su valor.</li>
                <li>los atributos <code>precioVenta</code> y <code>precioCompra</code> deben de ser mayores de 0.</li>
              </ul>
              <p>A continuación, mediante operaciones <code>ALTER TABLE</code> añade las siguientes restricciones:</p>
              <ul>
                <li>La columna <code>PRODUCTO.categoria</code> no puede admitir valores nulos.</li>
                <li>El <code>peso</code> debe ser superior o igual a 1.00.</li>
              </ul>
            </li>
          </ul>
          <p><a name="AR505"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M13 3c3.88 0 7 3.14 7 7 0 2.8-1.63 5.19-4 6.31V21H9v-3H8c-1.11 0-2-.89-2-2v-3H4.5c-.42 0-.66-.5-.42-.81L6 9.66A7.003 7.003 0 0 1 13 3m-2.68 4.39h1.93c.01-.3.1-.53.28-.69a1 1 0 0 1 .66-.23c.31 0 .57.1.75.28.18.19.26.45.26.75 0 .32-.07.59-.23.82-.14.23-.35.43-.61.59-.51.34-.86.64-1.05.91-.2.26-.31.68-.31 1.18h2c0-.31.04-.56.13-.74.09-.19.26-.36.51-.52.45-.24.82-.53 1.11-.93s.44-.81.44-1.31c0-.76-.27-1.37-.81-1.82-.53-.45-1.26-.68-2.19-.68-.87 0-1.57.2-2.11.59-.52.41-.78.98-.77 1.77zM12 14h2v-2h-2zm1-13C8.41 1 4.61 4.42 4.06 8.9L2.5 11h-.03l-.02.03c-.55.76-.62 1.76-.19 2.59.36.69 1 1.17 1.74 1.32V16c0 1.85 1.28 3.42 3 3.87V23h11v-5.5c2.5-1.67 4-4.44 4-7.5 0-4.97-4.04-9-9-9" />
                  </svg></span> <strong>AR505</strong>. (<abbr
                  title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr>
                // <abbr title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr> // 3p)
                Mediante <em>MariaDB</em> (y opcionalmente en <em>PostgreSQL</em>), crea las tablas necesarias para
                representar que un empleado tiene diferentes números de teléfono que queremos almacenar, teniendo en
                cuenta que:</p>
              <ul>
                <li>Los teléfonos se presentan mediante un prefijo de tres caracteres y número de 9 dígitos.</li>
                <li>Si eliminamos a un empleado, también eliminaremos todos sus teléfonos.</li>
              </ul>
              <p>Para ello, haciendo uso de la herramienta gráfica apropiada, inserta datos (varios empleados y varios
                teléfonos para cada empleado) y posteriormente prueba a eliminar un empleado.</p>
              <p>Adjunta tanto los scripts DDL como capturas de las tablas antes y después de realizar la operación de
                borrado.</p>
            </li>
          </ul>
          <p><a name="AP506"></a></p>
          <ul>
            <li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="m15.1 1.81-2.83 2.83c-.77.78-.77 2.05 0 2.83l1.41 1.41-4.55 4.55-2.82-2.83L4.89 12c-4.95 5-1.39 8.5-1.39 8.5S7 24 12 19.09l1.41-1.41-2.8-2.8 4.54-4.54 1.39 1.39c.78.77 2.05.77 2.83 0L22.2 8.9zm2.83 8.47L16.55 8.9l-1.44-1.44-1.4-1.4 1.41-1.41 4.23 4.23z" />
                </svg></span> <strong>AP506</strong>. (<abbr
                title="Modifica la información almacenada en la base de datos utilizando asistentes, herramientas gráficas y el lenguaje de manipulación de datos.">RABD.4</abbr>
              // <abbr
                title="Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos.">CE4a</abbr>
              // 3p) Además de las <a href="05ddl.html#restricciones">restricciones</a> estudiadas, en
              <em>PostgreSQL</em> también podemos utilizar <a
                href="https://www.postgresql.org/docs/current/sql-createtable.html#SQL-CREATETABLE-EXCLUDE"><code>EXCLUDE</code></a>
              para crear restricciones de exclusión que previenen que ciertas combinaciones de valores coexistan en una
              tabla basándose en operadores específicos. Investiga su uso (puedes usar la IA, por supuesto) y adjunta un
              documento con tres ejemplos prácticos de uso (adjunta capturas de pantalla del resultado de su ejecución).
            </li>
          </ul>
          <p><a name="AC507"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z" />
                  </svg></span> <strong>AC507</strong>. (<abbr
                  title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr>
                // <abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr
                  title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr
                  title="Se han definido los campos clave en las tablas.">CE2d</abbr> // 3p) Crea el siguiente modelo
                relacional en <em>MariaDB</em> (y opcionalmente en <em>PostgreSQL</em>):</p>
              <p><code>
<strong>DEPARTAMENTO</strong> (<ins>codD</ins>, nombre, direcc)<br />
· PK: (codD)<br />
· VNN: (nombre)
</code></p>
              <p><code>
<strong>EMPLEADO</strong> (<ins>dni</ins>, nombrec, salario, direcc, departamento<code>*</code>)<br />
                · PK: (dni)<br />
                · UK: (nombrec)<br />
                · VNN: (nombrec)<br />
                · VNN: (salario)<br />
                · VNN: (departamento)<br />
                · FK: (departamento) → DEPARTAMENTO
                </code></p>
              <p>Además, el salario de cada empleado debe ser igual o superior a 900, y su valor por defecto es de 1000.
              </p>
              <p>A continuación, haciendo uso de <code>ALTER TABLE</code>:</p>
              <ul>
                <li>Elimina la clave ajena de la tabla <code>EMPLEADO</code>.</li>
                <li>Vuelve a añadir la clave ajena, de manera que, al modificar un departamento, el cambio se propague
                  en cascada, pero que al eliminarlo, no realice ningún acción.</li>
              </ul>
              <p>Finalmente, elimina las tablas creadas.</p>
            </li>
          </ul>
          <p><a name="AR508"></a></p>
          <ul>
            <li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M13 3c3.88 0 7 3.14 7 7 0 2.8-1.63 5.19-4 6.31V21H9v-3H8c-1.11 0-2-.89-2-2v-3H4.5c-.42 0-.66-.5-.42-.81L6 9.66A7.003 7.003 0 0 1 13 3m-2.68 4.39h1.93c.01-.3.1-.53.28-.69a1 1 0 0 1 .66-.23c.31 0 .57.1.75.28.18.19.26.45.26.75 0 .32-.07.59-.23.82-.14.23-.35.43-.61.59-.51.34-.86.64-1.05.91-.2.26-.31.68-.31 1.18h2c0-.31.04-.56.13-.74.09-.19.26-.36.51-.52.45-.24.82-.53 1.11-.93s.44-.81.44-1.31c0-.76-.27-1.37-.81-1.82-.53-.45-1.26-.68-2.19-.68-.87 0-1.57.2-2.11.59-.52.41-.78.98-.77 1.77zM12 14h2v-2h-2zm1-13C8.41 1 4.61 4.42 4.06 8.9L2.5 11h-.03l-.02.03c-.55.76-.62 1.76-.19 2.59.36.69 1 1.17 1.74 1.32V16c0 1.85 1.28 3.42 3 3.87V23h11v-5.5c2.5-1.67 4-4.44 4-7.5 0-4.97-4.04-9-9-9" />
                </svg></span> <strong>AR508</strong>. (<abbr
                title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr>
              // <abbr title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr
                title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr
                title="Se han definido los campos clave en las tablas.">CE2d</abbr>, <abbr
                title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr> // 3p) A partir
              de la actividad <a href="04mr-eer.html#AC408">AC408</a> (que a su vez se basa en la <a
                href="02er.html#AC203">AC203</a>), crea las instrucciones DDL necesarias para crear el modelo físico.
            </li>
          </ul>
          <p><a name="AP509"></a></p>
          <!-- Carga de datos -->
          <ul>
            <li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="m15.1 1.81-2.83 2.83c-.77.78-.77 2.05 0 2.83l1.41 1.41-4.55 4.55-2.82-2.83L4.89 12c-4.95 5-1.39 8.5-1.39 8.5S7 24 12 19.09l1.41-1.41-2.8-2.8 4.54-4.54 1.39 1.39c.78.77 2.05.77 2.83 0L22.2 8.9zm2.83 8.47L16.55 8.9l-1.44-1.44-1.4-1.4 1.41-1.41 4.23 4.23z" />
                </svg></span> <strong>AP509</strong>. (<abbr
                title="Modifica la información almacenada en la base de datos utilizando asistentes, herramientas gráficas y el lenguaje de manipulación de datos.">RABD.4</abbr>
              // <abbr
                title="Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos.">CE4a</abbr>
              // 3p) Haciendo uso de <em>MariaDB</em> y del cliente <code>mariadb</code>, a partir del siguiente <a
                href="resources/ap509.sql"><em>script</em></a> con las instrucciones para crear una base de datos, carga
              los datos que tienes disponibles en <a href="resources/ap509.zip">ap509.zip</a> haciendo uso de las
              instrucciones <code>LOAD DATA</code>. Finalmente, mediante <code>mysqldump</code> realiza una exportación
              de toda la base de datos (con los datos cargados), y adjunta tanto los comandos empleados como el
              resultado de la exportación.</li>
          </ul>
          <p><a name="AC510"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z" />
                  </svg></span> <strong>AC510</strong>. (<abbr
                  title="Modifica la información almacenada en la base de datos utilizando asistentes, herramientas gráficas y el lenguaje de manipulación de datos.">RABD.4</abbr>
                // <abbr
                  title="Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos.">CE4a</abbr>,
                <abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr> // 3p) A partir
                de la actividad <a href="05ddl.html#AC504">AC504</a>, se pide:
              </p>
              <ul>
                <li>Modifica el <em>charset</em> de la tabla <code>FABRICANTE</code> a<code>utf8mb4</code>.</li>
                <li>
                  <p>Inserta los siguientes datos utilizando las herramientas gráficas en <em>MariaDB</em> (y
                    opcionalmente en <em>PostgreSQL</em>):</p>
                  <ul>
                    <li>
                      <p><code>FABRICANTE</code></p>
                      <table>
                        <thead>
                          <tr>
                            <th><ins>codFabricante</ins></th>
                            <th>nombre</th>
                            <th>provincia</th>
                            <th>pais</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>1</td>
                            <td>Sony</td>
                            <td>Kantō</td>
                            <td>Japón</td>
                          </tr>
                          <tr>
                            <td>2</td>
                            <td>Microsoft</td>
                            <td>Nuevo México</td>
                            <td>USA</td>
                          </tr>
                          <tr>
                            <td>3</td>
                            <td>Nintendo</td>
                            <td>Kantō</td>
                            <td>Japón</td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                    <li>
                      <p><code>PIEZA</code></p>
                      <table>
                        <thead>
                          <tr>
                            <th><ins>codigo</ins></th>
                            <th>codFabricante*</th>
                            <th>peso</th>
                            <th>categoria</th>
                            <th>precioVenta</th>
                            <th>precioCompra</th>
                            <th>existencias</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>PS5</td>
                            <td>1</td>
                            <td>4.5</td>
                            <td>primera</td>
                            <td>500.00</td>
                            <td>550.00</td>
                            <td>123</td>
                          </tr>
                          <tr>
                            <td>PS4</td>
                            <td>1</td>
                            <td>2.8</td>
                            <td>primera</td>
                            <td>300.00</td>
                            <td>400.00</td>
                            <td>234</td>
                          </tr>
                          <tr>
                            <td>XSX</td>
                            <td>2</td>
                            <td>4.4</td>
                            <td>primera</td>
                            <td>500.00</td>
                            <td>550.00</td>
                            <td>345</td>
                          </tr>
                          <tr>
                            <td>NSW</td>
                            <td>3</td>
                            <td>0.3</td>
                            <td>segunda</td>
                            <td>225.00</td>
                            <td>330.00</td>
                            <td>456</td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>¿Has podido insertar la pieza <code>NSW</code>? ¿Por qué?</p>
                </li>
                <li>Indica las sentencias SQL para vaciar las tablas.</li>
                <li>Anota las sentencias SQL para introducir de nuevo los datos.</li>
              </ul>
            </li>
          </ul>
          <p><a name="AC511"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z" />
                  </svg></span> <strong>AC511</strong>. (<abbr
                  title="Modifica la información almacenada en la base de datos utilizando asistentes, herramientas gráficas y el lenguaje de manipulación de datos.">RABD.4</abbr>
                // <abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr>, <abbr
                  title="Se han diseñado guiones de sentencias para llevar a cabo tareas complejas.">CE4d</abbr> // 3p)
                Carga el siguiente <a href="resources/ac511.sql">script de datos</a> sobre las tablas de la <a
                  href="05ddl.html#AC507">AC507</a>, y realiza las siguientes modificaciones:</p>
              <ol>
                <li>Añade un nuevo departamento llamado <code>Formación</code>.</li>
                <li>Renombra el departamento <code>IT</code> por <code>Informática</code>.</li>
                <li>Añade el campo <code>email</code> al final de la tabla <code>DEPARTAMENTO</code>, y rellénalos todos
                  con <code>email@ac510.com</code>.</li>
                <li>Incrementa el salario de todos los empleados del departamento de informática en 300€.</li>
                <li>Inserta un nuevo empleado con tus datos en el departamento <code>Formación</code>.</li>
                <li>Cambia al empleado <code>12345678A</code> al departamento de <code>Formación</code>.</li>
                <li>Modifica la clave del departamento <code>Formación</code> a 666.</li>
                <li>Elimina el departamento <code>Legal</code>. ¿Has podido? ¿Qué ha pasado con sus empleados?</li>
              </ol>
            </li>
          </ul>
          <p><a name="AP512"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="m15.1 1.81-2.83 2.83c-.77.78-.77 2.05 0 2.83l1.41 1.41-4.55 4.55-2.82-2.83L4.89 12c-4.95 5-1.39 8.5-1.39 8.5S7 24 12 19.09l1.41-1.41-2.8-2.8 4.54-4.54 1.39 1.39c.78.77 2.05.77 2.83 0L22.2 8.9zm2.83 8.47L16.55 8.9l-1.44-1.44-1.4-1.4 1.41-1.41 4.23 4.23z" />
                  </svg></span> <strong>AP512</strong>. (<abbr
                  title="Modifica la información almacenada en la base de datos utilizando asistentes, herramientas gráficas y el lenguaje de manipulación de datos.">RABD.4</abbr>
                // <abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr> // 3p) Sobre
                la actividad <a href="05ddl.html#AC510">AC510</a>, añade una nueva tabla <code>DIETAS</code> donde
                podamos anotar los gastos ocasionados por las dietas de los empleados, como son la fecha, el coste y una
                descripción de la misma. A continuación, inserta 10 dietas de diferentes empleados.</p>
              <p>Debes tener en cuenta que si eliminamos un empleado, no debe permitir realizar la operación ni eliminar
                las dietas, ya que, si no, luego no nos cuadraría la contabilidad. ¿Cómo solucionamos dar de baja a un
                empleado pero no eliminarlo del sistema?</p>
            </li>
          </ul>
          <p><a name="AR513"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M13 3c3.88 0 7 3.14 7 7 0 2.8-1.63 5.19-4 6.31V21H9v-3H8c-1.11 0-2-.89-2-2v-3H4.5c-.42 0-.66-.5-.42-.81L6 9.66A7.003 7.003 0 0 1 13 3m-2.68 4.39h1.93c.01-.3.1-.53.28-.69a1 1 0 0 1 .66-.23c.31 0 .57.1.75.28.18.19.26.45.26.75 0 .32-.07.59-.23.82-.14.23-.35.43-.61.59-.51.34-.86.64-1.05.91-.2.26-.31.68-.31 1.18h2c0-.31.04-.56.13-.74.09-.19.26-.36.51-.52.45-.24.82-.53 1.11-.93s.44-.81.44-1.31c0-.76-.27-1.37-.81-1.82-.53-.45-1.26-.68-2.19-.68-.87 0-1.57.2-2.11.59-.52.41-.78.98-.77 1.77zM12 14h2v-2h-2zm1-13C8.41 1 4.61 4.42 4.06 8.9L2.5 11h-.03l-.02.03c-.55.76-.62 1.76-.19 2.59.36.69 1 1.17 1.74 1.32V16c0 1.85 1.28 3.42 3 3.87V23h11v-5.5c2.5-1.67 4-4.44 4-7.5 0-4.97-4.04-9-9-9" />
                  </svg></span> <strong>AR513</strong>. (<abbr
                  title="Modifica la información almacenada en la base de datos utilizando asistentes, herramientas gráficas y el lenguaje de manipulación de datos.">RABD.4</abbr>
                // <abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr>, <abbr
                  title="Se han diseñado guiones de sentencias para llevar a cabo tareas complejas.">CE4d</abbr> // 3p)
                Carga el <em>script</em> <a href="resources/ar513.sql"><code>ar513.sql</code></a> con el DDL sobre una
                base de datos de libros y préstamos, y realiza las siguientes operaciones:</p>
              <ol>
                <li>
                  <p>Inserta los siguientes valores en las tablas:</p>
                  <ul>
                    <li>
                      <p><code>LIBRO</code></p>
                      <table>
                        <thead>
                          <tr>
                            <th>codigo</th>
                            <th>titulo</th>
                            <th>autor</th>
                            <th>stock</th>
                            <th>genero</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>1</td>
                            <td>Historia de España</td>
                            <td>J. Pérez</td>
                            <td>5</td>
                            <td>HIS</td>
                          </tr>
                          <tr>
                            <td>2</td>
                            <td>Reina Roja</td>
                            <td>J. Gómez-Jurado</td>
                            <td>33</td>
                            <td>NOV</td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                    <li>
                      <p><code>PRESTAMO</code></p>
                      <table>
                        <thead>
                          <tr>
                            <th>codLibro</th>
                            <th>codSocio</th>
                            <th>fentrega</th>
                            <th>fdevolucion</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>1</td>
                            <td>1</td>
                            <td>15/10/24</td>
                            <td></td>
                          </tr>
                          <tr>
                            <td>2</td>
                            <td>1</td>
                            <td>25/10/24</td>
                            <td></td>
                          </tr>
                        </tbody>
                      </table>
                    </li>
                  </ul>
                </li>
                <li>
                  <p>Realiza las siguientes operaciones:</p>
                  <ol>
                    <li>Cambia la clave primaria de libro al título. Realiza los cambios necesarios para que la tabla
                      libros y prestamos estén relacionadas.</li>
                    <li>Eliminar aquellos libros que sean del género de historia. ¿Se elimina el registro de la tabla
                      <code>LIBRO</code>? Razona la respuesta.<ol>
                        <li>Si no lo has conseguido, cambia la restricción de la clave ajena para que la operación se
                          propague.</li>
                        <li>Vuelve a realizar la operación de borrado de libros.</li>
                        <li>¿Cuántos registros tiene ahora la tabla <code>PRESTAMO</code>?</li>
                      </ol>
                    </li>
                    <li>Inserta los siguientes libros (<em>Loba Negra</em>, <em>MariaDB Essentials</em>), buscando en
                      Internet la información que necesites.</li>
                    <li>Reduce el stock de <code>Reina Roja</code> en 3 unidades.</li>
                    <li>Haz que el libro prestado tenga como fecha de devolución el 31/12/24.</li>
                    <li>Cambia el nombre del autor de <code>Reina Roja</code> por <code>Juan Gómez Jurado</code>.</li>
                  </ol>
                </li>
              </ol>
            </li>
          </ul>
          <p><a name="AC514"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z" />
                  </svg></span> <strong>AC514</strong>. (<abbr
                  title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr>
                // <abbr title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr>, <abbr
                  title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr
                  title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr
                  title="Se han definido los campos clave en las tablas.">CE2d</abbr>, <abbr
                  title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr>, <abbr
                  title="Se han diseñado guiones de sentencias para llevar a cabo tareas complejas.">CE4d</abbr> // 3p)
                A partir del siguiente modelo relacional, genera el script DDL (<code>ac513.sql</code>) para la creación
                de las tablas mediante <em>MariaDB</em> en una base de datos denominada <code>ac513</code> (el
                <em>script</em> debe poder ejecutarse una y otra vez, de manera que si ya existe la base de datos debe
                borrarla, y para crear cada tabla, debe comprobar que no exista previamente).
              </p>
              <p>El diccionario de datos es el siguiente:</p>
              <table>
                <thead>
                  <tr>
                    <th>TABLA</th>
                    <th>CAMPO</th>
                    <th>TIPO</th>
                    <th>RESTRICCIONES</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><code>ALUMNOS</code></td>
                    <td><code>id</code></td>
                    <td>Entero sin signo autoincrementable</td>
                    <td>PK</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>dni</code></td>
                    <td>Carácter (9)</td>
                    <td>UK</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>nombre</code></td>
                    <td>Texto (64)</td>
                    <td>obligatorio</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>apellidos</code></td>
                    <td>Texto (64)</td>
                    <td>obligatorio</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>sexo</code></td>
                    <td>{H, M}</td>
                    <td>obligatorio</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>dirección</code></td>
                    <td>Texto (128)</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>telefono</code></td>
                    <td>Carácter (12)</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>fnac</code></td>
                    <td>Fecha</td>
                    <td></td>
                  </tr>
                  <tr>
                    <td><code>ASIGNATURAS</code></td>
                    <td>id</td>
                    <td>Entero sin signo autoincrementable</td>
                    <td>PK</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>nombre</code></td>
                    <td>Texto (64)</td>
                    <td>obligatorio</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>aula</code></td>
                    <td>entero</td>
                    <td>Entre 1 y 10, por defecto se asigna el aula 1</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>duracion</code></td>
                    <td>Entero</td>
                    <td>Entre 1 y 12, por defecto su duración es 3</td>
                  </tr>
                  <tr>
                    <td><code>NOTAS</code></td>
                    <td><code>idAlumno</code></td>
                    <td>Entero sin signo</td>
                    <td>PK, FK → <code>ALUMNOS</code></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>idAsignatura</code></td>
                    <td>Entero sin signo</td>
                    <td>PK, FK → <code>ASIGNATURAS</code></td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>fecha</code></td>
                    <td>Fecha</td>
                    <td>obligatorio</td>
                  </tr>
                  <tr>
                    <td></td>
                    <td><code>calificación</code></td>
                    <td>Numérico con 1 decimal</td>
                    <td>Entre 0.0 y 10.0, obligatorio</td>
                  </tr>
                </tbody>
              </table>
              <p>A continuación, modifica la estructura de las tablas mediante <code>ALTER TABLE</code>:</p>
              <ol>
                <li>Cambia el nombre de las tablas y ponlas en singular.</li>
                <li>Añade una columna <code>recuperacion</code> a <code>NOTA</code> para almacenar la posible
                  calificación de un examen de recuperación. Dicha calificación debe estar comprendida entre 0 y 10.
                </li>
                <li>Modifica la columna <code>sexo</code> de <code>ALUMNO</code> para añadir un tercer valor
                  (indeterminado - I).</li>
                <li>Modifica la clave primaria de <code>NOTA</code> para incluir también la fecha.</li>
                <li>Modifica la clave ajena de <code>NOTA</code> hacia <code>ALUMNO</code> para que al realizar un
                  borrado de un alumno, se eliminen todas sus notas.</li>
              </ol>
            </li>
          </ul>
          <p><a name="AC515"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M20.832 3.367 8.668.108a3.15 3.15 0 0 0-3.856 2.226L.943 16.777a3.15 3.15 0 0 0 2.226 3.856l12.163 3.259a3.15 3.15 0 0 0 3.855-2.226l3.87-14.443a3.15 3.15 0 0 0-2.226-3.856M6.332 2.741a1.574 1.574 0 0 1 1.928-1.113l12.163 3.26a1.574 1.574 0 0 1 1.113 1.927l-3.87 14.444a1.574 1.574 0 0 1-1.928 1.113l-12.163-3.26a1.574 1.574 0 0 1-1.113-1.927zm2.634 2.336a.787.787 0 1 0-.407 1.52l9.122 2.444a.787.787 0 1 0 .407-1.52zM6.985 9.434a.787.787 0 0 1 .963-.557l9.123 2.445a.787.787 0 0 1-.408 1.52l-9.122-2.444a.787.787 0 0 1-.556-.964m-.055 3.244a.787.787 0 0 0-.407 1.52l5.32 1.427a.787.787 0 0 0 .408-1.52z" />
                  </svg></span> <strong>AC515</strong>. (<abbr
                  title="Modifica la información almacenada en la base de datos utilizando asistentes, herramientas gráficas y el lenguaje de manipulación de datos.">RABD.4</abbr>
                // <abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr>, <abbr
                  title="Se han diseñado guiones de sentencias para llevar a cabo tareas complejas.">CE4d</abbr> // 3p)
                Continua la actividad anterior, y crea el script <code>ac514.sql</code> donde insertes los siguientes
                datos para el alumnado y los cursos mediante instrucciones <code>INSERT</code>:</p>
              <ul>
                <li>
                  <p><code>ALUMNO</code></p>
                  <table>
                    <thead>
                      <tr>
                        <th><strong>DNI</strong></th>
                        <th><strong>Nombre</strong></th>
                        <th><strong>Apellidos</strong></th>
                        <th><strong>Sexo</strong></th>
                        <th><strong>Dirección</strong></th>
                        <th><strong>Teléfono</strong></th>
                        <th><strong>Fecha de nacimiento</strong></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>12345678A</td>
                        <td>Johnny</td>
                        <td>Mentero</td>
                        <td>H</td>
                        <td>Debajo del puente, -1</td>
                        <td><code>NULL</code></td>
                        <td>25/12/80</td>
                      </tr>
                      <tr>
                        <td>23456789B</td>
                        <td>María</td>
                        <td>Gracia</td>
                        <td>M</td>
                        <td><code>NULL</code></td>
                        <td>636112233</td>
                        <td><code>NULL</code></td>
                      </tr>
                      <tr>
                        <td>34567890C</td>
                        <td>Armando</td>
                        <td>Casas</td>
                        <td>I</td>
                        <td>Villarriba, 33</td>
                        <td>636223344</td>
                        <td>31/12/90</td>
                      </tr>
                      <tr>
                        <td>45678901D</td>
                        <td>Mario</td>
                        <td>Neta</td>
                        <td>H</td>
                        <td>Circo del Sol, 22</td>
                        <td>636334455</td>
                        <td><code>NULL</code></td>
                      </tr>
                      <tr>
                        <td>56789012E</td>
                        <td>Susana</td>
                        <td>Oria</td>
                        <td>M</td>
                        <td>Calle La Granja</td>
                        <td><code>NULL</code></td>
                        <td>3/1/00</td>
                      </tr>
                    </tbody>
                  </table>
                </li>
                <li>
                  <p><code>ASIGNATURA</code></p>
                  <table>
                    <thead>
                      <tr>
                        <th><strong>id</strong></th>
                        <th><strong>Nombre</strong></th>
                        <th><strong>Aula</strong></th>
                        <th><strong>Duración</strong></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td><code>NULL</code></td>
                        <td>SQL</td>
                        <td>3</td>
                        <td>9</td>
                      </tr>
                      <tr>
                        <td>666</td>
                        <td>Humor</td>
                        <td><code>NULL</code></td>
                        <td>12</td>
                      </tr>
                      <tr>
                        <td><code>NULL</code></td>
                        <td>Cocina</td>
                        <td>6</td>
                        <td><code>NULL</code></td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
              <p>A continuación, inserta los siguientes datos de calificaciones mediante <code>LOAD DATA</code>, creando
                previamente el archivo <code>ac514.csv</code> con la siguiente información:</p>
              <table>
                <thead>
                  <tr>
                    <th><strong>Alumno</strong></th>
                    <th><strong>Asignatura</strong></th>
                    <th><strong>Fecha</strong></th>
                    <th><strong>Nota</strong></th>
                    <th><strong>Recuperación</strong></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>1</td>
                    <td>1</td>
                    <td>20/12/20</td>
                    <td>7,25</td>
                    <td><code>NULL</code></td>
                  </tr>
                  <tr>
                    <td>1</td>
                    <td>666</td>
                    <td>20/12/20</td>
                    <td>9,99</td>
                    <td><code>NULL</code></td>
                  </tr>
                  <tr>
                    <td>2</td>
                    <td>2</td>
                    <td>10/1/21</td>
                    <td>5</td>
                    <td><code>NULL</code></td>
                  </tr>
                  <tr>
                    <td>2</td>
                    <td>666</td>
                    <td>10/1/21</td>
                    <td>7</td>
                    <td><code>NULL</code></td>
                  </tr>
                  <tr>
                    <td>3</td>
                    <td>1</td>
                    <td>10/1/21</td>
                    <td>3</td>
                    <td>6</td>
                  </tr>
                  <tr>
                    <td>3</td>
                    <td>666</td>
                    <td>10/1/21</td>
                    <td>3</td>
                    <td>6</td>
                  </tr>
                </tbody>
              </table>
              <p>Finalmente, realiza las siguientes operaciones de modificación y borrado de datos:</p>
              <ol>
                <li>
                  <p>Modificar:</p>
                  <ol>
                    <li>El teléfono del alumno <code>1</code> es <code>666111222</code></li>
                    <li>La dirección de todos los alumnos hombres es <code>Donde me lleve la vida</code>.</li>
                    <li>El apellido de todos alumnos que se llamen <code>Armando</code> ahora es <code>Bullas</code>.
                    </li>
                    <li>Todos los cursos tendrán una unidad más de duración</li>
                    <li>Los alumnos que no tengan dirección se les asignará <code>Internet</code>.</li>
                  </ol>
                </li>
                <li>
                  <p>Eliminar:</p>
                  <ol>
                    <li>Borra las calificaciones inferiores a 4. ¿has podido? ¿cuantas calificaciones quedan?</li>
                    <li>Borra la información de <code>Johnny Mentero</code>. ¿has podido? ¿cuantos calificaciones
                      quedan?</li>
                    <li>Elimina el curso de cocina ¿has podido? ¿cuantas asignaturas quedan?</li>
                    <li>Elimina los alumnos que no tengan teléfono ¿has podido? ¿cuantos alumnos quedan? ¿cuantas
                      calificaciones quedan?</li>
                    <li>Elimina todos los alumnos ¿has podido? ¿cuantos alumnos quedan? ¿cuantas calificaciones quedan?
                    </li>
                  </ol>
                </li>
              </ol>
              <p>Recuerda que para comprobar los datos que contiene una tabla puedes ejecutar en el cliente
                <code>SELECT * FROM tabla</code>;
              </p>
            </li>
          </ul>
          <p><a name="PY516"></a></p>
          <ul>
            <li>
              <p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                      d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z" />
                  </svg></span> <strong>PY516</strong>. (<abbr
                  title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr>,
                <abbr
                  title="Modifica la información almacenada en la base de datos utilizando asistentes, herramientas gráficas y el lenguaje de manipulación de datos.">RABD.4</abbr>
                // <abbr title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr>, <abbr
                  title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr
                  title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr
                  title="Se han definido los campos clave en las tablas.">CE2d</abbr>, <abbr
                  title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr>, <abbr
                  title="Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos.">CE4a</abbr>,
                <abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr>, <abbr
                  title="Se han diseñado guiones de sentencias para llevar a cabo tareas complejas.">CE4d</abbr> // 10p
                + 10p) A partir del modelo diseñado en la actividad <a href="04mr-eer.html#PY416">PY416</a> asociada al
                primer reto de diseño de la base de datos, ahora nos vamos a centrar en crear el modelo físico y cargar
                datos para trabajar con él. Para ello, como equipo, deberéis decantaros por un SGBD en concreto.
              </p>
              <p>Para ello, se pide:</p>
              <ul>
                <li>Informe con el modelo ER, el modelo MR y justificación de las decisiones tomadas respecto a las
                  restricciones incluidas en el modelo físico.</li>
                <li>Script SQL con las sentencias DDL.</li>
                <li>Script SQL con las sentencias DML para cargar datos.</li>
                <li>Script SQL para vaciar todas las tablas.</li>
              </ul>
              <p>Se utilizará una rúbrica para su evaluación en base a la siguiente lista de cotejo:</p>
              <ul>
                <li>Limpieza y calidad de los scripts.</li>
                <li>Documentación de los scripts.</li>
                <li>El informe entregado no contiene faltas de ortografía.</li>
                <li>El informe entregado tiene un formato adecuado (portada, apartados, autores, etc...).</li>
                <li>El informe debe indicar cómo se han repartido las tareas y qué ha realizado cada alumno/a.</li>
                <li>Cada tabla contiene un mínimo de 10 registros, salvo justificación.</li>
                <li>En el caso de existir relaciones entre tablas, cada registro debe relacionarse con un mínimo de tres
                  registros más.</li>
              </ul>
            </li>
          </ul>
          <p><a name="AR517"></a></p>
          <ul>
            <li><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                  <path
                    d="M13 3c3.88 0 7 3.14 7 7 0 2.8-1.63 5.19-4 6.31V21H9v-3H8c-1.11 0-2-.89-2-2v-3H4.5c-.42 0-.66-.5-.42-.81L6 9.66A7.003 7.003 0 0 1 13 3m-2.68 4.39h1.93c.01-.3.1-.53.28-.69a1 1 0 0 1 .66-.23c.31 0 .57.1.75.28.18.19.26.45.26.75 0 .32-.07.59-.23.82-.14.23-.35.43-.61.59-.51.34-.86.64-1.05.91-.2.26-.31.68-.31 1.18h2c0-.31.04-.56.13-.74.09-.19.26-.36.51-.52.45-.24.82-.53 1.11-.93s.44-.81.44-1.31c0-.76-.27-1.37-.81-1.82-.53-.45-1.26-.68-2.19-.68-.87 0-1.57.2-2.11.59-.52.41-.78.98-.77 1.77zM12 14h2v-2h-2zm1-13C8.41 1 4.61 4.42 4.06 8.9L2.5 11h-.03l-.02.03c-.55.76-.62 1.76-.19 2.59.36.69 1 1.17 1.74 1.32V16c0 1.85 1.28 3.42 3 3.87V23h11v-5.5c2.5-1.67 4-4.44 4-7.5 0-4.97-4.04-9-9-9" />
                </svg></span> <strong>AR517</strong>. (<abbr
                title="Crea bases de datos definiendo su estructura y las características de sus elementos según el modelo relacional">RABD.2</abbr>,
              <abbr
                title="Modifica la información almacenada en la base de datos utilizando asistentes, herramientas gráficas y el lenguaje de manipulación de datos.">RABD.4</abbr>
              // <abbr title="Se ha analizado el formato de almacenamiento de la información.">CE2a</abbr>, <abbr
                title="Se han creado las tablas y las relaciones entre ellas.">CE2b</abbr>, <abbr
                title="Se han seleccionado los tipos de datos adecuados.">CE2c</abbr>, <abbr
                title="Se han definido los campos clave en las tablas.">CE2d</abbr>, <abbr
                title="Se han implantado las restricciones reflejadas en el diseño lógico.">CE2e</abbr>, <abbr
                title="Se han identificado las herramientas y sentencias para modificar el contenido de la base de datos.">CE4a</abbr>,
              <abbr title="Se han insertado, borrado y actualizado datos en las tablas.">CE4b</abbr>, <abbr
                title="Se han diseñado guiones de sentencias para llevar a cabo tareas complejas.">CE4d</abbr> // 3p)
              Una vez finalizada la unidad, responde todas las preguntas del cuestionario inicial, con al menos un par
              de líneas para cada una de las cuestiones.
            </li>
          </ul>
          <!--
* https://mariadb.com/kb/en/create-table/#create-table-like
* https://mariadb.com/kb/en/application-time-periods/
* Insert con SET
* https://mariadb.com/kb/en/insert-ignore/
* https://mariadb.com/kb/en/insert-on-duplicate-key-update/


IMPORTANTE --- MEJORAR

Uso de LAST_INSERT_ID y ROW_COUNT

En MariaDB, la función `ROW_COUNT()` devuelve el número de filas afectadas por la última operación realizada. Esta función es especialmente útil en los siguientes casos:

1. Después de ejecutar sentencias DML (Data Manipulation Language) como INSERT, UPDATE o DELETE para saber cuántas filas fueron modificadas.

2. En procedimientos almacenados o triggers para verificar si una operación tuvo éxito y afectó al número esperado de filas.

3. Para validar el resultado de operaciones como LOAD DATA INFILE o INSERT INTO ... SELECT.

4. Como alternativa a la función integrada FOUND_ROWS() cuando solo necesitas saber el número de filas afectadas.

Por ejemplo:
<div class="highlight"><pre><span></span><code><span class="linenos" data-linenos="1 "></span><span class="k">UPDATE</span><span class="w"> </span><span class="n">usuarios</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">activo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">ultimo_acceso</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="s1">&#39;2024-01-01&#39;</span><span class="p">;</span>
<span class="linenos" data-linenos="2 "></span><span class="k">SELECT</span><span class="w"> </span><span class="k">ROW_COUNT</span><span class="p">();</span><span class="w"> </span><span class="c1">-- Devolverá el número de usuarios desactivados</span>
</code></pre></div>

Es importante tener en cuenta que debes utilizar ROW_COUNT() inmediatamente después de la operación de la que quieres obtener información, ya que su valor se actualiza con cada operación ejecutada.
-->

          <!--
TODO: Crear una AP para usar MERGE INTO
-->

          <!--
Contenidos básicos:

Almacenamiento de la información:
− Ficheros (planos, indexados, acceso directo, entre otros).
− Bases de datos. Conceptos, usos y tipos según el modelo de datos, la
ubicación de la información.
− Sistemas gestores de base de datos: Funciones, componentes y tipos.
− Bases de datos centralizadas y bases de datos distribuidas. Técnicas de
fragmentación.
− Legislación sobre protección de datos.
− Big Data: introducción, análisis de datos, inteligencia de negocios.

Bases de datos relacionales:
− Modelo de datos.
− Terminología del modelo relacional.
− Tipos de datos.
− Claves primarias.
− Restricciones de validación.
− Índices. Características.
− El valor NULL.
− Claves ajenas.
− Vistas.
− Usuarios. Privilegios.
− Lenguaje de descripción de datos (DDL).
− Lenguaje de control de datos (DCL).

Realización de consultas:
− Proyección, selección y ordenación de registros.
− Operadores. Operadores de comparación. Operadores lógicos.
− Consultas de resumen.
− Agrupamiento de registros.
− Composiciones internas.
− Composiciones externas.
− Subconsultas
− Combinación de múltiples selecciones.
− Optimización de consultas.

Tratamiento de datos:
− Inserción, borrado y modificación de registros.
− Integridad referencial.
− Subconsultas y composiciones en órdenes de edición.
− Transacciones.
− Políticas de bloqueo. Concurrencia.

Programación de bases de datos:
− Introducción. Lenguaje de programación.
− Variables del sistema y variables de usuario.
− Funciones.
− Estructuras de control de flujo.
− Procedimientos almacenados. Funciones de usuario.
− Eventos y disparadores.
− Excepciones.
− Cursores.

Interpretación de Diagramas Entidad/Relación:
− El modelo E/R. Entidades y relaciones. Cardinalidades. Debilidad.
− El modelo E/R ampliado. Generalización y especialización. Agregación.
− Paso del diagrama E/R al modelo relacional.
− Restricciones semánticas del modelo relacional.
− Normalización de modelos relacionales.

Uso de bases de datos no relacionales:
− Características de las bases de datos no relacionales.
− Tipos de bases de datos no relacionales.
− Elementos de las bases de datos no relacionales.
− Sistemas gestores de bases de datos no relacionales.
− Herramientas de los sistemas gestores de bases de datos no relacionales
para la gestión de la información almacenada.


Las actividades profesionales asociadas a esta función se aplican en:
− La gestión de la información almacenada en bases de datos.
− El desarrollo de aplicaciones que acceden a bases de datos.

La formación del módulo contribuye a alcanzar los objetivos generales c), e), f), p) y t) del ciclo formativo y las competencias b), c), e), p) y t) del título.

-->

          <div class="footnote">
            <hr />
            <ol>
              <li id="fn:1">
                <p>en MariaDB se hace con la cláusula <code>AUTO_INCREMENT</code>&#160;<a class="footnote-backref"
                    href="05ddl.html#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
              </li>
            </ol>
          </div>
















          <form class="md-feedback" name="feedback" hidden>
            <fieldset>
              <legend class="md-feedback__title">
                <a href='https://ko-fi.com/T6T8GWT9N' title='Invítame a un café en ko-fi.com' target='_blank'><img
                    height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi2.png?v=3'
                    border='0' alt='Invítame a un café en ko-fi.com' /></a>
              </legend>
              <div class="md-feedback__inner">
                <div class="md-feedback__list">

                  <button class="md-feedback__icon md-icon" type="submit" title="Me encantan estos apuntes"
                    data-md-value="1">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81" />
                    </svg>
                  </button>

                  <button class="md-feedback__icon md-icon" type="submit" title="Los apuntes son mejorables"
                    data-md-value="0">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                      <path
                        d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14" />
                    </svg>
                  </button>

                </div>
                <div class="md-feedback__note">

                  <div data-md-value="1" hidden>




                    Gracias por tu tiempo. Si quieres me puedes <a href='https://ko-fi.com/T6T8GWT9N'>invitar a un café
                      en ko-fi</a>.
                  </div>

                  <div data-md-value="0" hidden>




                    ¡Gracias por tu colaboración! Ayúdame a mejorar los apuntes enviándome un mail a <a
                      href="mailto:a.medrano@edu.gva.es">a.medrano@edu.gva.es</a> con tus comentarios.
                  </div>

                </div>
              </div>
            </fieldset>
          </form>




        </div>
      </article>
    </div>
  </main>
  <footer class="footer">
    <div class="container">
      <div class="footer__content">
        <p class="footer__text">Â© 2024-2026 Mayte Olmedilla - <a
            href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.es" class="footer__link">Licencia CC
            BY-NC-SA</a></p>
        <p class="footer__text"><a href="https://github.com/mayteoe/BBDD" class="footer__link">GitHub</a> | <a
            href="https://www.iesjuanbosco.es" class="footer__link">IES Juan Bosco</a> | <a
            href="mailto:molmedilla@iesjuanbosco.es" class="footer__link">molmedilla@iesjuanbosco.es</a></p>
        <p class="footer__text footer__text--small">Basado en el trabajo de Aitor Medrano</p>
      </div>
    </div>
  </footer>
</body>

</html>